{
  "id": 1025575,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDI1NTc1",
  "url": "https://hackerone.com/reports/1025575",
  "title": "Default behavior of Fastifys versioned routes can be used for cache poisoning when Fastify is used in combination with a http cache / CDN",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-11-03T20:22:03.699Z",
  "submitted_at": "2020-11-03T20:22:03.726Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "trygve_lie",
    "url": "/trygve_lie",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/gvMhqhfwJokCwd5WuYZX1fAU/ede8cd84a64d5392a2bb88ecb598721116469c27c015c2caa77148f11e211d58"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 23949,
    "url": "https://hackerone.com/nodejs-ecosystem",
    "handle": "nodejs-ecosystem",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [

    ],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Node.js third-party modules",
      "twitter_handle": "",
      "website": "https://nodejs.org/en/security/",
      "about": "This program was used to handle vulnerabilities in the Node.js ecosystem."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2020-7764"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2020-12-10T16:56:12.040Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2020-11-10T16:56:04.263Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I would like to report possible cache poisoning in Fastify\nIt allows an attacker to perform an cache poisoning when Fastify is used in combination with a http cache / CDN.\n\n# Module\n\n**module name:** Fastify\n**version:** 3.x\n**npm page:** `https://www.npmjs.com/package/fastify`\n\n## Module Description\n\n> Fast and low overhead web framework, for Node.js\n\n## Module Stats\n\n159,983 weekly downloads\n\n# Vulnerability\n\n## Vulnerability Description\n\nI might be missing the obvious or I've not read the documentation closely enough, but to me it seem like its not possible to turn off versioned routes in Fastify.\n\nThe reason why I am reporting this issue as a security issue are because my reason to want to turn off versioned routes in Fastify is rooted in a security issue when using Fastify in relation with a http cache / CDN and I do not want to expose this in the common issue tracker because it can be used against running services. \n\nMy current issue is that we have a Fastify server not using versioned routes where the server live behind a http cache / CDN. By default Fastify will return a 404 if a `Accept-Version` http header is passed on to an exiting route not under versioning. When there is a http cache / CDN infront of Fastify this will make it possible for an attacker to perform an cache poisoning attack (https://owasp.org/www-community/attacks/Cache_Poisoning).\n\n## Steps To Reproduce:\n\nGiven the following Fastify server:\n\n```js\nconst app = require('fastify')();\n\napp.get('/', async () => {\n    return { hello: 'world' };\n});\n\nconst start = async () => {\n    await app.listen(9000)\n}\nstart();\n```\n\nRequesting this as follow:\n\n```sh\ncurl -v http://localhost:9000\n```\n\nit outputs a HTTP 200 with the expected content:\n\n```sh\n*   Trying 127.0.0.1:9000...\n* TCP_NODELAY set\n* Connected to localhost (127.0.0.1) port 9000 (#0)\n> GET / HTTP/1.1\n> Host: localhost:9000\n> User-Agent: curl/7.68.0\n> Accept: */*\n> \n* Mark bundle as not supporting multiuse\n< HTTP/1.1 200 OK\n< content-type: application/json; charset=utf-8\n< content-length: 17\n< Date: Tue, 03 Nov 2020 19:21:41 GMT\n< Connection: keep-alive\n< Keep-Alive: timeout=5\n< \n* Connection #0 to host localhost left intact\n{\"hello\":\"world\"}\n```\n\nThough, if we request the same route with an `Accept-Version` header:\n\n```sh\ncurl -v -H \"Accept-version: tada\" http://localhost:9000\n```\n\nit outputs a HTTP 404:\n\n```sh\n*   Trying 127.0.0.1:9000...\n* TCP_NODELAY set\n* Connected to localhost (127.0.0.1) port 9000 (#0)\n> GET / HTTP/1.1\n> Host: localhost:9000\n> User-Agent: curl/7.68.0\n> Accept: */*\n> Accept-version: tada\n> \n* Mark bundle as not supporting multiuse\n< HTTP/1.1 404 Not Found\n< content-type: application/json; charset=utf-8\n< content-length: 72\n< Date: Tue, 03 Nov 2020 19:25:09 GMT\n< Connection: keep-alive\n< Keep-Alive: timeout=5\n< \n* Connection #0 to host localhost left intact\n{\"message\":\"Route GET:/ not found\",\"error\":\"Not Found\",\"statusCode\":404}\n```\n\nWhen a http cache / CDN are in front of such a server, an attacker can use this behavior to trigger caching of a 404 page on a legal route. Ex; A default Fastly (the CDN we use) or Varnish config will result in a cached 404 page with the above setup.\n\nWhen versioned routes are in use I also think that a `Vary` http header with `Accept-Version` as a value should be added to the response. That shall prevent a http cache / CDN from caching a 404 under the same cache key as a previous response.\n\nThough; to avoid this behavior when not using version routes I think it should be possible to turn off version routes. Is there an easy way to do so? Type a boolean on the constructor? Or do one need to write a custom version parser which according to doc affect performance?\n\nIts highly debatable if this is a security issue in Fastify, though, behavior of this might be worth having a second look at. Personally I was a bit surprised that versioned routes was a default behavior. I would expect it to be an opt in instead of opt out (if its possible to opt out). \n\n## Supporting Material/References:\n\n- All OSes\n- All node.js versions\n- All NPM versions\n- [BROWSERS VERSIONS, IF APPLICABLE] \n- Any http cache / CDN\n\n# Wrap up\n\n- I contacted the maintainer to let them know: [N] \n- I opened an issue in the related repository: [N]\n\n## Impact\n\nAn attacker can use this cache poisoning to perform an attack where fully functionally URLs are replaced with 404's.",
  "weakness": {
    "id": 86,
    "name": "HTTP Request Smuggling"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [

  ],
  "allow_singular_disclosure_at": "2020-12-10T16:56:04.419Z",
  "allow_singular_disclosure_after": -87834243.23025319,
  "singular_disclosure_allowed": true,
  "vote_count": 8,
  "voters": [
    "youstin",
    "akashhamal0x01",
    "sameersec",
    "0rph1no",
    "cyberguy20",
    "frank-hacker2000",
    "username-me",
    "deigo88"
  ],
  "severity": {
    "rating": "medium",
    "score": 5.9,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "none",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 4647,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "fastify",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [

    ],
    "assignable_team_member_groups": [

    ]
  },
  "activities": [
    {
      "id": 9723639,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugTriaged",
      "message": "Thanks Trygve! This is a tough one and you have found a nice problem. I've added Tomas della Vedova to the report.\n\nI have a few questions.\n\n> When a http cache / CDN are in front of such a server, an attacker can use this behavior to trigger caching of a 404 page on a legal route. Ex; A default Fastly (the CDN we use) or Varnish config will result in a cached 404 page with the above setup.\n\nIf I understand this correctly, you are saying that Fastly and Varnish are going to automatically cache all HTTP responses despite the absence of any specific caching headers (vs what other CDNs do). This seems quite a dangerous behavior from my point of view, specifically for applications that have any logged in control. Have you got some documentation for the default behavior in this case? What's the default behavior for Authorization for example?\n\nThere are infinite ways to perform cache poisoning attacks in those systems. I'm not necessarily sure that a Web Framework responsibility is to cater for them all. If we think this is one of them, then this is a security vulnerability. If we think it's not, it is just a bad design on our part.\n\n---\n\nIrregardless of the severity of the problem I think the fixes should be:\n\n1. put API versioning behind an option argument, disabled by default (potentially breaking)\n2. automatically add a VARY header for accept-version if it's detected in the request. This can work well if we have a flag to enable/disable route versioning\n\nWDYT Tomas? I think we can start working on a fix. We might also consider this a bug in https://github.com/delvedor/find-my-way, as it uses the accept-version strategy as the default. This can also effect Restify, as it using find-my-way internally.",
      "automated_response": false,
      "created_at": "2020-11-04T12:31:58.329Z",
      "updated_at": "2020-11-04T12:31:58.329Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9723886,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ExternalUserJoined",
      "message": "",
      "automated_response": false,
      "created_at": "2020-11-04T13:04:00.827Z",
      "updated_at": "2020-11-04T13:04:00.827Z",
      "actor": {
        "username": "delvedor",
        "cleared": false,
        "verified": false,
        "url": "/delvedor",
        "profile_picture_urls": {
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y63cf8f9mq6rwyf1t3ki58b5v9wx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc?response-content-disposition=inline%3B%20filename%3D%22T0CUZ52US-UC6MMM010-2e8a86c8ea51-512.jpg%22%3B%20filename%2A%3DUTF-8%27%27T0CUZ52US-UC6MMM010-2e8a86c8ea51-512.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWPXH7W2A%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T072007Z&X-Amz-Expires=1321&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJGMEQCIHPD5gEySofUz1xOLbF9RxzsoYi23gDFF6VpbtbxOEbOAiB0gZ0PrWMj9ApM1upCkFsCGj2wZDr0sHM%2FdCN3TWiFlSqwBQgjEAMaDDAxMzYxOTI3NDg0OSIMFefSibaONAmXZdeqKo0FrStIIybrOK6bEwZr5pyK3JxTPHUorBb2V3hjVumlSUzrcUlJuskVWrmNd4RZL3xYp2NFjX6sZJlmfTosswJ6ixEgQRESjrdVab2HF45mm1trgD3HzrFdEa05QJxHMZHXuB0vxaGaUOTokNTEwFLItAjHN8%2FHLB9ycpatLFRq4uVN52spSmTZuDQndEo8CrKUsfA6BtwhxzLkkyZXne1e7M4CpAzxKNKcPiko1jpES02h%2Fmpk5SDR%2BRZgUwj065jAzDlJI%2FvKBvp8t7GbOQq5n5ZWH%2Bz25xRNvUE4i5RKXJizerdDmxAuRROSFAzpdj497%2Fu1CSvhiDHUA%2FVbn8aRwo5DUTNtQtdEeOAEEwiUDCqAgMd5lKuIYIFEIDBuOZNAgvte6VgIXN37ZrqXGK1lsZDS2Hv2bBBHglR9kA4uWBUlZddQ0fUlTAThnBO%2FkixEijGrsWLkkqt8dXMp%2FKYzi2wtDguJlqkw8pnHiViufOnyhy3mr5aLppahgdAOgCchFtV7W9lAV4PB4O0o4p2B9tFko0Jtrln3CsOFrrIzCFf%2BqS2LdxwMZ1jZR3buat3bHV7T5DKtUBs4MGMx6kIi%2FI8gpiY69A3lVRFCjHfWE12sqHEdq9rnG07syd1vglEXDaqqJe%2BYfYR5Ee8nKmckWCkLt0pEGiIA%2FRI%2Bs0ch6NccoW1IiW1uRJG2o64XI%2Bhv3%2Ff2Jg1XfOr%2FKnljk3KQypfib6Zo3eySEuL4cPDCbFIQ%2B4fpUtNBwB%2B6TbMKThow0d%2B9zURqcAZ6QSoDbaT9p04JVxFeOyWzLmH5zvIIt52C%2FVUHGoRrO3ELP6qYs0snGQH6%2FmKbyjnqEMAatXzXI2U9K25Q6ELBK1NGPV0wwYC5qAY6sgHvPFSU40Te8U3TvG0%2FxnZKpqRY7RwHe0EqI8E%2Ffn%2FbAzZtS1msTHhvGiqBntJ%2BccpQwaI%2F7uuwU5ZbJ0JKOVnnBIFFbA%2F2LUwsTSOccxF6VQyLkJQfo0TACBsb8BuejEQN1JySWmkU0BakfQo05LRh87A3TuiIhaxJJzE6m%2B%2BClcIezMNMH9ULosA4UY1PvvIIQAIFyFjboubORtGvP383QMi6o8GCABrtvUKoxEMaCYgZ&X-Amz-SignedHeaders=host&X-Amz-Signature=14b0af2d1b1a2c8de4572b28e393edb9cf74a8bec0b0304b8c82d0712aca21d3"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9724000,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hello, thank you for writing!\nWe can easily add an option in find-my-way (and consequently in Fastify) for disabling route versioning, it will be enabled by default in v3 and disabled in v4.\nI agree that Fastify should set the vary header in case of a versioned route, but I'm not sure if we should define it as a vulnerability.\nI can prepare both pull requests.",
      "automated_response": false,
      "created_at": "2020-11-04T13:18:20.569Z",
      "updated_at": "2020-11-04T13:18:20.569Z",
      "actor": {
        "username": "delvedor",
        "cleared": false,
        "verified": false,
        "url": "/delvedor",
        "profile_picture_urls": {
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y63cf8f9mq6rwyf1t3ki58b5v9wx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc?response-content-disposition=inline%3B%20filename%3D%22T0CUZ52US-UC6MMM010-2e8a86c8ea51-512.jpg%22%3B%20filename%2A%3DUTF-8%27%27T0CUZ52US-UC6MMM010-2e8a86c8ea51-512.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWPXH7W2A%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T072007Z&X-Amz-Expires=1321&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJGMEQCIHPD5gEySofUz1xOLbF9RxzsoYi23gDFF6VpbtbxOEbOAiB0gZ0PrWMj9ApM1upCkFsCGj2wZDr0sHM%2FdCN3TWiFlSqwBQgjEAMaDDAxMzYxOTI3NDg0OSIMFefSibaONAmXZdeqKo0FrStIIybrOK6bEwZr5pyK3JxTPHUorBb2V3hjVumlSUzrcUlJuskVWrmNd4RZL3xYp2NFjX6sZJlmfTosswJ6ixEgQRESjrdVab2HF45mm1trgD3HzrFdEa05QJxHMZHXuB0vxaGaUOTokNTEwFLItAjHN8%2FHLB9ycpatLFRq4uVN52spSmTZuDQndEo8CrKUsfA6BtwhxzLkkyZXne1e7M4CpAzxKNKcPiko1jpES02h%2Fmpk5SDR%2BRZgUwj065jAzDlJI%2FvKBvp8t7GbOQq5n5ZWH%2Bz25xRNvUE4i5RKXJizerdDmxAuRROSFAzpdj497%2Fu1CSvhiDHUA%2FVbn8aRwo5DUTNtQtdEeOAEEwiUDCqAgMd5lKuIYIFEIDBuOZNAgvte6VgIXN37ZrqXGK1lsZDS2Hv2bBBHglR9kA4uWBUlZddQ0fUlTAThnBO%2FkixEijGrsWLkkqt8dXMp%2FKYzi2wtDguJlqkw8pnHiViufOnyhy3mr5aLppahgdAOgCchFtV7W9lAV4PB4O0o4p2B9tFko0Jtrln3CsOFrrIzCFf%2BqS2LdxwMZ1jZR3buat3bHV7T5DKtUBs4MGMx6kIi%2FI8gpiY69A3lVRFCjHfWE12sqHEdq9rnG07syd1vglEXDaqqJe%2BYfYR5Ee8nKmckWCkLt0pEGiIA%2FRI%2Bs0ch6NccoW1IiW1uRJG2o64XI%2Bhv3%2Ff2Jg1XfOr%2FKnljk3KQypfib6Zo3eySEuL4cPDCbFIQ%2B4fpUtNBwB%2B6TbMKThow0d%2B9zURqcAZ6QSoDbaT9p04JVxFeOyWzLmH5zvIIt52C%2FVUHGoRrO3ELP6qYs0snGQH6%2FmKbyjnqEMAatXzXI2U9K25Q6ELBK1NGPV0wwYC5qAY6sgHvPFSU40Te8U3TvG0%2FxnZKpqRY7RwHe0EqI8E%2Ffn%2FbAzZtS1msTHhvGiqBntJ%2BccpQwaI%2F7uuwU5ZbJ0JKOVnnBIFFbA%2F2LUwsTSOccxF6VQyLkJQfo0TACBsb8BuejEQN1JySWmkU0BakfQo05LRh87A3TuiIhaxJJzE6m%2B%2BClcIezMNMH9ULosA4UY1PvvIIQAIFyFjboubORtGvP383QMi6o8GCABrtvUKoxEMaCYgZ&X-Amz-SignedHeaders=host&X-Amz-Signature=14b0af2d1b1a2c8de4572b28e393edb9cf74a8bec0b0304b8c82d0712aca21d3"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9726559,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Added Adam from Snyk as well. Wdyt? Is this worth a CVE and security release? What should be the \"correct\" behavior in this case?",
      "automated_response": false,
      "created_at": "2020-11-04T18:38:25.124Z",
      "updated_at": "2020-11-04T18:38:25.124Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9727915,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "> If I understand this correctly, you are saying that Fastly and Varnish are going to automatically cache all HTTP responses despite the absence of any specific caching headers (vs what other CDNs do). This seems quite a dangerous behavior from my point of view, specifically for applications that have any logged in control. Have you got some documentation for the default behavior in this case? What's the default behavior for Authorization for example?\n\nNo, they will not do that-ish. They, at last Fastly seems to (I've not checked Varnish), operate with a short lived cache on 404 by default for some reason (I assume DDoS prevention). But by default they ignore `Accept-Version` unless it is added to `Vary`. Due to this having ex a `Cache-Control` header does not realy matter for this attack. An attacker can time expiration of the item in cache and then trigger a 404 by adding a `Accept-Version` on the time it expires. Not easy, but possible.\n\nFastly do recommend to add http headers which manipulate the output as part of the cache key or `vary` header:\nhttps://docs.fastly.com/en/guides/manipulating-the-cache-key#before-you-begin\n\n\n> There are infinite ways to perform cache poisoning attacks in those systems. I'm not necessarily sure that a Web Framework responsibility is to cater for them all. If we think this is one of them, then this is a security vulnerability. If we think it's not, it is just a bad design on our part.\n\nI totally agree. There is so many rabbit holes to go down regarding http caching and I do also think its not the task of a Web Framework to prevent all of them. I do though think it is a Web Framework's responsibility to make it easy to adjust behavior which alter the output. In this case, I miss turning off versioning since we are not using it in our service.\n\nTo be honest; it had gone totally under my radar that versioning is default on and that a non-matching `Accept-Version` would trigger a 404 on routes without versioning defined. Versioning is a great feature but I think the majority building a web application is not using it. For APIs it might be different.\n\n> Is this worth a CVE and security release? \n\nI don't think this is worth a CVE or security release due to the complexity in the setup needed for this to be a proper vulnerability (my employer, FINN.no, where though). This is also possible to fix in the http cache / CDN (which we did).",
      "automated_response": false,
      "created_at": "2020-11-04T21:43:31.864Z",
      "updated_at": "2020-11-04T21:43:31.864Z",
      "actor": {
        "username": "trygve_lie",
        "cleared": false,
        "verified": false,
        "url": "/trygve_lie",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/gvMhqhfwJokCwd5WuYZX1fAU/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9731593,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ExternalUserJoined",
      "message": "",
      "automated_response": false,
      "created_at": "2020-11-05T10:24:58.595Z",
      "updated_at": "2020-11-05T10:24:58.595Z",
      "actor": {
        "username": "adamgold7",
        "cleared": false,
        "verified": false,
        "url": "/adamgold7",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9732192,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Another option is to change the default of find-my-way to \"disable\" versioning in a security release and put it behind an option. This is a breaking change, likely for a minority of our users.",
      "automated_response": false,
      "created_at": "2020-11-05T11:52:32.138Z",
      "updated_at": "2020-11-05T11:52:32.138Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9733011,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "From what I understand, all current implementations of Fastify which are not explicitly using route versioning are vulnerable to denial of service, unless mitigated at proxy-level. Therefore, I do think that it's worth issuing a CVE here, after we decide on a proper fix - even if this issue requires a complex setup.\n\nI can see why disabling API versioning by default could be a breaking change - but won't adding a `Vary` header solve the problem, without the need of disabling versioning by default?",
      "automated_response": false,
      "created_at": "2020-11-05T13:36:08.626Z",
      "updated_at": "2020-11-05T13:36:08.626Z",
      "actor": {
        "username": "adamgold7",
        "cleared": false,
        "verified": false,
        "url": "/adamgold7",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9735363,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "> From what I understand, all current implementations of Fastify which are not explicitly using route versioning are vulnerable to denial of service, unless mitigated at proxy-level. Therefore, I do think that it's worth issuing a CVE here, after we decide on a proper fix - even if this issue requires a complex setup.\n\nThe problem is slightly different. __The DoS happens because the proxy decides to perform http caching in the absence of a Cache-Control header__. Unfortunately this is a part of the HTTP I was not aware about.\n\nAs I read in https://tools.ietf.org/html/rfc7231#section-4.3.1, it's stated that GET request are cacheable, independently of the presence of `Cache-Control`.  Apparently it is something that some CDN do, which is something I was not aware until now. This is normally not a problem but in the current case. The exact same issue would happen if some other custom header was set.\n\nMy specific issue with adding a `Vary` header automatically is that it opens up a way to receive a high amount of vulnerabilities, all of them targeting a different header that should be part put in `Vary`. I have seen this behavior first hand, I think it's impossible for a framework to fully protect their users against all possible headers they might include/use. By making versioning opt-in, we are putting it in the hands of our users.\n\nWhat makes me wonder a lot is how a Vary header would be interpreted without a matching Cache-Control header.\n\n---\n\nI think the best path forward is disable versioning by default in find-my-way v2 (possibly v1 as well).\nDocument what is would be required by the app to use versioning in Fastify v3.\n\nGet a CVE for find-my-way and Fastify. I evaluate this at https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L&version=3.1 with a 3.7 score.\n\n",
      "automated_response": false,
      "created_at": "2020-11-05T16:04:06.705Z",
      "updated_at": "2020-11-05T16:04:06.705Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9735532,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "> I can see why disabling API versioning by default could be a breaking change - but won't adding a Vary header solve the problem, without the need of disabling versioning by default?\n\nYes. Adding a `Vary` header will fix this. But adding it to `Vary` will also add a new cache key (possible multiplying entries in the cache) and in a case where one do not use versioning its preferable to just turn versioning off.",
      "automated_response": false,
      "created_at": "2020-11-05T16:35:58.045Z",
      "updated_at": "2020-11-05T16:35:58.045Z",
      "actor": {
        "username": "trygve_lie",
        "cleared": false,
        "verified": false,
        "url": "/trygve_lie",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/gvMhqhfwJokCwd5WuYZX1fAU/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9741920,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "> The problem is slightly different. The DoS happens because the proxy decides to perform http caching in the absence of a Cache-Control header. Unfortunately this is a part of the HTTP I was not aware about.\n\nNot sure about this one. Having a `Cache-Control` header won't make any difference here, so I'd say that the DoS happens because there is a default unkeyed header which makes Fastify give 404. Wouldn't you agree?\n\n> Get a CVE for find-my-way and Fastify. I evaluate this at https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L&version=3.1 with a 3.7 score.\n\nDon't you prefer waiting for a new release?\n\n> My specific issue with adding a Vary header automatically is that it opens up a way to receive a high amount of vulnerabilities, all of them targeting a different header that should be part put in Vary. I have seen this behavior first hand, I think it's impossible for a framework to fully protect their users against all possible headers they might include/use. By making versioning opt-in, we are putting it in the hands of our users.\n> Yes. Adding a Vary header will fix this. But adding it to Vary will also add a new cache key (possible multiplying entries in the cache) and in a case where one do not use versioning its preferable to just turn versioning off.\n\nI definitely agree that versioning should be optional. My idea was just to not turn it off by default in order to not break current implementation, adding a Vary header when versioning is turned on and letting developers turn it off should fix it in my eyes - but perhaps I'm missing something.",
      "automated_response": false,
      "created_at": "2020-11-06T07:58:20.287Z",
      "updated_at": "2020-11-06T07:58:20.287Z",
      "actor": {
        "username": "adamgold7",
        "cleared": false,
        "verified": false,
        "url": "/adamgold7",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9742841,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "> Not sure about this one. Having a Cache-Control header won't make any difference here, so I'd say that the DoS happens because there is a default unkeyed header which makes Fastify give 404. Wouldn't you agree?\n\nSetting a Cache-Control is in the developer/user responsibilities, as configuring their CDN. The assumption this feature was coded with is that CDNs and proxies would not cache GET requests without a Cache-Control header.\n\nYou are right, the problem will be there anyway. I'm merely talking about the default behavior, which should be safe.\n\n> Don't you prefer waiting for a new release?\n\nThat was a list of tasks. Anyway, we'll ship a release in the next few days. Do you agree with the CVSS?\n\n> I definitely agree that versioning should be optional. My idea was just to not turn it off by default in order to not break current implementation, adding a Vary header when versioning is turned on and letting developers turn it off should fix it in my eyes - but perhaps I'm missing something.\n\nIt is not the framework responsibility to manage Vary headers. Those deeply depend on the CDN/Proxy configuration as well as the application that it is using them. By making the framework responsible for managing those, we are exposing ourselves to huge amount of security vulnerabilities. I have seen first hand that accepting a vulnerability of a type would make _n_ copycats be reported.",
      "automated_response": false,
      "created_at": "2020-11-06T08:35:35.330Z",
      "updated_at": "2020-11-06T08:35:35.330Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9743861,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "> It is not the framework responsibility to manage Vary headers. Those deeply depend on the CDN/Proxy configuration as well as the application that it is using them. By making the framework responsible for managing those, we are exposing ourselves to huge amount of security vulnerabilities. I have seen first hand that accepting a vulnerability of a type would make n copycats be reported.\n\nMakes sense.\n\nI would say a 5.9 score is more accurate, changing the availability to high:\nhttps://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H&version=3.1 ",
      "automated_response": false,
      "created_at": "2020-11-06T09:45:46.870Z",
      "updated_at": "2020-11-06T09:46:43.596Z",
      "actor": {
        "username": "adamgold7",
        "cleared": false,
        "verified": false,
        "url": "/adamgold7",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9745723,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Tomas and myself have decided to go for a slightly different fix/strategy that does not require a breaking change.\n\nWe will modify find-my-way so that versioning is enabled at the first use of a versioned route. In this way it would solve the vulnerability for users that do not use versioning in their APIs, while keeping things working for users that do.\n\nWe'll also update the documentation accordingly clearly noting that they will need to add Vary headers or properly configure their CDN.",
      "automated_response": false,
      "created_at": "2020-11-06T11:45:12.497Z",
      "updated_at": "2020-11-06T11:45:12.497Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9749896,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "find-my-way@3.0.5 and find-my-way@2.2.5 are out with the fix.",
      "automated_response": false,
      "created_at": "2020-11-06T17:57:08.371Z",
      "updated_at": "2020-11-06T17:57:08.371Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9750165,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "The Fastify documentation has been [updated](https://github.com/fastify/fastify/pull/2679) as well.",
      "automated_response": false,
      "created_at": "2020-11-06T18:24:09.585Z",
      "updated_at": "2020-11-06T18:24:09.585Z",
      "actor": {
        "username": "delvedor",
        "cleared": false,
        "verified": false,
        "url": "/delvedor",
        "profile_picture_urls": {
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y63cf8f9mq6rwyf1t3ki58b5v9wx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc?response-content-disposition=inline%3B%20filename%3D%22T0CUZ52US-UC6MMM010-2e8a86c8ea51-512.jpg%22%3B%20filename%2A%3DUTF-8%27%27T0CUZ52US-UC6MMM010-2e8a86c8ea51-512.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWPXH7W2A%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T072007Z&X-Amz-Expires=1321&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJGMEQCIHPD5gEySofUz1xOLbF9RxzsoYi23gDFF6VpbtbxOEbOAiB0gZ0PrWMj9ApM1upCkFsCGj2wZDr0sHM%2FdCN3TWiFlSqwBQgjEAMaDDAxMzYxOTI3NDg0OSIMFefSibaONAmXZdeqKo0FrStIIybrOK6bEwZr5pyK3JxTPHUorBb2V3hjVumlSUzrcUlJuskVWrmNd4RZL3xYp2NFjX6sZJlmfTosswJ6ixEgQRESjrdVab2HF45mm1trgD3HzrFdEa05QJxHMZHXuB0vxaGaUOTokNTEwFLItAjHN8%2FHLB9ycpatLFRq4uVN52spSmTZuDQndEo8CrKUsfA6BtwhxzLkkyZXne1e7M4CpAzxKNKcPiko1jpES02h%2Fmpk5SDR%2BRZgUwj065jAzDlJI%2FvKBvp8t7GbOQq5n5ZWH%2Bz25xRNvUE4i5RKXJizerdDmxAuRROSFAzpdj497%2Fu1CSvhiDHUA%2FVbn8aRwo5DUTNtQtdEeOAEEwiUDCqAgMd5lKuIYIFEIDBuOZNAgvte6VgIXN37ZrqXGK1lsZDS2Hv2bBBHglR9kA4uWBUlZddQ0fUlTAThnBO%2FkixEijGrsWLkkqt8dXMp%2FKYzi2wtDguJlqkw8pnHiViufOnyhy3mr5aLppahgdAOgCchFtV7W9lAV4PB4O0o4p2B9tFko0Jtrln3CsOFrrIzCFf%2BqS2LdxwMZ1jZR3buat3bHV7T5DKtUBs4MGMx6kIi%2FI8gpiY69A3lVRFCjHfWE12sqHEdq9rnG07syd1vglEXDaqqJe%2BYfYR5Ee8nKmckWCkLt0pEGiIA%2FRI%2Bs0ch6NccoW1IiW1uRJG2o64XI%2Bhv3%2Ff2Jg1XfOr%2FKnljk3KQypfib6Zo3eySEuL4cPDCbFIQ%2B4fpUtNBwB%2B6TbMKThow0d%2B9zURqcAZ6QSoDbaT9p04JVxFeOyWzLmH5zvIIt52C%2FVUHGoRrO3ELP6qYs0snGQH6%2FmKbyjnqEMAatXzXI2U9K25Q6ELBK1NGPV0wwYC5qAY6sgHvPFSU40Te8U3TvG0%2FxnZKpqRY7RwHe0EqI8E%2Ffn%2FbAzZtS1msTHhvGiqBntJ%2BccpQwaI%2F7uuwU5ZbJ0JKOVnnBIFFbA%2F2LUwsTSOccxF6VQyLkJQfo0TACBsb8BuejEQN1JySWmkU0BakfQo05LRh87A3TuiIhaxJJzE6m%2B%2BClcIezMNMH9ULosA4UY1PvvIIQAIFyFjboubORtGvP383QMi6o8GCABrtvUKoxEMaCYgZ&X-Amz-SignedHeaders=host&X-Amz-Signature=14b0af2d1b1a2c8de4572b28e393edb9cf74a8bec0b0304b8c82d0712aca21d3"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9761606,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@mcollina Great solution!\n\nCVE-2020-7764 has been assigned to a vulnerability in `find-my-way`: https://snyk.io/vuln/SNYK-JS-FINDMYWAY-1038269",
      "automated_response": false,
      "created_at": "2020-11-08T16:49:22.114Z",
      "updated_at": "2020-11-08T17:03:15.901Z",
      "actor": {
        "username": "adamgold7",
        "cleared": false,
        "verified": false,
        "url": "/adamgold7",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9782134,
      "is_internal": false,
      "editable": false,
      "type": "Activities::CveIdAdded",
      "message": "",
      "automated_response": false,
      "created_at": "2020-11-10T16:54:30.236Z",
      "updated_at": "2020-11-10T16:54:30.236Z",
      "cve_ids": [
        "CVE-2020-7764"
      ],
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9782137,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportSeverityUpdated",
      "message": null,
      "automated_response": false,
      "created_at": "2020-11-10T16:55:08.952Z",
      "updated_at": "2020-11-10T16:55:08.952Z",
      "additional_data": {
        "old_severity": null,
        "new_severity": "Medium (5.9)",
        "old_severity_id": null,
        "new_severity_id": 902205
      },
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9782140,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportVulnerabilityTypesUpdated",
      "message": "",
      "automated_response": false,
      "created_at": "2020-11-10T16:55:40.660Z",
      "updated_at": "2020-11-10T16:55:40.660Z",
      "additional_data": {
        "added_weaknesses": [
          {
            "id": 86,
            "name": "HTTP Request Smuggling"
          }
        ],
        "removed_weaknesses": [
          {
            "id": 48,
            "name": "Denial of Service"
          }
        ]
      },
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9782142,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugResolved",
      "message": "",
      "automated_response": false,
      "created_at": "2020-11-10T16:55:55.736Z",
      "updated_at": "2020-11-10T16:55:55.736Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "reporter": {
        "username": "trygve_lie",
        "url": "/trygve_lie"
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9782144,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "",
      "automated_response": false,
      "created_at": "2020-11-10T16:56:04.313Z",
      "updated_at": "2020-11-10T16:56:04.313Z",
      "first_to_agree": true,
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 9782162,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "This is elegible for a reward. Would you like to receive it  Trygve?",
      "automated_response": false,
      "created_at": "2020-11-10T16:58:36.522Z",
      "updated_at": "2020-11-10T16:58:36.522Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 10065276,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportBecamePublic",
      "message": "",
      "automated_response": false,
      "created_at": "2020-12-10T16:56:12.076Z",
      "updated_at": "2020-12-10T16:56:12.076Z",
      "actor": {
        "url": "/nodejs-ecosystem",
        "ibb": false,
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "profile": {
          "name": "Node.js third-party modules"
        }
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 10071988,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "> This is elegible for a reward. Would you like to receive it Trygve?\n\nI honestly did not do much here. I personally would prefer that the reward is given to you who worked on fixing the issue or kept to support work and security in this open source project further.\n\nI would though like to request that the Hacker One user https://hackerone.com/yousteen is added to, or given full credit for, this CVE. My reason for this is because he is the reporter of filing a security issue in my employers (FINN.no) Hacker One bounty program which down the road lead to me detecting this. My employer have two domains where we have Fastly serving the content. These two domains have services behind them where one is built on top of Fastify. A cache poisoning security issue was reported to affect both domains and in our end the issue was tracked down to being mainly caused by a poorly configured Fastly. In our end the reported security issue in our Hacker One report was fixed with a reconfiguration of Fastly.\n\nI did though do a little bit more digging in Fastify and discovered that there was no option to turn off versioning which made me file a question here to ask if this was a concern or not which lead to a code change in your end. I would like to repeat that I find it a bit difficult to justify that this was a security issue in Fastify since a clear fix is by configuring the http cache one might use in front of Fastify.\n\nI will leave it up to you to decide if `yousteen` should be added to, or given full credit for, this CVE.",
      "automated_response": false,
      "created_at": "2020-12-11T11:59:24.440Z",
      "updated_at": "2020-12-11T11:59:24.440Z",
      "actor": {
        "username": "trygve_lie",
        "cleared": false,
        "verified": false,
        "url": "/trygve_lie",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/gvMhqhfwJokCwd5WuYZX1fAU/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 10146386,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@adamgold7 could you please update the CVE to mention yousteen? Thanks.",
      "automated_response": false,
      "created_at": "2020-12-18T18:19:57.661Z",
      "updated_at": "2020-12-18T18:19:57.661Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 10146434,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ExternalUserJoined",
      "message": "",
      "automated_response": false,
      "created_at": "2020-12-18T18:27:09.364Z",
      "updated_at": "2020-12-18T18:27:09.364Z",
      "actor": {
        "username": "youstin",
        "cleared": false,
        "verified": true,
        "url": "/youstin",
        "profile_picture_urls": {
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/h0mbrakd6wloyemt5b2eizdchd40/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc?response-content-disposition=inline%3B%20filename%3D%22an4voxE_700b.jpg%22%3B%20filename%2A%3DUTF-8%27%27an4voxE_700b.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWPXH7W2A%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T072007Z&X-Amz-Expires=1321&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJGMEQCIHPD5gEySofUz1xOLbF9RxzsoYi23gDFF6VpbtbxOEbOAiB0gZ0PrWMj9ApM1upCkFsCGj2wZDr0sHM%2FdCN3TWiFlSqwBQgjEAMaDDAxMzYxOTI3NDg0OSIMFefSibaONAmXZdeqKo0FrStIIybrOK6bEwZr5pyK3JxTPHUorBb2V3hjVumlSUzrcUlJuskVWrmNd4RZL3xYp2NFjX6sZJlmfTosswJ6ixEgQRESjrdVab2HF45mm1trgD3HzrFdEa05QJxHMZHXuB0vxaGaUOTokNTEwFLItAjHN8%2FHLB9ycpatLFRq4uVN52spSmTZuDQndEo8CrKUsfA6BtwhxzLkkyZXne1e7M4CpAzxKNKcPiko1jpES02h%2Fmpk5SDR%2BRZgUwj065jAzDlJI%2FvKBvp8t7GbOQq5n5ZWH%2Bz25xRNvUE4i5RKXJizerdDmxAuRROSFAzpdj497%2Fu1CSvhiDHUA%2FVbn8aRwo5DUTNtQtdEeOAEEwiUDCqAgMd5lKuIYIFEIDBuOZNAgvte6VgIXN37ZrqXGK1lsZDS2Hv2bBBHglR9kA4uWBUlZddQ0fUlTAThnBO%2FkixEijGrsWLkkqt8dXMp%2FKYzi2wtDguJlqkw8pnHiViufOnyhy3mr5aLppahgdAOgCchFtV7W9lAV4PB4O0o4p2B9tFko0Jtrln3CsOFrrIzCFf%2BqS2LdxwMZ1jZR3buat3bHV7T5DKtUBs4MGMx6kIi%2FI8gpiY69A3lVRFCjHfWE12sqHEdq9rnG07syd1vglEXDaqqJe%2BYfYR5Ee8nKmckWCkLt0pEGiIA%2FRI%2Bs0ch6NccoW1IiW1uRJG2o64XI%2Bhv3%2Ff2Jg1XfOr%2FKnljk3KQypfib6Zo3eySEuL4cPDCbFIQ%2B4fpUtNBwB%2B6TbMKThow0d%2B9zURqcAZ6QSoDbaT9p04JVxFeOyWzLmH5zvIIt52C%2FVUHGoRrO3ELP6qYs0snGQH6%2FmKbyjnqEMAatXzXI2U9K25Q6ELBK1NGPV0wwYC5qAY6sgHvPFSU40Te8U3TvG0%2FxnZKpqRY7RwHe0EqI8E%2Ffn%2FbAzZtS1msTHhvGiqBntJ%2BccpQwaI%2F7uuwU5ZbJ0JKOVnnBIFFbA%2F2LUwsTSOccxF6VQyLkJQfo0TACBsb8BuejEQN1JySWmkU0BakfQo05LRh87A3TuiIhaxJJzE6m%2B%2BClcIezMNMH9ULosA4UY1PvvIIQAIFyFjboubORtGvP383QMi6o8GCABrtvUKoxEMaCYgZ&X-Amz-SignedHeaders=host&X-Amz-Signature=7989022c4d6d4ac2535ed998b501ad8f5b6569b548f9c2cf42112f9cec323f66"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 10162837,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Yes, I have updated our database and issued a request to Mitre.",
      "automated_response": false,
      "created_at": "2020-12-21T09:57:44.162Z",
      "updated_at": "2020-12-21T09:57:54.547Z",
      "actor": {
        "username": "adamgold7",
        "cleared": false,
        "verified": false,
        "url": "/adamgold7",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 10163353,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thanks a lot :)",
      "automated_response": false,
      "created_at": "2020-12-21T10:43:29.880Z",
      "updated_at": "2020-12-21T10:43:29.880Z",
      "actor": {
        "username": "trygve_lie",
        "cleared": false,
        "verified": false,
        "url": "/trygve_lie",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/gvMhqhfwJokCwd5WuYZX1fAU/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    }
  ],
  "activity_page_count": 1,
  "activity_page_number": 1,
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}