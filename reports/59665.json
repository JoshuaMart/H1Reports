{
  "id": 59665,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81OTY2NQ==",
  "url": "https://hackerone.com/reports/59665",
  "title": "Local File Inclusion Vulnerability in Concrete5 version 5.7.3.1",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2015-05-05T09:25:03.423Z",
  "submitted_at": "2015-05-05T09:25:03.423Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "egix",
    "url": "/egix",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/001/431/9435ac0bb25492f164582fbbc7e3f6f8f016b1d1_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 60,
    "url": "https://hackerone.com/concretecms",
    "handle": "concretecms",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/mhbwznkvtxed2330krmlxr2bpqa8/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98?response-content-disposition=inline%3B%20filename%3D%22concrete_CMS_logo_-_handat2x.png%22%3B%20filename%2A%3DUTF-8%27%27concrete_CMS_logo_-_handat2x.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXTUOUR45%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T081751Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEC8aCXVzLXdlc3QtMiJHMEUCICrPiGZoGYZLsiyWZomOntHbCbbYoF69CEHystMK47F6AiEA9Pl7g859tY9ncLr%2Btfizqby4A%2FUGQ8zwmBpMDi4XYAwqsQUIKBADGgwwMTM2MTkyNzQ4NDkiDN1WNaeMznAR2PvtAyqOBcSAfgeJrnIZzdmQB1FHXIwM7d%2BwwQZxhqqYoXG0Gx9voOijzbneyg1QXK2fsgN2WU%2FFcJbqT%2B8qTlDuAeMZz78DUWUIK53eDliOxhUtnfmNgySyCjEFPPJDaNlwuUNsP8WgXnhgfen718xS7QFv47SvUzoofD7pRkAVZ7uz%2BxP7TPgqboq8FbSvLw5tRMpmEU6ZjkHLKUWPvMc%2FDoistqwFmf0%2BYetALHH8Ew85ICzstpwfmPLBy9RCRiHnZ3DNYNSZJ6s1UzUO%2Biha81cdbi3Qw9lE9qkEP2VKZ6Z0HiynA1GfdK9XgwfeUtMXwxQCsoTfnflKQTzN4WvUgSjroF%2FDOqI09KAug8Y62mvCsLIVJMoRQo8zalSFwWCF80tZiVILW0syMGICALclVzbgXh4c1Uu0tJlWWBq5MpaoazS8tFtsCIStRbK2y5qi4t%2Fg%2F6%2BoaURstMWAgtxghVrZcexq28rgNG9onOZfZpV4XTkiQdt4p54hq3EZeSRbFMTPYU4zde9FZBDzQfDeWEOtUxbEmUBp0DmL6GezneJoz3TTRsxKcY1fvDlAUGPKUc5MgL6Ztddm3BpMhsnC8T71uaNJEicy%2FtIQUeT7xWw3jB73YJ%2Ft7ihO4h%2B%2FuHlZ2LDsrL7Ja44W60mbUnkWFaw49ko15%2FgkSfMYSQ3ISLHrxeiP1bAou5nbqZ2UII%2B1j0Ln7l6l79HZCsn4QjY168tmupkA08L63499RoBX0pkStOe0VXz46A44G%2FbxEnvQFXOXrFIyxbl1akpqf0u2uUvJJ8BekSXYUxQZwgAP0lydBeqND0%2Bi%2BDtOvcKVUSxaJxNEGESbM%2BY3IuXdyaFfs80RZxwELVYLrKxq76T7gaZt8zDnoLqoBjqxAe7Q5e6zADshY4YEyuA6cau4IPq7UISb49vC3BJjbbeNf57oC7p93fSYV1EvN7YEguTbIOqUSxK5TKuR1mF1GOKE9rgW%2F5CJs2%2BtcbroYYopOS8A7CUN2vjx4%2BwMwYmRBCZA6Msb8F75moxeC7xtswI2luWglaAP9Q3lPK6YywwnhXdMoTqmRwHQa4hISGLnEM1%2FDSQcJKQys2G0lNUEjWQnbYW15LKUnctRAKv2li%2BKNg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=33e5035b9a45ef6e7a916f55ffc8224103fa28b2e7fbd782d9d0f9f1973c94de",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/mhbwznkvtxed2330krmlxr2bpqa8/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937?response-content-disposition=inline%3B%20filename%3D%22concrete_CMS_logo_-_handat2x.png%22%3B%20filename%2A%3DUTF-8%27%27concrete_CMS_logo_-_handat2x.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXTUOUR45%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T081751Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEC8aCXVzLXdlc3QtMiJHMEUCICrPiGZoGYZLsiyWZomOntHbCbbYoF69CEHystMK47F6AiEA9Pl7g859tY9ncLr%2Btfizqby4A%2FUGQ8zwmBpMDi4XYAwqsQUIKBADGgwwMTM2MTkyNzQ4NDkiDN1WNaeMznAR2PvtAyqOBcSAfgeJrnIZzdmQB1FHXIwM7d%2BwwQZxhqqYoXG0Gx9voOijzbneyg1QXK2fsgN2WU%2FFcJbqT%2B8qTlDuAeMZz78DUWUIK53eDliOxhUtnfmNgySyCjEFPPJDaNlwuUNsP8WgXnhgfen718xS7QFv47SvUzoofD7pRkAVZ7uz%2BxP7TPgqboq8FbSvLw5tRMpmEU6ZjkHLKUWPvMc%2FDoistqwFmf0%2BYetALHH8Ew85ICzstpwfmPLBy9RCRiHnZ3DNYNSZJ6s1UzUO%2Biha81cdbi3Qw9lE9qkEP2VKZ6Z0HiynA1GfdK9XgwfeUtMXwxQCsoTfnflKQTzN4WvUgSjroF%2FDOqI09KAug8Y62mvCsLIVJMoRQo8zalSFwWCF80tZiVILW0syMGICALclVzbgXh4c1Uu0tJlWWBq5MpaoazS8tFtsCIStRbK2y5qi4t%2Fg%2F6%2BoaURstMWAgtxghVrZcexq28rgNG9onOZfZpV4XTkiQdt4p54hq3EZeSRbFMTPYU4zde9FZBDzQfDeWEOtUxbEmUBp0DmL6GezneJoz3TTRsxKcY1fvDlAUGPKUc5MgL6Ztddm3BpMhsnC8T71uaNJEicy%2FtIQUeT7xWw3jB73YJ%2Ft7ihO4h%2B%2FuHlZ2LDsrL7Ja44W60mbUnkWFaw49ko15%2FgkSfMYSQ3ISLHrxeiP1bAou5nbqZ2UII%2B1j0Ln7l6l79HZCsn4QjY168tmupkA08L63499RoBX0pkStOe0VXz46A44G%2FbxEnvQFXOXrFIyxbl1akpqf0u2uUvJJ8BekSXYUxQZwgAP0lydBeqND0%2Bi%2BDtOvcKVUSxaJxNEGESbM%2BY3IuXdyaFfs80RZxwELVYLrKxq76T7gaZt8zDnoLqoBjqxAe7Q5e6zADshY4YEyuA6cau4IPq7UISb49vC3BJjbbeNf57oC7p93fSYV1EvN7YEguTbIOqUSxK5TKuR1mF1GOKE9rgW%2F5CJs2%2BtcbroYYopOS8A7CUN2vjx4%2BwMwYmRBCZA6Msb8F75moxeC7xtswI2luWglaAP9Q3lPK6YywwnhXdMoTqmRwHQa4hISGLnEM1%2FDSQcJKQys2G0lNUEjWQnbYW15LKUnctRAKv2li%2BKNg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=36254f52687ae15715387277fc1b8ae1e41f6f3bd4a18c98b3c881b43d60c1f6"
    },
    "permissions": [

    ],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Concrete CMS",
      "twitter_handle": "concrete_cms",
      "website": "https://www.concretecms.org",
      "about": "A simple and powerful content management system."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [

  ],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2016-06-26T18:28:50.200Z",
  "bug_reporter_agreed_on_going_public_at": "2016-05-27T18:28:44.380Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Concrete5 is vulnerable to a Local File Inclusion because it fails to properly validate the path for incoming requests during the dispatching process. This vulnerability exists because the path is retrieved using the Request::getPathInfo() method from the Symfony framework, which allows to specify the path for the request within some HTTP headers (like X-Original-URL and some others). However, this cannot be considered a vulnerability within the Symfony framework, but a vulnerability due to the way Concrete5 dispatches the request using that feature.",
  "weakness": {
    "id": 57,
    "name": "Violation of Secure Design Principles"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 36778,
      "file_name": "Concrete5-LFI.pdf",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/036/778/abecbb9e320bece8dfc1433122b90c11dd4197ab/Concrete5-LFI.pdf?response-content-disposition=attachment%3B%20filename%3D%22Concrete5-LFI.pdf%22%3B%20filename%2A%3DUTF-8%27%27Concrete5-LFI.pdf&response-content-type=application%2Fpdf&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXTUOUR45%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T081751Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEC8aCXVzLXdlc3QtMiJHMEUCICrPiGZoGYZLsiyWZomOntHbCbbYoF69CEHystMK47F6AiEA9Pl7g859tY9ncLr%2Btfizqby4A%2FUGQ8zwmBpMDi4XYAwqsQUIKBADGgwwMTM2MTkyNzQ4NDkiDN1WNaeMznAR2PvtAyqOBcSAfgeJrnIZzdmQB1FHXIwM7d%2BwwQZxhqqYoXG0Gx9voOijzbneyg1QXK2fsgN2WU%2FFcJbqT%2B8qTlDuAeMZz78DUWUIK53eDliOxhUtnfmNgySyCjEFPPJDaNlwuUNsP8WgXnhgfen718xS7QFv47SvUzoofD7pRkAVZ7uz%2BxP7TPgqboq8FbSvLw5tRMpmEU6ZjkHLKUWPvMc%2FDoistqwFmf0%2BYetALHH8Ew85ICzstpwfmPLBy9RCRiHnZ3DNYNSZJ6s1UzUO%2Biha81cdbi3Qw9lE9qkEP2VKZ6Z0HiynA1GfdK9XgwfeUtMXwxQCsoTfnflKQTzN4WvUgSjroF%2FDOqI09KAug8Y62mvCsLIVJMoRQo8zalSFwWCF80tZiVILW0syMGICALclVzbgXh4c1Uu0tJlWWBq5MpaoazS8tFtsCIStRbK2y5qi4t%2Fg%2F6%2BoaURstMWAgtxghVrZcexq28rgNG9onOZfZpV4XTkiQdt4p54hq3EZeSRbFMTPYU4zde9FZBDzQfDeWEOtUxbEmUBp0DmL6GezneJoz3TTRsxKcY1fvDlAUGPKUc5MgL6Ztddm3BpMhsnC8T71uaNJEicy%2FtIQUeT7xWw3jB73YJ%2Ft7ihO4h%2B%2FuHlZ2LDsrL7Ja44W60mbUnkWFaw49ko15%2FgkSfMYSQ3ISLHrxeiP1bAou5nbqZ2UII%2B1j0Ln7l6l79HZCsn4QjY168tmupkA08L63499RoBX0pkStOe0VXz46A44G%2FbxEnvQFXOXrFIyxbl1akpqf0u2uUvJJ8BekSXYUxQZwgAP0lydBeqND0%2Bi%2BDtOvcKVUSxaJxNEGESbM%2BY3IuXdyaFfs80RZxwELVYLrKxq76T7gaZt8zDnoLqoBjqxAe7Q5e6zADshY4YEyuA6cau4IPq7UISb49vC3BJjbbeNf57oC7p93fSYV1EvN7YEguTbIOqUSxK5TKuR1mF1GOKE9rgW%2F5CJs2%2BtcbroYYopOS8A7CUN2vjx4%2BwMwYmRBCZA6Msb8F75moxeC7xtswI2luWglaAP9Q3lPK6YywwnhXdMoTqmRwHQa4hISGLnEM1%2FDSQcJKQys2G0lNUEjWQnbYW15LKUnctRAKv2li%2BKNg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=8b9021f7187977f415cffea9659902b46559983a73df13be315fa452318e6356",
      "file_size": 567761,
      "type": "application/pdf",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2016-06-26T18:28:44.484Z",
  "allow_singular_disclosure_after": -228491347.51148376,
  "singular_disclosure_allowed": true,
  "vote_count": 10,
  "voters": [
    "omarelfarsaoui",
    "daehee",
    "h3xtor",
    "hunter",
    "mak",
    "johndoe1492",
    "detroitsmash",
    "tuckercarlson",
    "dyabla",
    "pei"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [

    ],
    "assignable_team_member_groups": [

    ]
  },
  "activities": [
    {
      "id": 402297,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugTriaged",
      "message": "Thanks for this report, It looks valid and ill get this taken care of asap.",
      "automated_response": false,
      "created_at": "2015-05-05T15:28:24.520Z",
      "updated_at": "2015-05-05T15:28:24.520Z",
      "actor": {
        "username": "mnkras",
        "cleared": false,
        "verified": false,
        "url": "/mnkras",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/003/844/ec0ad0d7189e5d34e9b4063ef708e600dca89435_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "concretecms"
    },
    {
      "id": 402643,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thanks, we will have a fix for this in place for our next release.",
      "automated_response": false,
      "created_at": "2015-05-05T19:25:43.209Z",
      "updated_at": "2015-05-05T19:25:43.209Z",
      "actor": {
        "username": "aembler",
        "cleared": false,
        "verified": false,
        "url": "/aembler",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "concretecms"
    },
    {
      "id": 402653,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugResolved",
      "message": "A patch for this bug has been merged into the development branch of concrete5 and will be available in the next version of concrete5.\n\nThank you for bringing this to our attention.",
      "automated_response": false,
      "created_at": "2015-05-05T19:32:49.516Z",
      "updated_at": "2015-05-05T19:32:49.516Z",
      "actor": {
        "username": "aembler",
        "cleared": false,
        "verified": false,
        "url": "/aembler",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "reporter": {
        "username": "egix",
        "url": "/egix"
      },
      "genius_execution_id": null,
      "team_handle": "concretecms"
    },
    {
      "id": 404096,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Would you mind to publicly disclose this bug?",
      "automated_response": false,
      "created_at": "2015-05-07T09:29:19.869Z",
      "updated_at": "2015-05-07T09:29:19.869Z",
      "actor": {
        "username": "egix",
        "cleared": false,
        "verified": true,
        "url": "/egix",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/001/431/9435ac0bb25492f164582fbbc7e3f6f8f016b1d1_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "concretecms"
    },
    {
      "id": 404103,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "",
      "automated_response": false,
      "created_at": "2015-05-07T09:31:15.900Z",
      "updated_at": "2015-05-07T09:31:15.900Z",
      "first_to_agree": true,
      "actor": {
        "username": "egix",
        "cleared": false,
        "verified": true,
        "url": "/egix",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/001/431/9435ac0bb25492f164582fbbc7e3f6f8f016b1d1_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "concretecms"
    },
    {
      "id": 405256,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Your bug fix does not solve the vulnerability completely. If you read my report you'll see that I wrote << For instance, it is possible to trigger a Local File Inclusion leveraging the dispatching for the “/tools/{tool}” path >>. However, this is not the only path exploitable (that's why I wrote FOR INSTANCE): another similar path which will trigger a Local File Inclusion is \"/tools/blocks/{btHandle}/{tool}\", and there might be other routes useful to exploit the bug. For this reason I think the correct fix for this vulnerability would be within the Application::dispatch() method, just check the value returned by $request->getPathInfo() against potential path traversal sequences, this should prevent any possible exploitation.\n\nAs you can see with the following request, Concrete5 version 5.7.4 is still vulnerable (this will trigger the same error shown in the report):\n\nGET /concrete5.7.4/ HTTP/1.1\nHost: localhost\nX-Original-Url: /tools/blocks/image/../../../../index\nConnection: close",
      "automated_response": false,
      "created_at": "2015-05-08T18:14:43.376Z",
      "updated_at": "2015-05-08T18:14:43.376Z",
      "actor": {
        "username": "egix",
        "cleared": false,
        "verified": true,
        "url": "/egix",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/001/431/9435ac0bb25492f164582fbbc7e3f6f8f016b1d1_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "concretecms"
    },
    {
      "id": 405591,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugReopened",
      "message": "Re-opening for further investigation",
      "automated_response": false,
      "created_at": "2015-05-09T03:02:18.441Z",
      "updated_at": "2015-05-09T03:02:18.441Z",
      "actor": {
        "username": "mnkras",
        "cleared": false,
        "verified": false,
        "url": "/mnkras",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/003/844/ec0ad0d7189e5d34e9b4063ef708e600dca89435_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "concretecms"
    },
    {
      "id": 475656,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Yeah, upon further reflection I agree with the post. We could add additional protection to the ToolController::displayBlock() method but I think we should add a check to the Application::dispatch() method instead that checks for path traversal in the getPathInfo(). Let's do that. ",
      "automated_response": false,
      "created_at": "2015-06-17T19:01:22.043Z",
      "updated_at": "2015-06-17T19:01:22.043Z",
      "actor": {
        "username": "aembler",
        "cleared": false,
        "verified": false,
        "url": "/aembler",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "concretecms"
    },
    {
      "id": 640078,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugResolved",
      "message": "Resolved in [this commit](https://github.com/concrete5/concrete5/commit/cab4c2a).",
      "automated_response": false,
      "created_at": "2015-10-31T20:54:39.900Z",
      "updated_at": "2015-10-31T20:54:39.900Z",
      "actor": {
        "username": "korvin",
        "cleared": false,
        "verified": false,
        "url": "/korvin",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "reporter": {
        "username": "egix",
        "url": "/egix"
      },
      "genius_execution_id": null,
      "team_handle": "concretecms"
    },
    {
      "id": 641872,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Unfortunately, the check you added with commit [#cab4c2a](https://github.com/concrete5/concrete5/commit/cab4c2a) is not enough to prevent exploitation of this vulnerability. First of all, I guess the check will not work if Concrete5 is running on a Windows machine, since you check for \"/../\" sequences only, and not for \"\\\\..\\\" sequences - I said \"I guess\" because I haven't tested that. Furthermore, that check could be easily bypassed via URL encoding, because the *UrlMatcher::match()* method - which is called by the *Application::dispatch()* method - will use the *rawurldecode()* function with the provided path.\n\nI just tested with the following request against a fresh install of Concrete5 (cloned from the official GitHub repository), which still triggers the same error shown in the report:\n\n```\nGET /concrete5/index.php HTTP/1.1\nHost: localhost\nX-Original-Url: /tools/blocks/image/%2e%2e/%2e%2e/%2e%2e/%2e%2e/index\nConnection: close\n```",
      "automated_response": false,
      "created_at": "2015-11-02T22:43:46.460Z",
      "updated_at": "2015-11-02T22:43:46.460Z",
      "actor": {
        "username": "egix",
        "cleared": false,
        "verified": true,
        "url": "/egix",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/001/431/9435ac0bb25492f164582fbbc7e3f6f8f016b1d1_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "concretecms"
    },
    {
      "id": 641907,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Some more good catches, thank you @egix.\n\nI think changing `$path = $request->getPathInfo();` to `$path = urldecode($request->getPathInfo());` will fix the encoded url issue. For windows we can simply change the conditional to include both forward slashes and backward slashes to fix the windows case. Are there any more edge cases that you can think of for this?\n\nI really appreciate the thorough testing on this one,\nKorvin",
      "automated_response": false,
      "created_at": "2015-11-02T23:14:52.296Z",
      "updated_at": "2015-11-02T23:14:52.296Z",
      "actor": {
        "username": "korvin",
        "cleared": false,
        "verified": false,
        "url": "/korvin",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "concretecms"
    },
    {
      "id": 641909,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugReopened",
      "message": "",
      "automated_response": false,
      "created_at": "2015-11-02T23:15:07.433Z",
      "updated_at": "2015-11-02T23:15:07.433Z",
      "actor": {
        "username": "korvin",
        "cleared": false,
        "verified": false,
        "url": "/korvin",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "concretecms"
    },
    {
      "id": 726385,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugResolved",
      "message": "https://github.com/concrete5/concrete5/commit/19d0cc81c7cd485b856289ac71ebc0389ea7c3da\nhttps://github.com/concrete5/concrete5/commit/c646dd0defcfa79ef119dca8ba1beba2c5bc91ea\n\nshould resolve this issue completely. Please take a look and double check for me when you have time.\n\nThanks,\nKorvin",
      "automated_response": false,
      "created_at": "2015-12-18T23:26:43.659Z",
      "updated_at": "2015-12-18T23:26:43.659Z",
      "actor": {
        "username": "korvin",
        "cleared": false,
        "verified": false,
        "url": "/korvin",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "reporter": {
        "username": "egix",
        "url": "/egix"
      },
      "genius_execution_id": null,
      "team_handle": "concretecms"
    },
    {
      "id": 726765,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "I think the issue is resolved now, the fix looks ok. I'll let you know whether the fix is incomplete when I have some free time to test it.",
      "automated_response": false,
      "created_at": "2015-12-19T12:14:24.596Z",
      "updated_at": "2015-12-19T12:14:24.596Z",
      "actor": {
        "username": "egix",
        "cleared": false,
        "verified": true,
        "url": "/egix",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/001/431/9435ac0bb25492f164582fbbc7e3f6f8f016b1d1_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "concretecms"
    },
    {
      "id": 987820,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "",
      "automated_response": false,
      "created_at": "2016-05-27T18:28:44.400Z",
      "updated_at": "2016-05-27T18:28:44.400Z",
      "first_to_agree": true,
      "actor": {
        "username": "egix",
        "cleared": false,
        "verified": true,
        "url": "/egix",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/001/431/9435ac0bb25492f164582fbbc7e3f6f8f016b1d1_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "concretecms"
    },
    {
      "id": 1038260,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportBecamePublic",
      "message": "",
      "automated_response": false,
      "created_at": "2016-06-26T18:28:50.229Z",
      "updated_at": "2016-06-26T18:28:50.229Z",
      "actor": {
        "url": "/concretecms",
        "ibb": false,
        "profile_picture_urls": {
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/mhbwznkvtxed2330krmlxr2bpqa8/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937?response-content-disposition=inline%3B%20filename%3D%22concrete_CMS_logo_-_handat2x.png%22%3B%20filename%2A%3DUTF-8%27%27concrete_CMS_logo_-_handat2x.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXTUOUR45%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T081752Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEC8aCXVzLXdlc3QtMiJHMEUCICrPiGZoGYZLsiyWZomOntHbCbbYoF69CEHystMK47F6AiEA9Pl7g859tY9ncLr%2Btfizqby4A%2FUGQ8zwmBpMDi4XYAwqsQUIKBADGgwwMTM2MTkyNzQ4NDkiDN1WNaeMznAR2PvtAyqOBcSAfgeJrnIZzdmQB1FHXIwM7d%2BwwQZxhqqYoXG0Gx9voOijzbneyg1QXK2fsgN2WU%2FFcJbqT%2B8qTlDuAeMZz78DUWUIK53eDliOxhUtnfmNgySyCjEFPPJDaNlwuUNsP8WgXnhgfen718xS7QFv47SvUzoofD7pRkAVZ7uz%2BxP7TPgqboq8FbSvLw5tRMpmEU6ZjkHLKUWPvMc%2FDoistqwFmf0%2BYetALHH8Ew85ICzstpwfmPLBy9RCRiHnZ3DNYNSZJ6s1UzUO%2Biha81cdbi3Qw9lE9qkEP2VKZ6Z0HiynA1GfdK9XgwfeUtMXwxQCsoTfnflKQTzN4WvUgSjroF%2FDOqI09KAug8Y62mvCsLIVJMoRQo8zalSFwWCF80tZiVILW0syMGICALclVzbgXh4c1Uu0tJlWWBq5MpaoazS8tFtsCIStRbK2y5qi4t%2Fg%2F6%2BoaURstMWAgtxghVrZcexq28rgNG9onOZfZpV4XTkiQdt4p54hq3EZeSRbFMTPYU4zde9FZBDzQfDeWEOtUxbEmUBp0DmL6GezneJoz3TTRsxKcY1fvDlAUGPKUc5MgL6Ztddm3BpMhsnC8T71uaNJEicy%2FtIQUeT7xWw3jB73YJ%2Ft7ihO4h%2B%2FuHlZ2LDsrL7Ja44W60mbUnkWFaw49ko15%2FgkSfMYSQ3ISLHrxeiP1bAou5nbqZ2UII%2B1j0Ln7l6l79HZCsn4QjY168tmupkA08L63499RoBX0pkStOe0VXz46A44G%2FbxEnvQFXOXrFIyxbl1akpqf0u2uUvJJ8BekSXYUxQZwgAP0lydBeqND0%2Bi%2BDtOvcKVUSxaJxNEGESbM%2BY3IuXdyaFfs80RZxwELVYLrKxq76T7gaZt8zDnoLqoBjqxAe7Q5e6zADshY4YEyuA6cau4IPq7UISb49vC3BJjbbeNf57oC7p93fSYV1EvN7YEguTbIOqUSxK5TKuR1mF1GOKE9rgW%2F5CJs2%2BtcbroYYopOS8A7CUN2vjx4%2BwMwYmRBCZA6Msb8F75moxeC7xtswI2luWglaAP9Q3lPK6YywwnhXdMoTqmRwHQa4hISGLnEM1%2FDSQcJKQys2G0lNUEjWQnbYW15LKUnctRAKv2li%2BKNg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=03b0c2f3fafe54cd7f9ce193ac513d139aa4dfb13993cf17807406adde2a2049"
        },
        "profile": {
          "name": "Concrete CMS"
        }
      },
      "genius_execution_id": null,
      "team_handle": "concretecms"
    }
  ],
  "activity_page_count": 1,
  "activity_page_number": 1,
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}