{
  "id": 541354,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NDEzNTQ=",
  "url": "https://hackerone.com/reports/541354",
  "title": "A specifically malformed MQTT Subscribe packet crashes MQTT Brokers using the mqtt-packet module for decoding  ",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2019-04-17T15:00:31.503Z",
  "submitted_at": "2019-04-17T15:00:31.503Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "lxndr",
    "url": "/lxndr",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 23949,
    "url": "https://hackerone.com/nodejs-ecosystem",
    "handle": "nodejs-ecosystem",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [

    ],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Node.js third-party modules",
      "twitter_handle": "",
      "website": "https://nodejs.org/en/security/",
      "about": "This program was used to handle vulnerabilities in the Node.js ecosystem."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2019-5432"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-04-28T07:36:31.109Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2019-04-28T07:36:22.404Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I would like to report a buffer over-read in mqtt-packet respectively BufferList module.\nIt allows triggering an out of range read on a buffer which throws a RangeError. MQTT Brokers like mosca and aedes using this module can be forced to crash by sending a specifically malformed MQTT Subscribe packet. \n\n# Module\n\n**module name:** mqtt-packet\n**version:** 6.1.1\n**npm page:** `https://www.npmjs.com/package/mqtt-packet`\n\n## Module Description\n\nEncode and Decode MQTT 3.1.1, 5.0 packets the node way.\n\n## Module Stats\n\n114,635 weekly downloads\n\n# Vulnerability\n\n## Vulnerability Description\n\nFrom the original E-Mail to the Author:\n*Hey Matteo,\nwhile playing around with mosca/aedes and our fuzzing approach from IoT-Testware, I discovered some flaws which cause mosca/aedes to crash. Though, I assume the reasons originate from the mqtt-packet respectively bl modules. \nI didn't open an issue because the issue is IMHO quite critical. One could try to abuse to crash mosca/aedes without requiring any credentials, thus might lead to easy DoS attacks.\nThe malformed Subscribe Packet crashes mosca (v2.8.3) and aedes (v0.37.0), no valid credentials required.*\n\n## Steps To Reproduce:\n\n> Detailed steps to reproduce with all required references/steps/commands. If there is any exploit code or reference to the package source code this is the place where it should be put.\n\n1. start either mosca or aedes MQTT Broker\n2. shoot the following command against the Broker (on localhost)\n  * `echo -ne '\\x104\\x00\\x04MQTT\\x04\\xc2\\x00\\xff\\x00\\x19alicedoesnotneedaclientid\\x00\\x05alice\\x00\\x06secret\\x82\\x19\\xa5\\xa6\\x00\\x15hello/topic/of/alice\\x00' | nc localhost 1883`\n  * the sent byte string contains 2 accumulated MQTT Packets. The second packet is a subscribe packet and is processed in any case and the Broker's Auth mechanisms are undermined.\n\n## Patch\n\nPlease find a GitHub patch attached.\n\n## Supporting Material/References:\n\n> State all technical information about the stack where the vulnerability was found\n\n- Ubuntu 18.04.2 LTS\n- nodejs -v `v6.17.1`\n- npm -v `3.10.10`\n\n# Wrap up\n\n- I contacted the maintainer to let them know: [Y] \n- I opened an issue in the related repository: [N]\n\n## Impact\n\nAn attacker can harm the availability of MQTT services which are using these modules.",
  "weakness": {
    "id": 9,
    "name": "Buffer Over-read"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 470856,
      "file_name": "fix_malformed_subscribe_crash.patch",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/470/856/5ce59c60e49c87feb9b3ea1f26938d8965c235f2/fix_malformed_subscribe_crash.patch?response-content-disposition=attachment%3B%20filename%3D%22fix_malformed_subscribe_crash.patch%22%3B%20filename%2A%3DUTF-8%27%27fix_malformed_subscribe_crash.patch&response-content-type=text%2Fx-diff&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQRWDIYOMA%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T074346Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEC8aCXVzLXdlc3QtMiJHMEUCIFNLdnPGtLwKMqDt0NQfrZo0FnfieCdt70b8x7mZltnYAiEAvoj8eBF%2Fz9RmxiwioQTjaAkY5y8glP7YJHIdVEiSRjIqsgUIKBADGgwwMTM2MTkyNzQ4NDkiDKwmuAj4%2Be1s5lbylSqPBcomyuxhildk0NUANV3%2BftlYYJCWX1M%2B1xqa23Q06%2By7YS%2BQATcLYhjMRKLHIGZfd3bianhW%2FgdFm4gpQAmwDHRw2igbV1zSavkNvXqacnFdw4Oln9SHRd2e4zuwk%2F2GviKwn1nZunhhdOuu6g7A2DA%2FQefyAlyQYpy%2FHRGl7J9kIPlFGlBK9CAul0kzKyTjlygr3Hz7DB5F6X4FcS71gvzmFC%2Fa6bf1tdfq46kICi9nBXV8Yep%2FEmkoi%2FkPVN6jpqZHrrqGL%2BeKOCEw6yXkZefklvRs%2Bmud%2BPdLs6D35uN9GpF0h2lyRl7mI1tGYSVdAxrxhb%2FnLZ%2BBbcvE%2FzPbIbOkYt%2F4kzBjPA33r7a6gRZo6xBI%2BqcHTUEoZlsC%2FePoA0bzI%2BY%2B9Kn7r266PdCrFtOI0TtLDtrt1a%2FsYB7r39ZReNeBUZjFy71DofxHhuMplWoZ%2B5suYOSkCpnX8ox%2FexG03tPH%2B%2BYi%2B7JKgMNo8Ywg0LUY4FIgqUOY3m9G4vsQ2yNVvhHzc1zFQ%2BaZDinuNqUJycV22%2Bal4yI7Vu8zRPT0XS8nU9mRxPyMOxBhqiEpipRhHvEk6ruVgSYpVrhEqZHRnwv%2FiS2CGZuiFnzVyfzzNc0a1K3NA%2Bqp8X%2FGc2IrCqLgJiIar1EgInaI6d3yXHytJb5boQ1Ym5HsML5oSphvP1hBCFvgtrkpt3teC9sz%2F02EwDEGzubXTtTxqnHBOiqeNpfNEReBvGYlciW1L%2FxLQxgqD5RpQ5CUBnf67bJivw%2BtoZ%2BpV3UvOdvkG99R3Yb6KV5k2Ly3LruRvseHIOA2KILhuT0Arnm9FUq1BvuB593ehUm8src6x4P2nT6wjhA9E2kekyi7othxiuSueSwwyp66qAY6sQGfl2fsTY6VWTPrJHQD%2BPDh1xgsgnaytGIcrwK1OGEf8WVcLpw6bEJ6BKLFS7l9GZDwFvjz7J48x%2Bl7YfFRkEZXRmoO3ak0duYeBuy3U2I6DbXdUZZIWlnrcVoExjgWQHiADxJVCKngMqQP1GNwrY9M5Of5s5Z3zUQwD3EqxVcljRFvNHznFkHj8b2eCVcdpPMI6JyXX4H9nyjUW4XvHJwg%2F0AQay6G%2BksUHKVQvEI2UA4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=8e06dfbf50c217e9cbb220aaea183ac78b1c1bf3de54ac7802ce1cb75d483f80",
      "file_size": 1714,
      "type": "text/x-diff",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2019-05-28T07:36:22.481Z",
  "allow_singular_disclosure_after": -136426043.54725483,
  "singular_disclosure_allowed": true,
  "vote_count": 3,
  "voters": [
    "bl4de",
    "khizer47",
    "questsin"
  ],
  "severity": {
    "rating": "high",
    "score": 7.5,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "none",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 25530,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "mqtt-packet",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [

    ],
    "assignable_team_member_groups": [

    ]
  },
  "activities": [
    {
      "id": 4584562,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hello,\nThanks for reporting this to us. Someone will quickly look at this report and triage it.",
      "automated_response": true,
      "created_at": "2019-04-17T15:00:38.006Z",
      "updated_at": "2019-04-17T15:00:38.006Z",
      "actor": {
        "username": "vdeturckheim_dev",
        "cleared": false,
        "verified": false,
        "url": "/vdeturckheim_dev",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4585108,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugTriaged",
      "message": "",
      "automated_response": false,
      "created_at": "2019-04-17T15:50:56.502Z",
      "updated_at": "2019-04-17T15:50:56.502Z",
      "actor": {
        "username": "lirantal",
        "cleared": false,
        "verified": false,
        "url": "/lirantal",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4587028,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "HiÂ @lxndr,\n\nThanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as a vulnerability.\nI invited Matteo to the issue to confirm, and coordinate a fix.\n",
      "automated_response": false,
      "created_at": "2019-04-17T21:05:05.783Z",
      "updated_at": "2019-04-17T21:05:05.783Z",
      "actor": {
        "username": "lirantal",
        "cleared": false,
        "verified": false,
        "url": "/lirantal",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4587039,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@mcollina can you confirm which versions are vulnerable and which has the fix? (hopefully a patch version if the fix doesn't break anything or adds any other functionality)\n\nWe should probably let the report stay undisclosed for a week or two until enough users adopt the new version and then I'll disclose and request a CVE.",
      "automated_response": false,
      "created_at": "2019-04-17T21:08:25.493Z",
      "updated_at": "2019-04-17T21:08:25.493Z",
      "actor": {
        "username": "lirantal",
        "cleared": false,
        "verified": false,
        "url": "/lirantal",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4587183,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ExternalUserJoined",
      "message": "",
      "automated_response": false,
      "created_at": "2019-04-17T21:27:52.637Z",
      "updated_at": "2019-04-17T21:27:52.637Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4587189,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "All release lines of mqtt-packet are vulnerable.\nI'm planning to patch as many as I can, because there are some old dependency chains. As an example, mqtt@1 uses mqtt-packet 3.x https://github.com/mqttjs/MQTT.js/blob/v1.14.1/package.json#L56.",
      "automated_response": false,
      "created_at": "2019-04-17T21:31:51.765Z",
      "updated_at": "2019-04-17T21:31:51.765Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4587229,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Understood. I can see that this dates quite a few years back too.",
      "automated_response": false,
      "created_at": "2019-04-17T21:43:17.843Z",
      "updated_at": "2019-04-17T21:43:17.843Z",
      "actor": {
        "username": "lirantal",
        "cleared": false,
        "verified": false,
        "url": "/lirantal",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4587732,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "This has been fixed in v3.5.1, v4.1.3, v5.6.1, v6.1.2 (latest).\nAll other releases are vulnerable",
      "automated_response": false,
      "created_at": "2019-04-17T23:13:48.069Z",
      "updated_at": "2019-04-17T23:13:48.069Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4587740,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Feel free to disclose whenever you prefer.",
      "automated_response": false,
      "created_at": "2019-04-17T23:19:05.664Z",
      "updated_at": "2019-04-17T23:19:05.664Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4588715,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "@mcollina does the following version range seems right:\nvulnerable: <3.5.1 || >=4.0.0 <4.1.3 || >=5.0.0 <5.6.1 || >=6.0.0 <6.1.2\npatched: >=3.5.1 <4.0.0 || >=4.1.3 <5.0.0 || >=5.6.1 <6.0.0 || >=6.1.2\n\n@lxndr can you please confirm the fix?\n",
      "automated_response": false,
      "created_at": "2019-04-18T06:23:33.961Z",
      "updated_at": "2019-04-18T06:23:33.961Z",
      "actor": {
        "username": "lirantal",
        "cleared": false,
        "verified": false,
        "url": "/lirantal",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4588810,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Given that the code has been extracted from MQTT.js long ago, this vulnerability applies to mqtt < 1.0.0 as well.",
      "automated_response": false,
      "created_at": "2019-04-18T07:04:17.341Z",
      "updated_at": "2019-04-18T07:04:17.341Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4588826,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Good point to have here in the report when it gets disclosed. We don't have reports for consumers of each library but perhaps MQTT.js is a different case as the code used to live there. Seems that 1.0.0 branch is quite old so we can do one of:\n1. Add a security disclosure to the MQTT.js library README/GitHub page with regards to versions affected (such as the <1.0.0)\n2. Submit a new report for the affected MQTT.js versions \n\n(2) is probably the better way of doing it if you or @lxndr are up for another vulnerability report.",
      "automated_response": false,
      "created_at": "2019-04-18T07:10:26.016Z",
      "updated_at": "2019-04-18T07:10:26.016Z",
      "actor": {
        "username": "lirantal",
        "cleared": false,
        "verified": false,
        "url": "/lirantal",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4588832,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "I think 2 is the best option. The recommendation in that case is \"upgrade\".",
      "automated_response": false,
      "created_at": "2019-04-18T07:12:39.702Z",
      "updated_at": "2019-04-18T07:12:39.702Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4588843,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Indeed ðŸ‘",
      "automated_response": false,
      "created_at": "2019-04-18T07:15:18.870Z",
      "updated_at": "2019-04-18T07:15:18.870Z",
      "actor": {
        "username": "lirantal",
        "cleared": false,
        "verified": false,
        "url": "/lirantal",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4589411,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "sorry for the delayed response.\n\n@lirantal confirmed ðŸ‘\n\n*We should probably let the report stay undisclosed for a week or two until enough users adopt the new version and then I'll disclose and request a CVE.*\n\nIt's no rush for disclosure from my side. \nOption 2 sounds feasible. I'll prefer to let @mcollina go ahead with a subsequent report or whatever is required. ",
      "automated_response": false,
      "created_at": "2019-04-18T08:35:52.134Z",
      "updated_at": "2019-04-18T08:35:52.134Z",
      "actor": {
        "username": "lxndr",
        "cleared": false,
        "verified": false,
        "url": "/lxndr",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4589452,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thanks!\nSounds good",
      "automated_response": false,
      "created_at": "2019-04-18T08:38:21.002Z",
      "updated_at": "2019-04-18T08:38:21.002Z",
      "actor": {
        "username": "lirantal",
        "cleared": false,
        "verified": false,
        "url": "/lirantal",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4593338,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "I will not have time to do a report on MQTT.js for the next few weeks - I'm on vacation and then at Build.",
      "automated_response": false,
      "created_at": "2019-04-18T16:58:15.766Z",
      "updated_at": "2019-04-18T16:58:15.766Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4604659,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Okay, no problem. We have also vacation time over here. \nBut I will have time on Tuesday to write a new one. \n\nJust to confirm, the final affected MQTT.js versions are\nvulnerable: <1.0.0 || <3.5.1 || >=4.0.0 <4.1.3 || >=5.0.0 <5.6.1 || >=6.0.0 <6.1.2\nright?",
      "automated_response": false,
      "created_at": "2019-04-20T08:16:20.886Z",
      "updated_at": "2019-04-20T08:16:20.886Z",
      "actor": {
        "username": "lxndr",
        "cleared": false,
        "verified": false,
        "url": "/lxndr",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4605787,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "No, these are two modules:\n\n[mqtt](http://npm.im/mqtt): <1.0.0\n\n[mqtt-packet](http://npm.im/mqtt-packet): <3.5.1 || >=4.0.0 <4.1.3 || >=5.0.0 <5.6.1 || >=6.0.0 <6.1.2",
      "automated_response": false,
      "created_at": "2019-04-20T09:50:05.587Z",
      "updated_at": "2019-04-20T09:50:28.880Z",
      "actor": {
        "username": "mcollina",
        "cleared": false,
        "verified": false,
        "url": "/mcollina",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4624802,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "I've checked the mqtt.js v0.3.13 (examples/server/orig.js) module today and couldn't reproduce the crash there.\n\nI found a note in [MQTT.js/parse.js](https://github.com/mqttjs/MQTT.js/blob/v0.3.13/lib/parse.js#L156) which points to possible errors here.\nHowever, the parser does also here over-read the buffer but does not crash. It simply complains later while trying to send the corresponding suback (as the granted QoS is undefined).\n\nHere some log output from around [Line 156](https://github.com/mqttjs/MQTT.js/blob/v0.3.13/lib/parse.js#L156)\n```\nCONNECT: client id: alicedoesnotneedaclientid\n<Topic> hello/topic/of/alice\n<Parser Pos> 25 <Buffer Length> 25\n<QoS from Buffer> undefined\n```\nOn the other hand, [mqtt-packet](https://github.com/mqttjs/mqtt-packet/blob/v1.0.0/lib/parser.js#L288) contains the malicious line since v1.0.0 (where it uses `readUInt8` function to read that byte)\n\nSo I assume, the bug was introduced with [MQTT.js v1.0.0](https://github.com/mqttjs/MQTT.js/releases/tag/v1.0.0) where [MQTT.js/parse.js](https://github.com/mqttjs/MQTT.js/blob/v0.3.13/lib/parse.js#L156) was moved to a separate module [mqtt-packet/parser.js](https://github.com/mqttjs/mqtt-packet/blob/v1.0.0/lib/parser.js#L288). \nThus, [mqtt](https://www.npmjs.com/package/mqtt) <1.0.0 does not seem to be affected by this vulnerability.\n\n\n",
      "automated_response": false,
      "created_at": "2019-04-23T09:50:11.701Z",
      "updated_at": "2019-04-23T09:50:11.701Z",
      "actor": {
        "username": "lxndr",
        "cleared": false,
        "verified": false,
        "url": "/lxndr",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4655514,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "As I'm disclosing this report the vulnerability for MQTT.js 1.0.0 will be public as well. @lxndr will you send a report for that? (seems to be affecting MQTT.js == 1.0.0 only from your last update)",
      "automated_response": false,
      "created_at": "2019-04-28T07:27:44.540Z",
      "updated_at": "2019-04-28T07:27:44.540Z",
      "actor": {
        "username": "lirantal",
        "cleared": false,
        "verified": false,
        "url": "/lirantal",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4655518,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ChangedScope",
      "message": "",
      "automated_response": false,
      "created_at": "2019-04-28T07:30:23.889Z",
      "updated_at": "2019-04-28T07:30:23.889Z",
      "actor": {
        "username": "lirantal",
        "cleared": false,
        "verified": false,
        "url": "/lirantal",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "old_scope": "Other module",
      "new_scope": "mqtt-packet",
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4655535,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportSeverityUpdated",
      "message": "",
      "automated_response": false,
      "created_at": "2019-04-28T07:35:30.121Z",
      "updated_at": "2019-04-28T07:35:30.121Z",
      "additional_data": {
        "old_severity": "High (8.6)",
        "new_severity": "High (7.5)",
        "old_severity_id": 350120,
        "new_severity_id": 359279
      },
      "actor": {
        "username": "lirantal",
        "cleared": false,
        "verified": false,
        "url": "/lirantal",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4655537,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugResolved",
      "message": "",
      "automated_response": false,
      "created_at": "2019-04-28T07:35:49.679Z",
      "updated_at": "2019-04-28T07:35:49.679Z",
      "actor": {
        "username": "lirantal",
        "cleared": false,
        "verified": false,
        "url": "/lirantal",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "reporter": {
        "username": "lxndr",
        "url": "/lxndr"
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4655540,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "",
      "automated_response": false,
      "created_at": "2019-04-28T07:36:22.428Z",
      "updated_at": "2019-04-28T07:36:22.428Z",
      "first_to_agree": true,
      "actor": {
        "username": "lirantal",
        "cleared": false,
        "verified": false,
        "url": "/lirantal",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4655541,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ManuallyDisclosed",
      "message": "",
      "automated_response": false,
      "created_at": "2019-04-28T07:36:31.036Z",
      "updated_at": "2019-04-28T07:36:31.036Z",
      "actor": {
        "username": "lirantal",
        "cleared": false,
        "verified": false,
        "url": "/lirantal",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4660458,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "MQTT.js 1.0.0 uses mqtt-packet 3.5.1 which already contains the fix and thus should be vulnerable anymore.\n\nShooting the malformed packet against MQTT.js 1.0.0 with mqtt-packet 3.5.1:\n```\nCONNECT: client id: alicedoesnotneedaclientid\nError: Malformed Subscribe Payload\n    at Parser._parseSubscribe (~/MQTT/Brokers/MQTT.js/node_modules/mqtt-packet/parser.js:291:60)\n    at Parser._parsePayload (~/MQTT/Brokers/MQTT.js/node_modules/mqtt-packet/parser.js:124:14)\r\n```\n\nI'd say MQTT.js <1.0.0 is prone to buffer over-read at the same position ([L155-156](https://github.com/mqttjs/MQTT.js/blob/v0.3.13/lib/parse.js#L155-156)). \nBut sending the same malformed packet does not crash the Broker. But it does break the protocol logic. \nHowever, this does not break immediately but might cause problems under specific scenarios later on. I will open a new report for MQTT.js < 1.0.0 if I find such a scenario.",
      "automated_response": false,
      "created_at": "2019-04-29T10:16:51.824Z",
      "updated_at": "2019-04-29T10:16:51.824Z",
      "actor": {
        "username": "lxndr",
        "cleared": false,
        "verified": false,
        "url": "/lxndr",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 4670374,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "thanks, sounds good!",
      "automated_response": false,
      "created_at": "2019-04-29T20:47:32.685Z",
      "updated_at": "2019-04-29T20:47:32.685Z",
      "actor": {
        "username": "lirantal",
        "cleared": false,
        "verified": false,
        "url": "/lirantal",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    }
  ],
  "activity_page_count": 1,
  "activity_page_number": 1,
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}