{
  "id": 1439552,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDM5NTUy",
  "url": "https://hackerone.com/reports/1439552",
  "title": "Gitlab Pages token theft using service workers",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2022-01-02T21:42:02.917Z",
  "submitted_at": "2022-01-02T21:42:03.018Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "ehhthing",
    "url": "/ehhthing",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [

    ],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [

  ],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2022-06-08T14:06:40.906Z",
  "bug_reporter_agreed_on_going_public_at": "2022-05-13T15:20:52.220Z",
  "team_member_agreed_on_going_public_at": "2022-06-08T14:06:40.596Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "### Summary\nIt is possible to steal Gitlab Pages session tokens by intercepting requests to the `/auth` endpoint on a Pages site using service workers. \n\n### Attack Flow\n**Setup**\n1. The attacker creates a private Gitlab Pages site at the root of their user page `attacker.gitlab.io`, ensuring that the project is `private to collaborators` for Gitlab Pages visibility. \n2. The attacker invites the victim to collaborate to the project, thus giving them access to the private Pages site.\n3. The victim clicks on a link to `attacker.gitlab.io`, and a service worker is registered for the domain, passing through all requests back to the server except the `/auth` endpoint, which it intercepts.\n\n**Bypassing the CSRF protection (OAuth2 `state` param)**\n4. A script on the website requests a valid session cookie and redirection URL from an attacker controlled website.\n5. The attacker controlled website sends its own request to `attacker.gitlab.io`, and retrieves a redirection URL and a session cookie.\n6. A script on the website redirects the victim to the redirection URL retrieved by the attacker, and the user authenticates (since the user is already logged in, this does not require any kind of interaction)\n\n**Intercepting the OAuth2 Response**\n7. The OAuth2 service redirects the user back to `attacker.gitlab.io/auth` with the code and state, which is intercepted by the attacker's service worker and sent to the attacker controlled website.\n8. The attacker controlled website sends a request to the auth endpoint with the original session cookie and the intercepted code and state to obtain an authenticated session cookie.\n9. The attacker can use this cookie to access other GitLab Pages sites that the victim has access to.\n\n### Steps to reproduce\n1. Create an attacker account and victim account. The victim account should have access to a private GitLab Pages site that the attacker does not have access to.\n2. Start the attacker controlled server (ensure that it is on a remote server with HTTPS)\n3. Import the Proof of Concept repository into the attacker's account, rename it to `{attacker username}.gitlab.io` and change the attacker server to the server deployed in step 2.\n4. Invite the victim to collaborate on the `{attacker username}.gitlab.io` project.\n5. While logged into the victim account, visit `{attacker username}.gitlab.io`.\n6. The attacker controlled server will output a valid `gitlab-pages` session cookie, which can be inserted into a browser or curl command (`curl -v --cookie '{cookie}' https://{victim username}.gitlab.io/{private Gitlab Pages project}`) to gain access to the private Gitlab Pages project on the victim's account.\n\n### Examples\n\n**Proof of Concept:**\n\nPages Project export: F1565711\nPages Project on gitlab.com: https://gitlab.com/dotchinavideo/dotchinavideo.gitlab.io\nAttacker controlled server: F1565227 (requires `flask` and `flask-cors` installed, outputs the stolen token to stdout)\n\n### What is the current *bug* behavior?\nThe current behavior is that `gitlab-pages` session cookies are not properly validated to ensure that the requested subdomain is the same as the subdomain to which the session cookie was issued for.\n\n### What is the expected *correct* behavior?\nThe expected behavior is for each `gitlab-pages` session cookie be validated to prevent cross-subdomain usage.\n\n### Relevant logs and/or screenshots\nF1565251\n\n### Output of checks\nThis bug happens on GitLab.com\n\n#### Results of GitLab environment info\nThis bug happens on GitLab.com\n\n## Impact\n\nOnce an attacker has a valid Pages session token, they are able to access every private Gitlab Pages site that the victim has access to.",
  "bounty_amount": "1680.0",
  "formatted_bounty": "$1,680",
  "weakness": {
    "id": 124,
    "name": "Improper Authorization"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 1565227,
      "file_name": "app.py",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/whrub2n3tm3k9fczzwfe55czpl6k?response-content-disposition=attachment%3B%20filename%3D%22app.py%22%3B%20filename%2A%3DUTF-8%27%27app.py&response-content-type=text%2Fx-python-script&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWZRWVQLW%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T070231Z&X-Amz-Expires=3194&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIH4h5RU%2BpbI3mlwEISZD1G9BopBv%2B7sztLbJknQb99SoAiEAvhxLWqtVFV73maMS53mFspg5vBZ3%2BzoNHXmSke7DMlAqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDC7pogsWvzjWL290gCqPBTKeeZOA278oY6KnHe%2FmWuxZ3Qva3oIxiPgSeceppHqQhkbgfD3tsY8pCoJ9VsxHzSlUT0PRdOuJ8sr7ZKZL2JXBIQSfFD%2FndZi2qU1cFtihzUpwWYUUNN5iSpcUDdb5QDC4CvgOQ%2BEvd6tX7y%2F6Q%2BSMOg8q7yp5mzJr5qbY%2BWMbL6nz%2Buay4cd0wnSe6tkjuaJ1NIbjxSdH9CbkBS0XoTSgIOBDeBGuSMPeOJAc2qCCwB3%2FJJzjHbb07dimFwcVQ37AzR3aSdVTIrEy7NTVExSsa71AnpdGMfq2ZWxbVHT4Z6Ep3h5g9prjvXQKlNKYdiX%2BmlPln5qCDc8s7M8gON6CdSii7fH0aBOcu0INjoa4dc%2FOKcwiuirhI9fDfGn4h4w3t9xVEOfQ21OzAu6iCzqwbyX6FcQTYmc1%2FIb4Lr%2BmfHmZPXpM41HYMK9XHVWPs5aSmF5nYp0DtlX53W%2FJIPEUayublSARs02HeVHIz1vwC6fhS3x1128WqIIvz2dgsHmVJmC%2Bi%2BMemNKEsdiaq0lMgNiTe9mDem3SLrvYMO99wYuebZUfCAVBbqea6mN0o6TtPR%2BY4ZiZl0Y57HEgt3yLwEJQ3BmwdmweldY92DYxW1o1ozabvAsUO6MT%2BEI0mkI2tmtaZQ%2B31bwtxLouobN%2FxkZiIs9YPexJAJ6%2F1%2BFYr5HPRh8rib2vpmO4ylsOFgCISJP5yPdziLDBPihHZhMx8CE858zkJIqVtEFfXZ31W%2FNw09acXa5I4%2BC8AMnDBWV%2FqsryQDDwWpVkzUyRJroktjLT8m7IUEVkEXb7s2GO%2BJiidEBoinU5YgVGpMWTmAmcjaFhRA%2FpwdFI%2F7XHri8KUlyGWMlbYK2BDuF74uow5IK5qAY6sQGceMO9KGy75rSGSK9Jhffgp6ECN8Mwct472Z1JRwqPxCECpo4hAM%2BTiqPzt7Rc8yOTYkRKOicKyCebEt1uytTR6HQoyEcj%2FTBDmV%2BwTAA3FljzwsKBDHTaYj%2Bd0h8rsm4W%2BKtqjUgQ%2BsI4FzYNCv9BSWMF%2FnJ7wV%2BwaSDW1OYbdFVrBpkgTxJPCiLvqlbbKjcH%2BuE8HtSqJR%2FjUt%2Bvxx4CmAPJl%2BJDFQWASMAeV4kuGCM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d120735fffa3a1f620fd66b27647a6921e5a3331a11a66c73575129494f0cf89",
      "file_size": 651,
      "type": "text/x-python-script",
      "moderated": null
    },
    {
      "id": 1565251,
      "file_name": "exploit.mp4",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ur83qfgralu7ggojw42ff9v77kbc?response-content-disposition=attachment%3B%20filename%3D%22exploit.mp4%22%3B%20filename%2A%3DUTF-8%27%27exploit.mp4&response-content-type=video%2Fmp4&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWZRWVQLW%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T070231Z&X-Amz-Expires=3194&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIH4h5RU%2BpbI3mlwEISZD1G9BopBv%2B7sztLbJknQb99SoAiEAvhxLWqtVFV73maMS53mFspg5vBZ3%2BzoNHXmSke7DMlAqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDC7pogsWvzjWL290gCqPBTKeeZOA278oY6KnHe%2FmWuxZ3Qva3oIxiPgSeceppHqQhkbgfD3tsY8pCoJ9VsxHzSlUT0PRdOuJ8sr7ZKZL2JXBIQSfFD%2FndZi2qU1cFtihzUpwWYUUNN5iSpcUDdb5QDC4CvgOQ%2BEvd6tX7y%2F6Q%2BSMOg8q7yp5mzJr5qbY%2BWMbL6nz%2Buay4cd0wnSe6tkjuaJ1NIbjxSdH9CbkBS0XoTSgIOBDeBGuSMPeOJAc2qCCwB3%2FJJzjHbb07dimFwcVQ37AzR3aSdVTIrEy7NTVExSsa71AnpdGMfq2ZWxbVHT4Z6Ep3h5g9prjvXQKlNKYdiX%2BmlPln5qCDc8s7M8gON6CdSii7fH0aBOcu0INjoa4dc%2FOKcwiuirhI9fDfGn4h4w3t9xVEOfQ21OzAu6iCzqwbyX6FcQTYmc1%2FIb4Lr%2BmfHmZPXpM41HYMK9XHVWPs5aSmF5nYp0DtlX53W%2FJIPEUayublSARs02HeVHIz1vwC6fhS3x1128WqIIvz2dgsHmVJmC%2Bi%2BMemNKEsdiaq0lMgNiTe9mDem3SLrvYMO99wYuebZUfCAVBbqea6mN0o6TtPR%2BY4ZiZl0Y57HEgt3yLwEJQ3BmwdmweldY92DYxW1o1ozabvAsUO6MT%2BEI0mkI2tmtaZQ%2B31bwtxLouobN%2FxkZiIs9YPexJAJ6%2F1%2BFYr5HPRh8rib2vpmO4ylsOFgCISJP5yPdziLDBPihHZhMx8CE858zkJIqVtEFfXZ31W%2FNw09acXa5I4%2BC8AMnDBWV%2FqsryQDDwWpVkzUyRJroktjLT8m7IUEVkEXb7s2GO%2BJiidEBoinU5YgVGpMWTmAmcjaFhRA%2FpwdFI%2F7XHri8KUlyGWMlbYK2BDuF74uow5IK5qAY6sQGceMO9KGy75rSGSK9Jhffgp6ECN8Mwct472Z1JRwqPxCECpo4hAM%2BTiqPzt7Rc8yOTYkRKOicKyCebEt1uytTR6HQoyEcj%2FTBDmV%2BwTAA3FljzwsKBDHTaYj%2Bd0h8rsm4W%2BKtqjUgQ%2BsI4FzYNCv9BSWMF%2FnJ7wV%2BwaSDW1OYbdFVrBpkgTxJPCiLvqlbbKjcH%2BuE8HtSqJR%2FjUt%2Bvxx4CmAPJl%2BJDFQWASMAeV4kuGCM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=0316ab21e60035b51cd6a6ba9332027cc65f389246aab45fc5084400c8cbb75e",
      "file_size": 2555851,
      "type": "video/mp4",
      "moderated": null
    },
    {
      "id": 1565711,
      "file_name": "2022-01-02_21-40-801_dotchinavideo_dotchinavideo.gi_export.tar.gz",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/zkrv0a8f5rgy20iusix8owjk69bu?response-content-disposition=attachment%3B%20filename%3D%222022-01-02_21-40-801_dotchinavideo_dotchinavideo.gi_export.tar.gz%22%3B%20filename%2A%3DUTF-8%27%272022-01-02_21-40-801_dotchinavideo_dotchinavideo.gi_export.tar.gz&response-content-type=application%2Fgzip&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWZRWVQLW%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T070231Z&X-Amz-Expires=3194&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIH4h5RU%2BpbI3mlwEISZD1G9BopBv%2B7sztLbJknQb99SoAiEAvhxLWqtVFV73maMS53mFspg5vBZ3%2BzoNHXmSke7DMlAqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDC7pogsWvzjWL290gCqPBTKeeZOA278oY6KnHe%2FmWuxZ3Qva3oIxiPgSeceppHqQhkbgfD3tsY8pCoJ9VsxHzSlUT0PRdOuJ8sr7ZKZL2JXBIQSfFD%2FndZi2qU1cFtihzUpwWYUUNN5iSpcUDdb5QDC4CvgOQ%2BEvd6tX7y%2F6Q%2BSMOg8q7yp5mzJr5qbY%2BWMbL6nz%2Buay4cd0wnSe6tkjuaJ1NIbjxSdH9CbkBS0XoTSgIOBDeBGuSMPeOJAc2qCCwB3%2FJJzjHbb07dimFwcVQ37AzR3aSdVTIrEy7NTVExSsa71AnpdGMfq2ZWxbVHT4Z6Ep3h5g9prjvXQKlNKYdiX%2BmlPln5qCDc8s7M8gON6CdSii7fH0aBOcu0INjoa4dc%2FOKcwiuirhI9fDfGn4h4w3t9xVEOfQ21OzAu6iCzqwbyX6FcQTYmc1%2FIb4Lr%2BmfHmZPXpM41HYMK9XHVWPs5aSmF5nYp0DtlX53W%2FJIPEUayublSARs02HeVHIz1vwC6fhS3x1128WqIIvz2dgsHmVJmC%2Bi%2BMemNKEsdiaq0lMgNiTe9mDem3SLrvYMO99wYuebZUfCAVBbqea6mN0o6TtPR%2BY4ZiZl0Y57HEgt3yLwEJQ3BmwdmweldY92DYxW1o1ozabvAsUO6MT%2BEI0mkI2tmtaZQ%2B31bwtxLouobN%2FxkZiIs9YPexJAJ6%2F1%2BFYr5HPRh8rib2vpmO4ylsOFgCISJP5yPdziLDBPihHZhMx8CE858zkJIqVtEFfXZ31W%2FNw09acXa5I4%2BC8AMnDBWV%2FqsryQDDwWpVkzUyRJroktjLT8m7IUEVkEXb7s2GO%2BJiidEBoinU5YgVGpMWTmAmcjaFhRA%2FpwdFI%2F7XHri8KUlyGWMlbYK2BDuF74uow5IK5qAY6sQGceMO9KGy75rSGSK9Jhffgp6ECN8Mwct472Z1JRwqPxCECpo4hAM%2BTiqPzt7Rc8yOTYkRKOicKyCebEt1uytTR6HQoyEcj%2FTBDmV%2BwTAA3FljzwsKBDHTaYj%2Bd0h8rsm4W%2BKtqjUgQ%2BsI4FzYNCv9BSWMF%2FnJ7wV%2BwaSDW1OYbdFVrBpkgTxJPCiLvqlbbKjcH%2BuE8HtSqJR%2FjUt%2Bvxx4CmAPJl%2BJDFQWASMAeV4kuGCM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a892222173b1351459d22f8315ff8e542fa37fd6c5fc168b6394be0f01aa8439",
      "file_size": 4912,
      "type": "application/gzip",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 9,
  "voters": [
    "yukusawa18",
    "awararesearcher",
    "zy9ard3",
    "yassinek3ch",
    "bl4de",
    "imranhudaa",
    "shivammusic",
    "meispi",
    "testwlp"
  ],
  "severity": {
    "rating": "medium",
    "score": 5.3,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 55901,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://gitlab.com/gitlab-org/gitlab-pages",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [

    ],
    "assignable_team_member_groups": [

    ]
  },
  "activities": [
    {
      "id": 14879140,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportSeverityUpdated",
      "message": "",
      "automated_response": false,
      "created_at": "2022-01-02T22:33:52.796Z",
      "updated_at": "2022-01-02T22:33:52.796Z",
      "additional_data": {
        "old_severity": null,
        "new_severity": "High",
        "old_severity_id": null,
        "new_severity_id": 1348294
      },
      "actor": {
        "username": "ehhthing",
        "cleared": false,
        "verified": false,
        "url": "/ehhthing",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 14894977,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNeedsMoreInfo",
      "message": "Hello @ehhthing and thanks for your report,\n\nI got the attack but can you please share a little bit of context for the setup? As far as I understand, I need 2 different private GitLab instances with GitLab pages installed on it? Then I need to setup the Oauth (not sure how) in the attacker's instance, I connect the victim there and do the curl command, right?\n\nFurthermore, what's **app.py** needed for? Am I missing something else for the setup?\n\nBest regards,\n@turtle_shell",
      "automated_response": false,
      "created_at": "2022-01-04T09:53:44.750Z",
      "updated_at": "2022-01-04T09:53:44.750Z",
      "actor": {
        "username": "h1_analyst_caesar",
        "cleared": false,
        "verified": false,
        "url": "/h1_analyst_caesar",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/2bkb69nvrwhkybw7m3gi9o2dumgp/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 14907452,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNew",
      "message": "You can do this fully on GitLab.com and GitLab.io (both operated by GitLab, Inc.), no private instances needed.\n\nExample scenario: \n\nSally and Bob both create GitLab.com accounts. Bob wants to gain access to Sally's Private GitLab Pages. Bob deploys the example \"attacker controlled server\" (app.py) onto `bob.com`. Bob then creates his own GitLab Pages site `bob.gitlab.io` using the example Proof of Concept export. Bob sends a link to `bob.gitlab.io` to Sally.\n\nWhen Sally visits `bob.gitlab.io`, Sally's browser registers a service worker to intercept all requests that Sally's browser makes to `bob.gitlab.io`, forwarding all the requests to the backend web server except requests to `bob.gitlab.io/auth`, which it intercepts and does not forward back to the web server.\n\nSally's browser asks `bob.com` for a valid cookie and redirect URI, and then proceeds to redirect Sally to the redirect URI provided by it. After Sally's browser authenticates with the GitLab.com OAuth system, it redirects Sally to `bob.gitlab.io/auth?code={code}&state={state}`. Here, the service worker registered will intercept this request and send the code and state to `bob.com`, which uses this information to make its own request to `bob.gitlab.io/auth?code={code}&state={state}` with the cookie it originally got when Sally's browser first asked for a cookie and redirect URI.\n\nWith this cookie, Bob can now access any GitLab pages site that Sally has access to (e.g. `sally.gitlab.io`).",
      "automated_response": false,
      "created_at": "2022-01-05T05:05:42.838Z",
      "updated_at": "2022-01-05T05:08:00.815Z",
      "actor": {
        "username": "ehhthing",
        "cleared": false,
        "verified": false,
        "url": "/ehhthing",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 14974405,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNeedsMoreInfo",
      "message": "Hello @ehhthing and thanks for your reply,\n\nCould you please explain to me how do I create a gitlab.io instance as the attacker/victim?\n\nBest regards,\n@turtle_shell",
      "automated_response": false,
      "created_at": "2022-01-10T14:16:03.992Z",
      "updated_at": "2022-01-10T14:16:03.992Z",
      "actor": {
        "username": "h1_analyst_caesar",
        "cleared": false,
        "verified": false,
        "url": "/h1_analyst_caesar",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/2bkb69nvrwhkybw7m3gi9o2dumgp/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 14974545,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNew",
      "message": "@turtle_shell GitLab.io is operated by GitLab, Inc. When you make an account on GitLab.com you get a free GitLab.io subdomain from which your GitLab  Pages are served.",
      "automated_response": false,
      "created_at": "2022-01-10T14:22:01.046Z",
      "updated_at": "2022-01-10T14:22:01.046Z",
      "actor": {
        "username": "ehhthing",
        "cleared": false,
        "verified": false,
        "url": "/ehhthing",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 15026074,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNeedsMoreInfo",
      "message": "Hello @ehhthing and thanks for your reply,\n\nYou'll need to be more precise on the setup since it's still hard to understand how to fully reproduce this vulnerability. Where is the GitLab.io page of mine?\n\n> Create an attacker account and victim account. The victim account should have access to a private GitLab Pages site that the attacker does not have access to.\n\nHow do I create a private one? If you have an already done setup that I could use, or even trying the exploits on your test page/account that would be less time-consuming on both sides.\n\nBest regards,\n@turtle_shell",
      "automated_response": false,
      "created_at": "2022-01-13T14:14:26.763Z",
      "updated_at": "2022-01-13T14:14:46.893Z",
      "actor": {
        "username": "h1_analyst_caesar",
        "cleared": false,
        "verified": false,
        "url": "/h1_analyst_caesar",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/2bkb69nvrwhkybw7m3gi9o2dumgp/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 15077848,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugNew",
      "message": "I've created a setup with a slightly tweaked attacker server (attached app.py).\n\nLogin to the Gitlab.com with username `exampleaccount003` and password `h1report1439552`. \n\nNow you can visit `https://dotchinavideo.gitlab.io`. After a few redirects you should be greeted with a blank page.\n\nTo retrieve the cookie, visit `https://6062d962.larry.science/32e0735cc913841e57e95e2142cd9748/get`\n\nTo verify that the cookie is valid for other GitLab Pages sites, you can run the curl command `curl --cookie \"$(curl https://6062d962.larry.science/32e0735cc913841e57e95e2142cd9748/get)\" https://exampleaccount003.gitlab.io`.\n\nPlease let me know after you've verified this so I can turn off the server.",
      "automated_response": false,
      "created_at": "2022-01-18T04:55:43.326Z",
      "updated_at": "2022-01-18T04:55:43.326Z",
      "actor": {
        "username": "ehhthing",
        "cleared": false,
        "verified": false,
        "url": "/ehhthing",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 15077851,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "Apologies, I forgot to attach the modified exploit. I've attached it to this comment instead.",
      "automated_response": false,
      "created_at": "2022-01-18T04:57:10.847Z",
      "updated_at": "2022-01-18T04:57:10.847Z",
      "actor": {
        "username": "ehhthing",
        "cleared": false,
        "verified": false,
        "url": "/ehhthing",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "attachments": [
        {
          "id": 1582871,
          "filename": "app.py",
          "type": "text/x-python-script",
          "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/a90mylheeb6mkdfo8da2n7t905ht?response-content-disposition=attachment%3B%20filename%3D%22app.py%22%3B%20filename%2A%3DUTF-8%27%27app.py&response-content-type=text%2Fx-python-script&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWZRWVQLW%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T070231Z&X-Amz-Expires=3194&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECoaCXVzLXdlc3QtMiJHMEUCIH4h5RU%2BpbI3mlwEISZD1G9BopBv%2B7sztLbJknQb99SoAiEAvhxLWqtVFV73maMS53mFspg5vBZ3%2BzoNHXmSke7DMlAqsgUIIxADGgwwMTM2MTkyNzQ4NDkiDC7pogsWvzjWL290gCqPBTKeeZOA278oY6KnHe%2FmWuxZ3Qva3oIxiPgSeceppHqQhkbgfD3tsY8pCoJ9VsxHzSlUT0PRdOuJ8sr7ZKZL2JXBIQSfFD%2FndZi2qU1cFtihzUpwWYUUNN5iSpcUDdb5QDC4CvgOQ%2BEvd6tX7y%2F6Q%2BSMOg8q7yp5mzJr5qbY%2BWMbL6nz%2Buay4cd0wnSe6tkjuaJ1NIbjxSdH9CbkBS0XoTSgIOBDeBGuSMPeOJAc2qCCwB3%2FJJzjHbb07dimFwcVQ37AzR3aSdVTIrEy7NTVExSsa71AnpdGMfq2ZWxbVHT4Z6Ep3h5g9prjvXQKlNKYdiX%2BmlPln5qCDc8s7M8gON6CdSii7fH0aBOcu0INjoa4dc%2FOKcwiuirhI9fDfGn4h4w3t9xVEOfQ21OzAu6iCzqwbyX6FcQTYmc1%2FIb4Lr%2BmfHmZPXpM41HYMK9XHVWPs5aSmF5nYp0DtlX53W%2FJIPEUayublSARs02HeVHIz1vwC6fhS3x1128WqIIvz2dgsHmVJmC%2Bi%2BMemNKEsdiaq0lMgNiTe9mDem3SLrvYMO99wYuebZUfCAVBbqea6mN0o6TtPR%2BY4ZiZl0Y57HEgt3yLwEJQ3BmwdmweldY92DYxW1o1ozabvAsUO6MT%2BEI0mkI2tmtaZQ%2B31bwtxLouobN%2FxkZiIs9YPexJAJ6%2F1%2BFYr5HPRh8rib2vpmO4ylsOFgCISJP5yPdziLDBPihHZhMx8CE858zkJIqVtEFfXZ31W%2FNw09acXa5I4%2BC8AMnDBWV%2FqsryQDDwWpVkzUyRJroktjLT8m7IUEVkEXb7s2GO%2BJiidEBoinU5YgVGpMWTmAmcjaFhRA%2FpwdFI%2F7XHri8KUlyGWMlbYK2BDuF74uow5IK5qAY6sQGceMO9KGy75rSGSK9Jhffgp6ECN8Mwct472Z1JRwqPxCECpo4hAM%2BTiqPzt7Rc8yOTYkRKOicKyCebEt1uytTR6HQoyEcj%2FTBDmV%2BwTAA3FljzwsKBDHTaYj%2Bd0h8rsm4W%2BKtqjUgQ%2BsI4FzYNCv9BSWMF%2FnJ7wV%2BwaSDW1OYbdFVrBpkgTxJPCiLvqlbbKjcH%2BuE8HtSqJR%2FjUt%2Bvxx4CmAPJl%2BJDFQWASMAeV4kuGCM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=af1144e471e2ffbf967eaebe5732e1d0b80431d6f71972376c5436a10e93f39d"
        }
      ],
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 15098154,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugPendingProgramReview",
      "message": "Hello @ehhthing,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nThanks,\n@turtle_shell",
      "automated_response": false,
      "created_at": "2022-01-19T10:11:40.415Z",
      "updated_at": "2022-01-19T10:11:40.415Z",
      "actor": {
        "username": "h1_analyst_caesar",
        "cleared": false,
        "verified": false,
        "url": "/h1_analyst_caesar",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/2bkb69nvrwhkybw7m3gi9o2dumgp/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 15098282,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportSeverityUpdated",
      "message": null,
      "automated_response": false,
      "created_at": "2022-01-19T10:18:33.494Z",
      "updated_at": "2022-01-19T10:18:33.494Z",
      "additional_data": {
        "old_severity": "High",
        "new_severity": "High (7.1)",
        "old_severity_id": 1348294,
        "new_severity_id": 1365311
      },
      "actor": {
        "username": "h1_analyst_caesar",
        "cleared": false,
        "verified": false,
        "url": "/h1_analyst_caesar",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/2bkb69nvrwhkybw7m3gi9o2dumgp/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 15108988,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportSeverityUpdated",
      "message": "Based on [our CVSS calculator](https://gitlab-com.gitlab.io/gl-security/appsec/cvss-calculator/):\n\n> `AC:H` ... CSRF and reflected XSS because it's likely the victim will not click the attacker's link\n\n`I:N` because there is no integrity impact that I can see",
      "automated_response": false,
      "created_at": "2022-01-19T22:37:50.102Z",
      "updated_at": "2022-01-19T22:37:50.102Z",
      "additional_data": {
        "old_severity": "High (7.1)",
        "new_severity": "Medium (5.3)",
        "old_severity_id": 1365311,
        "new_severity_id": 1366244
      },
      "actor": {
        "username": "nmalcolm_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/nmalcolm_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/qugqy57v49704ukw2816cro62zrc/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 15109069,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BountyAwarded",
      "message": "Hello @ehhthing \n\nThank you for submitting this report!\n\nWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab/-/issues/350687.  This issue will be made public 30 days following the release of a patch.\n\nGiven the severity of the report, we are paying an initial $500 on triage. Congratulations!\n\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nBest regards,\nNick Malcolm\nGitLab Security Team",
      "automated_response": false,
      "created_at": "2022-01-19T22:55:41.928Z",
      "updated_at": "2022-01-19T22:55:41.928Z",
      "actor": {
        "url": "/gitlab",
        "ibb": false,
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "profile": {
          "name": "GitLab"
        }
      },
      "bounty_amount": "500.0",
      "bonus_amount": "0.0",
      "bounty_currency": "usd",
      "genius_execution_id": null,
      "team_handle": "gitlab",
      "collaborator": {
        "username": "ehhthing",
        "url": "/ehhthing"
      }
    },
    {
      "id": 15109100,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugTriaged",
      "message": "",
      "automated_response": false,
      "created_at": "2022-01-19T23:03:50.363Z",
      "updated_at": "2022-01-19T23:03:50.363Z",
      "actor": {
        "username": "nmalcolm_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/nmalcolm_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/qugqy57v49704ukw2816cro62zrc/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 15147420,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "ETA for fix:\n\nHi @ehhthing,\n\nThe issue you reported is currently scheduled to be fixed by 2022-03-31.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n",
      "automated_response": true,
      "created_at": "2022-01-22T04:03:43.647Z",
      "updated_at": "2022-01-22T04:03:43.647Z",
      "actor": {
        "username": "gitlab-securitybot",
        "cleared": false,
        "verified": false,
        "url": "/gitlab-securitybot",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 16134767,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BountyAwarded",
      "message": "Hi @ehhthing \n\nThank you again for the report! Your finding has been patched in GitLab version [14.9.2](https://about.gitlab.com/releases/2022/03/31/critical-security-release-gitlab-14-9-2-released/) and we are awarding the remainder of the bounty. The bounty total is $1680, and $500 was awarded when we triaged the report. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker. If you'd like to publicly disclose this report or details of it in a blog post or elsewhere, please allow 30 days to pass before doing so to give time to our customers to upgrade to a patched version.\n\nWe look forward to your next report!\n\nBest regards,\nNick Malcolm\nGitLab Security Team",
      "automated_response": false,
      "created_at": "2022-04-04T03:32:45.869Z",
      "updated_at": "2022-04-04T03:32:45.869Z",
      "actor": {
        "url": "/gitlab",
        "ibb": false,
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "profile": {
          "name": "GitLab"
        }
      },
      "bounty_amount": "1180.0",
      "bonus_amount": "0.0",
      "bounty_currency": "usd",
      "genius_execution_id": null,
      "team_handle": "gitlab",
      "collaborator": {
        "username": "ehhthing",
        "url": "/ehhthing"
      }
    },
    {
      "id": 16134769,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugResolved",
      "message": "",
      "automated_response": false,
      "created_at": "2022-04-04T03:33:03.357Z",
      "updated_at": "2022-04-04T03:33:03.357Z",
      "actor": {
        "username": "nmalcolm_gitlab",
        "cleared": false,
        "verified": false,
        "url": "/nmalcolm_gitlab",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/qugqy57v49704ukw2816cro62zrc/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "reporter": {
        "username": "ehhthing",
        "url": "/ehhthing"
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 16695674,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "",
      "automated_response": false,
      "created_at": "2022-05-13T15:20:52.246Z",
      "updated_at": "2022-05-13T15:20:52.246Z",
      "first_to_agree": true,
      "actor": {
        "username": "ehhthing",
        "cleared": false,
        "verified": false,
        "url": "/ehhthing",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 16696712,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "It seems as if the Gitlab issue linked has yet to be made public, is it required that I request disclosure for it to be made public?",
      "automated_response": false,
      "created_at": "2022-05-13T15:32:59.080Z",
      "updated_at": "2022-05-13T15:32:59.080Z",
      "actor": {
        "username": "ehhthing",
        "cleared": false,
        "verified": false,
        "url": "/ehhthing",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 17047553,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "It isn't, but we miss the disclosure requests through the noise sometimes. :) Disclosing!",
      "automated_response": false,
      "created_at": "2022-06-08T14:06:40.625Z",
      "updated_at": "2022-06-08T14:06:40.625Z",
      "actor": {
        "username": "dcouture",
        "cleared": false,
        "verified": false,
        "url": "/dcouture",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    },
    {
      "id": 17047554,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportBecamePublic",
      "message": "",
      "automated_response": false,
      "created_at": "2022-06-08T14:06:40.963Z",
      "updated_at": "2022-06-08T14:06:40.963Z",
      "actor": {
        "username": "dcouture",
        "cleared": false,
        "verified": false,
        "url": "/dcouture",
        "profile_picture_urls": {
          "medium": "https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "gitlab"
    }
  ],
  "activity_page_count": 1,
  "activity_page_number": 1,
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}